<!DOCTYPE html>
<html lang="en" dir="auto">

<head>
	<meta name="generator" content="Hugo 0.131.0"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=8888&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>PaperMod</title>

<meta name="description" content="">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:8888/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:8888/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:8888/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:8888/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:8888/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:8888/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:8888/index.xml">
<link rel="alternate" hreflang="en" href="http://localhost:8888/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:8888/" accesskey="h" title="PaperMod (Alt + H)">PaperMod</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:8888/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:8888/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:8888/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Linux 帧缓冲
    </h2>
  </header>
  <div class="entry-content">
    <p>简介 FrameBuffer 是内核当中的一种驱动程序接口。Linux 是工作在保护模式下，所以用户态进程是无法象 DOS 那样使用显卡 BIOS 里提供的中断调用来实现直接写屏，Linux 抽象出 FrameBuffer 这个设备来供用户态进程实现直接写屏。
帧缓冲主要结构 fb_info 该结构体记录当前帧缓冲设备的状态信息，如果系统中有多个帧缓冲设备，就需要两个fb_info结构，这个结构只在内核中可以看到，对用户空间不可见。
fb_var_screeninfo 该结构体记录指定的帧缓冲设备和显示模式中可以被修改的信息，其中包括显示器分辨率等信息。
fb_fix_screeninfo 该结构体表示帧缓冲设备中一些不能修改的参数，包括特定的显示模式，屏幕缓冲区的物理地址，显示缓冲区的长度信息。
fb_ops LCD底层硬件操作接口集。比如fb_open、fb_release、fb_read、fb_write、fb_ioctl、fb_mmap等：
fb_cmap fb_cmap指定颜色映射，用于以内核可以理解的方式存储用户的颜色定义。
帧缓冲显示原理 帧缓冲设备是一种显示抽象的设备，也可以被理解为它是一个内存区域，上面的应用程序可以直接对显示缓冲区进行读和写操作，就像访问文件的通用接口一样，用户可以认为帧缓冲是一块内存，能读取数据的内存块也可以向这个内存写入数据，因此显示器显示图形界面实际上根据根据的是指定的内存数据块内的数据。
帧缓冲的显示缓冲区位于 Linux 内核地址空间，应用程序不能直接访问内核地址空间，在 Linux 中，只有一个内存的内核地址空间映射到用户地址空间才可以由用户访问，内存的映射是通过MMAP函数实现的在 Linux 中。对于帧缓冲，虚拟地址是通过内存映射的方法将显示缓冲区内核地址映射到用户空间的，然后用户可以通过读和写这部分的虚拟地址来访问显示缓冲区，在屏幕上绘图。
使用流程 使用帧缓冲之前应该首先确定 Linux 系统上已安装了帧缓冲驱动，可以在目录/dev/下查找fb*如，/dev/fb0, /dev/fb1等设备来确定是否安装。如果没有需要安装一个帧缓冲驱动的模块到内核，或者重新编译内核生成一个带帧缓冲模块的镜像。
使用帧缓冲需要进入控制台模式，即纯命令行的模式进行编程。一般可以通过快捷键CTRL&#43;ALT&#43;F1进入控制台模式，CTRL&#43;ALT&#43;F7切回图形窗口。如果控制台模式没有登录，可以CTRL&#43;ALT&#43;F6尝试登录。
因硬件显示设备的物理显示区是通过帧缓存区操作，而帧缓存区是处于内核空间，应用程序不能随意操作，此时可以通过系统调用mmap把帧缓存映射到用户空间，在用户空间中创建出帧缓存映射区（用户图像数据缓存区），以后只需把用户图像数据写入到帧缓存映射区就可在硬件设备上显示图像。
具体实现流程如下：
打开帧缓冲设备/dev/f0 在Linux的/dev目录的寻找b*设备文件然后使用读写模式打开它，Linux 系统将使用通用的open系统调用来完成功能， open的功能原型如下：
int open(const char *path, int oflags); Path是准备打开的文件或设备的路径参数； oflags指定打开文件时使用的参数； flags参数的指定，是通过组合文件访问模式和其他的可选模式一起的，可以支持多个模式或，参数必须是指定下列文件的访问模式。 只读：O_RDONLLY 只写：O_WRONLY 读写：O_RDWR 简而言之， open函数建立设备文件的访问路径。如果操作成功，它返回一个文件描述符，只是一个文件描述符，它将不使用其他任何正在运行的进程共享。如果两个程序同时打开相同的文件，将得到两个不同的文件描述符。如果他们执行文件写入操作，他们将操作每个文件描述符，不会发生冲突，写完之后退出。他们的数据不会互相交织在一起的，但会互相的彼此覆盖 (后写完的内容覆盖前面写的内容)，两个程序来读取和写入的文件位置看似一样但是有各自不同拷贝所以不会发生交织。如果open调用未能返回1，则将全局变量errno设置为指示失败的原因。
通过系统调用ioctl函数获得帧设备相关信息 通过顿缓冲文件描述符，屏幕的分辨率、颜色深度等信息可以被获得，帧缓冲驱动中存放了这些对应的信息，必须使用 Linux 系统调用ioctl首先将帧缓冲的文件描述符和fb_var_screeninfo 结构体对应起来。
结构体fb_var_screeninfo包含以下三个重要数据结构：
屏幕的 x 方向分辨率，像素作为单位。 屏幕的 Y 方向分辨率，像素作为单位。 屏幕的像素颜色深度，每个像素用多少比特数表示。 ioctl函数原型如下：...</p>
  </div>
  <footer class="entry-footer"><span title='2022-01-17 17:38:04 +0000 UTC'>January 17, 2022</span>&nbsp;·&nbsp;3 min</footer>
  <a class="entry-link" aria-label="post link to Linux 帧缓冲" href="http://localhost:8888/posts/linux%E5%B8%A7%E7%BC%93%E5%86%B2/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">解决 ssh permission denied(publickey)
    </h2>
  </header>
  <div class="entry-content">
    <p>保留现场 linux&gt; ssh -p 2221 xxx@gerrit.com xxx@gerrit.com: Permission denied(publickey) 探究原因 本次出错是在测试是否能连接 gerrit 时。连接 GitHub 也可能会出现。只要用到 ssh 功能的都有可能。
出错的原因：
网页（如 gerrit,github）没有设置公钥，一般为id_rsa.pub内容； 本地生成了多个公私钥，配对配错了； 本地没有配置好git，比如git config时用户名或者邮箱填错； 需要开启 ssh 代理； 解决方法 生成密钥cd ~/.ssh &amp;&amp; ssh-keygen 复制公钥内容，添加到网页中github或者gerrit的设置里。cat id_rsa.pub | xclip 配置git账户 git config --global user.name &#34;bob&#34; git config --global user.email bob@... 以上检查无误，仍然报错
开启ssh代理 eval $(ssh-agent -s) 将私钥加入代理 ssh-add ~/.ssh/id_rsa 登陆用户时启动 ssh-agent 如果不幸你的问题就是需要开启ssh-agent，那么每次重启电脑都需要开启一次。这也是相当麻烦的，可以通过将以下配置添加到~/.bashrc中，让 Linux 启动时自动开启ssh-agent。
# Add following code at the end of ~/.bashrc # Check if ~/....</p>
  </div>
  <footer class="entry-footer"><span title='2022-01-13 22:43:02 +0000 UTC'>January 13, 2022</span>&nbsp;·&nbsp;1 min</footer>
  <a class="entry-link" aria-label="post link to 解决 ssh permission denied(publickey)" href="http://localhost:8888/posts/%E8%A7%A3%E5%86%B3git-ssh-permission-deniedpublickey/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Linux 安装 Node.js 以及 hexo
    </h2>
  </header>
  <div class="entry-content">
    <p>安装 Node.js 过程 进入该网站下载 | Node.js 也可以进入该网站下载历史版本，Previous Releases | Node.js
进入 download 目录，
cd downloadwget https://nodejs.org/dist/v10.16.3/node-v10.16.3-linux-x64.tar.xz -O nodejs.tar.xz 解压
tar -xvf node-v10.16.3-linux-x64.tar.xz 改名 Node.js
mv node-v10.16.3-linux-x64 nodejs 将 npm，node 两个程序建立软连接，能够全局可用
ln -s /download/nodejs/bin/npm /usr/local/bin/ ln -s /download/nodejs/bin/node /usr/local/bin/ 检查是否安装
node -vnpm -v 安装 hexo 过程 npm i hexo-cli -ghexo -v 如果出现命令未找到到错误，说明 hexo 还未加入全局变量。 将下面命令加入
vim ~/.bashrcexport PATH=/usr/local/nodejs/lib/node_modules/hexo-cli/bin/:$PATH Reference Previous Releases | Node.js Linux 安装 Node.js | F2E 前端技术论坛 Linux 下安装 node 及 npm - SegmentFault 思否 超详细 Hexo&#43;Github 博客搭建小白教程 - 知乎</p>
  </div>
  <footer class="entry-footer"><span title='2022-01-10 11:51:50 +0000 UTC'>January 10, 2022</span>&nbsp;·&nbsp;1 min</footer>
  <a class="entry-link" aria-label="post link to Linux 安装 Node.js 以及 hexo" href="http://localhost:8888/posts/linux%E5%AE%89%E8%A3%85nodejs/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">C 语言__attribute__使用
    </h2>
  </header>
  <div class="entry-content">
    <p>简介 __attribute__ 其实是个编译器指令，告诉编译器声明的特性，或者让编译器进行更多的错误检查和高级优化。
__attribute__ 可以设置函数属性（Function Attribute）、变量属性（Variable Attribute）和类型属性（Type Attribute）。每一类都包含数十种属性，本文不会逐一解释，只抛砖引玉，完整属性可以查看链接中的官方文档。
一个属性说明符的形式是__attribute__ ((attribute-list))。一个属性列表是一个可能为空的逗号分隔的属性序列，其中每个属性都是以下的一个。
属性为空。空属性会被忽略。 一个单词（可能是未使用的标识符，也可能是 const 等保留字）。 一个单词，后面跟着括号中的属性参数。这些参数采用以下形式之一： 一个标识符。例如，mode属性使用这种形式。 一个标识符，后跟一个逗号和一个以逗号分隔的非空表达式列表。例如，format属性使用这种形式。 一个可能是空的逗号分隔的表达式列表。例如，format_arg属性使用这种形式，该列表是一个单一的整数常量表达式，而alias属性也使用这种形式，该列表是一个单一的字符串常量。 使用方法 函数属性 alias 该属性可以设置函数的别名。
void __f() { printf(&#34;__attribute__ test\n&#34;); }; void f() __attribute__((weak, alias(&#34;__f&#34;))); int main() { f(); return 0; } /*--- 输出 ---*/ //__attribute__ test 函数f()的别名为__f()，调用f()即调用__f()。
alloc_size alloc_size属性用来告诉编译器，函数的返回值指向内存，其中的大小由一个或两个函数参数给出。GCC 使用这些信息来提高__builtin_object_size的正确性。
alloc_size后面可以跟一到二个参数，alloc_size 后面跟的参数是指定使用函数的第几个参数。
函数的参数的个数只有一个，那么 alloc_size 的参数只能是 1。通过__builtin_object_size 获取的值 就是传入的参数值。如图，我们给函数my_malloc 传入的值是100 ，那么我们通过__builtin_object_size 获取的值就是100。
函数的参数的个数多余两个，那么alloc_size 的最多可以指定两个参数。传入两个参数，__builtin_object_size的值是这两个参数的乘积。传入一个参数，__builtin_object_size的值就是这个参数的值。如图，my_callocd函数指定的参数是alloc_size(2,3)，通过__builtin_object_size获取的值就是my_callocd传入的第二和三个参数的乘积（2*3=6）。
void *my_calloc(int a) __attribute__((alloc_size(1))); void *my_realloc(int a, int b, int c) __attribute__((alloc_size(2, 3))); void *my_calloc(int a) { return NULL; } void *my_realloc(int a, int b, int c) { return NULL; } int main() { void *const p = my_calloc(100); printf(&#34;size : %ld\n&#34;, __builtin_object_size(p, 0)); void *const a = my_realloc(1, 2, 3); printf(&#34;size : %ld\n&#34;, __builtin_object_size(a, 1)); return 0; } /*--- 输出 ---*/ //100 //6 constructor (priority) / destructor (priority) constructor属性使该函数在执行进入main()之前被自动调用。同样地，destructor属性使函数在main()完成后或exit()被调用后被自动调用。具有这些属性的函数对于初始化将在程序执行过程中隐含使用的数据非常有用。...</p>
  </div>
  <footer class="entry-footer"><span title='2022-01-08 15:40:51 +0000 UTC'>January 8, 2022</span>&nbsp;·&nbsp;2 min</footer>
  <a class="entry-link" aria-label="post link to C 语言__attribute__使用" href="http://localhost:8888/posts/c%E8%AF%AD%E8%A8%80-attribute-%E4%BD%BF%E7%94%A8/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">C 语言 typedef 用法
    </h2>
  </header>
  <div class="entry-content">
    <p>简介 typedef为 C 语言的关键字，作用是为一种数据类型定义一个新名字。这里的数据类型包括内部数据类型（int,char 等）和自定义的数据类型（struct 等）。在使用语法上类似与static，extern等。 typedef 行为有点像 #define 宏，用其实际类型替代同义字。不同点是 typedef在编译时被解释，因此让编译器来应付超越预处理器能力的文本替换。
基本使用方法 示例 1：
int a; ———— 传统变量声明表达式int myint_t; ———— 使用新的类型名myint_t替换变量名atypedef int myint_t; ———— 在语句开头加上typedef关键字，myint_t就是我们定义的新类型 示例 2：
void (*pfunA)(int a); ———— 传统变量（函数）声明表达式void (*PFUNA)(int a); ———— 使用新的类型名PFUNA替换变量名pfunAtypedef void (*PFUNA)(int a); ———— 在语句开头加上typedef关键字，PFUNA就是我们定义的新类型 促使我写这篇文章的原因不是如何去用typedef，而是在代码中看不懂如何简化了一个复杂声明。比如上文的
typedef void (*PFUNA)(int a); 本以为是将void类型替换成了(*PFUNA)(int a)，但是语法上这明显讲不通啊。现在明白了，这就是将void (*pfunA)(int a);类型名换成了PFUNA。以后就可以用PFUNA来声明变量。比如
PFUNA arr[10] 表示声明了一个大小为10的数组，数组的元素是PFUNA类型。将PFUNA类型展开就是，这是一个函数指针，函数参数为int类型，返回值为void类型。完整的含义就是，声明了一个大小为10的数组，数组元素是函数指针，函数参数为int类型，返回值为void类型。
代码简化 typedef可以为复杂的声明定义一个新的简单的别名。关于复杂声明，可以阅读这篇C 语言复杂声明。 方法是：在原来的声明里逐步用别名替换一部分复杂声明，递归操作，把带变量名的部分留到最后替换，得到的就是原声明的最简化版。举例：
//复杂声明void (*b[10]) (void (*)()); 变量名为b，先替换右边部分括号里的，pFunParam为别名
typedef void (*pFunParam)(); 再替换左边的变量b，pFunx为别名二：...</p>
  </div>
  <footer class="entry-footer"><span title='2022-01-07 11:51:50 +0000 UTC'>January 7, 2022</span>&nbsp;·&nbsp;2 min</footer>
  <a class="entry-link" aria-label="post link to C 语言 typedef 用法" href="http://localhost:8888/posts/c%E8%AF%AD%E8%A8%80typedef%E7%94%A8%E6%B3%95/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="http://localhost:8888/page/31/">
      «&nbsp;Prev&nbsp;
    </a>
    <a class="next" href="http://localhost:8888/page/33/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="http://localhost:8888/">PaperMod</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
