<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>解决 Segmentation fault (core dumped) - 如云泊</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">




<meta name="description" content="">





    <meta name="description" content="相关概念Core在使用半导体作为内存的材料前，人类是利用线圈当作内存的材料（发明者为王安），线圈就叫作 core ，用线圈做的内存就叫作 core memory。如今，半导体工业澎勃发展，已经没有人用core memory 了，不过，在许多情况下，人们还是把记忆体叫作 core 。 Core dump我们在开发（或使用）一个程序时，最怕的就是程序莫明其妙地宕掉。虽然系统没事，但我们下次仍可能遇到相">
<meta property="og:type" content="article">
<meta property="og:title" content="解决 Segmentation fault (core dumped)">
<meta property="og:url" content="https://lifeislife.cn/2021/10/20/%E8%A7%A3%E5%86%B3Segmentation-fault-core-dumped/index.html">
<meta property="og:site_name" content="如云泊">
<meta property="og:description" content="相关概念Core在使用半导体作为内存的材料前，人类是利用线圈当作内存的材料（发明者为王安），线圈就叫作 core ，用线圈做的内存就叫作 core memory。如今，半导体工业澎勃发展，已经没有人用core memory 了，不过，在许多情况下，人们还是把记忆体叫作 core 。 Core dump我们在开发（或使用）一个程序时，最怕的就是程序莫明其妙地宕掉。虽然系统没事，但我们下次仍可能遇到相">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-10-20T06:23:02.000Z">
<meta property="article:modified_time" content="2022-10-15T03:14:29.836Z">
<meta property="article:author" content="Dominic">
<meta property="article:tag" content="C">
<meta property="article:tag" content="Bug">
<meta name="twitter:card" content="summary">





<link rel="icon" href="/favicon.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">


<link rel="stylesheet" href="../../../../css/style.css">


<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PS8L2EEEPR"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-PS8L2EEEPR');
</script>


    


<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="atom.xml" title="如云泊" type="application/atom+xml">
</head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="../../../../index.html">
                
                <img src="../../../../images/logo.png" alt="" height="28">
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="../../../../archives">Archives</a>
            
            <a class="navbar-item "
               href="../../../../about">About</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="搜索" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            <div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc">
                <a class="navbar-item" title="目录">
                    <i class="fa fa-list"></i>
                </a>
                <div class="navbar-dropdown is-right">
                    
                    
                    
                    
                    <a class="navbar-item" href="#相关概念">1&nbsp;&nbsp;<b>相关概念</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#Core">1.1&nbsp;&nbsp;Core</a>
                    
                    
                    
                    <a class="navbar-item" href="#Core-dump">1.2&nbsp;&nbsp;Core dump</a>
                    
                    
                    
                    <a class="navbar-item" href="#如何获取-Core-文件">1.3&nbsp;&nbsp;如何获取 Core 文件</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#出现段错误的可能原因">2&nbsp;&nbsp;<b>出现段错误的可能原因</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#访问不存在的内存地址">2.1&nbsp;&nbsp;访问不存在的内存地址</a>
                    
                    
                    
                    <a class="navbar-item" href="#访问系统保护的内存地址">2.2&nbsp;&nbsp;访问系统保护的内存地址</a>
                    
                    
                    
                    <a class="navbar-item" href="#访问只读的内存地址">2.3&nbsp;&nbsp;访问只读的内存地址</a>
                    
                    
                    
                    <a class="navbar-item" href="#栈溢出">2.4&nbsp;&nbsp;栈溢出</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#段错误信息获取">3&nbsp;&nbsp;<b>段错误信息获取</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#dmesg">3.1&nbsp;&nbsp;dmesg</a>
                    
                    
                    
                    <a class="navbar-item" href="#g">3.2&nbsp;&nbsp;-g</a>
                    
                    
                    
                    <a class="navbar-item" href="#nm">3.3&nbsp;&nbsp;nm</a>
                    
                    
                    
                    <a class="navbar-item" href="#ldd">3.4&nbsp;&nbsp;ldd</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#调试方法和技巧">4&nbsp;&nbsp;<b>调试方法和技巧</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#使用-gcc-和-gdb">4.1&nbsp;&nbsp;使用 gcc 和 gdb</a>
                    
                    
                    
                    <a class="navbar-item" href="#调试流程">4.1.1&nbsp;&nbsp;调试流程</a>
                    
                    
                    
                    <a class="navbar-item" href="#适用场景">4.1.2&nbsp;&nbsp;适用场景</a>
                    
                    
                    
                    <a class="navbar-item" href="#使用-core-文件和-gdb">4.2&nbsp;&nbsp;使用 core 文件和 gdb</a>
                    
                    
                    
                    <a class="navbar-item" href="#调试流程-1">4.2.1&nbsp;&nbsp;调试流程</a>
                    
                    
                    
                    <a class="navbar-item" href="#适用场景-1">4.2.2&nbsp;&nbsp;适用场景</a>
                    
                    
                    
                    <a class="navbar-item" href="#使用-objdump">4.3&nbsp;&nbsp;使用 objdump</a>
                    
                    
                    
                    <a class="navbar-item" href="#调试流程-2">4.3.1&nbsp;&nbsp;调试流程</a>
                    
                    
                    
                    <a class="navbar-item" href="#适用场景-2">4.3.2&nbsp;&nbsp;适用场景</a>
                    
                    
                    
                    <a class="navbar-item" href="#使用-catchsegv">4.4&nbsp;&nbsp;使用 catchsegv</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#如何避免段错误">5&nbsp;&nbsp;<b>如何避免段错误</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#Reference">6&nbsp;&nbsp;<b>Reference</b></a>
                    
                </div>
            </div>
            
            
            <a class="navbar-item" title="GitHub" target="_blank" rel="noopener" href="https://github.com/Dunky-Z">
                
                <i class="fab fa-github"></i>
                
            </a>
               
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            解决 Segmentation fault (core dumped)
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2021-10-20T06:23:02.000Z" itemprop="datePublished">10月 20 2021</time>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="../../../../categories/Bug-%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/">Bug 踩坑记录</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            16 分钟 读完 (约 2393 字)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <h2 id="相关概念"><a href="#相关概念" class="headerlink" title="相关概念"></a>相关概念</h2><h3 id="Core"><a href="#Core" class="headerlink" title="Core"></a>Core</h3><p>在使用半导体作为内存的材料前，人类是利用线圈当作内存的材料（发明者为王安），线圈就叫作 <code>core</code> ，用线圈做的内存就叫作 <code>core memory</code>。如今，半导体工业澎勃发展，已经没有人用<code>core memory</code> 了，不过，在许多情况下，人们还是把记忆体叫作 <code>core</code> 。</p>
<h3 id="Core-dump"><a href="#Core-dump" class="headerlink" title="Core dump"></a>Core dump</h3><p>我们在开发（或使用）一个程序时，最怕的就是程序莫明其妙地宕掉。虽然系统没事，但我们下次仍可能遇到相同的问题。于是这时操作系统就会把程序宕掉时的内存内容 <code>dump</code> 出来（现在通常是写在一个叫 <code>core</code> 的 <code>file</code> 里面），让我们做为参考。这个动作就叫作 <code>core dump</code>。</p>
<h3 id="如何获取-Core-文件"><a href="#如何获取-Core-文件" class="headerlink" title="如何获取 Core 文件"></a>如何获取 Core 文件</h3><p>1、在一些 Linux 版本下，默认是不产生<code>core</code>文件的，首先可以查看一下系统<code>core</code>文件的大小限制：</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-symbol">$</span>:~/segfault<span class="hljs-symbol">$</span> ulimit -c<br><span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>2、可以看到默认设置情况下，本机 Linux 环境下发生段错误时不会自动生成<code>core</code>文件，下面设置下<code>core</code>文件的大小限制（单位为 KB）：</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-symbol">$</span>:~/segfault<span class="hljs-symbol">$</span> ulimit -c <span class="hljs-number">1024</span><br><span class="hljs-symbol">$</span>:~/segfault<span class="hljs-symbol">$</span> ulimit -c<br><span class="hljs-number">1024</span><br></code></pre></td></tr></table></figure>

<p>3、重新运行程序，如果发生段错误，就会生成<code>core</code>文件。</p>
<h2 id="出现段错误的可能原因"><a href="#出现段错误的可能原因" class="headerlink" title="出现段错误的可能原因"></a>出现段错误的可能原因</h2><h3 id="访问不存在的内存地址"><a href="#访问不存在的内存地址" class="headerlink" title="访问不存在的内存地址"></a>访问不存在的内存地址</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>        <span class="hljs-keyword">int</span> *ptr = <span class="hljs-literal">NULL</span>;<br>        *ptr = <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="访问系统保护的内存地址"><a href="#访问系统保护的内存地址" class="headerlink" title="访问系统保护的内存地址"></a>访问系统保护的内存地址</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>        <span class="hljs-keyword">int</span> *ptr = (<span class="hljs-keyword">int</span> *)<span class="hljs-number">0</span>;<br>        *ptr = <span class="hljs-number">100</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="访问只读的内存地址"><a href="#访问只读的内存地址" class="headerlink" title="访问只读的内存地址"></a>访问只读的内存地址</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;string.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>        <span class="hljs-keyword">char</span> *ptr = <span class="hljs-string">&quot;test&quot;</span>;<br>        <span class="hljs-built_in">strcpy</span>(ptr, <span class="hljs-string">&quot;TEST&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="栈溢出"><a href="#栈溢出" class="headerlink" title="栈溢出"></a>栈溢出</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>        main();<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="段错误信息获取"><a href="#段错误信息获取" class="headerlink" title="段错误信息获取"></a>段错误信息获取</h2><p>程序发生段错误时，提示信息很少，下面有几种查看段错误的发生信息的途径。</p>
<h3 id="dmesg"><a href="#dmesg" class="headerlink" title="dmesg"></a>dmesg</h3><p>dmesg 可以在应用程序 crash 掉时，显示内核中保存的相关信息。如下所示，通过<code>dmesg</code>命令可以查看发生段错误的程序名称、引起段错误发生的内存地址、指令指针地址、堆栈指针地址、错误代码、错误原因等。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">$:~/segfault$ dmesg<br><span class="hljs-selector-attr">[ 2329.479037]</span> segfault3<span class="hljs-selector-attr">[2700]</span>: segfault at <span class="hljs-number">80484</span>e0 ip <span class="hljs-number">00</span>d2906a sp bfbbec3c error <span class="hljs-number">7</span> <span class="hljs-keyword">in</span> libc-<span class="hljs-number">2.10</span>.<span class="hljs-number">1</span><span class="hljs-selector-class">.so</span><span class="hljs-selector-attr">[cb4000+13e000]</span><br></code></pre></td></tr></table></figure>

<h3 id="g"><a href="#g" class="headerlink" title="-g"></a>-g</h3><p>使用 gcc 编译程序的源码时，加上<code>-g</code>参数，这样可以使得生成的二进制文件中加入可以用于 gdb 调试的有用信息。</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-symbol">$</span>:~/segfault<span class="hljs-symbol">$</span> gcc -g -o segfault3 segfault3.c<br><br></code></pre></td></tr></table></figure>

<h3 id="nm"><a href="#nm" class="headerlink" title="nm"></a>nm</h3><p>使用 nm 命令列出二进制文件中的符号表，包括符号地址、符号类型、符号名等，这样可以帮助定位在哪里发生了段错误。</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs sqf">panfeng@ubuntu:~/segfault$ nm segfault3<br><span class="hljs-number">08049</span>f20 d <span class="hljs-variable">_DYNAMIC</span><br><span class="hljs-number">08049</span>ff4 d <span class="hljs-variable">_GLOBAL_OFFSET_TABLE_</span><br><span class="hljs-number">080484</span>dc R <span class="hljs-variable">_IO_stdin_used</span><br>         w <span class="hljs-variable">_Jv_RegisterClasses</span><br><span class="hljs-number">08049</span>f10 d <span class="hljs-variable">__CTOR_END__</span><br><span class="hljs-number">08049</span>f0c d <span class="hljs-variable">__CTOR_LIST__</span><br><span class="hljs-number">08049</span>f18 D <span class="hljs-variable">__DTOR_END__</span><br><span class="hljs-number">08049</span>f14 d <span class="hljs-variable">__DTOR_LIST__</span><br><span class="hljs-number">080484</span>ec r <span class="hljs-variable">__FRAME_END__</span><br><span class="hljs-number">08049</span>f1c d <span class="hljs-variable">__JCR_END__</span><br><span class="hljs-number">08049</span>f1c d <span class="hljs-variable">__JCR_LIST__</span><br><span class="hljs-number">0804</span>a014 A <span class="hljs-variable">__bss_start</span><br><span class="hljs-number">0804</span>a00c D <span class="hljs-variable">__data_start</span><br><span class="hljs-number">08048490</span> t <span class="hljs-variable">__do_global_ctors_aux</span><br><span class="hljs-number">08048360</span> t <span class="hljs-variable">__do_global_dtors_aux</span><br><span class="hljs-number">0804</span>a010 D <span class="hljs-variable">__dso_handle</span><br>         w <span class="hljs-variable">__gmon_start__</span><br><span class="hljs-number">0804848</span>a T <span class="hljs-variable">__i686</span>.get_pc_thunk.bx<br><span class="hljs-number">08049</span>f0c d <span class="hljs-variable">__init_array_end</span><br><span class="hljs-number">08049</span>f0c d <span class="hljs-variable">__init_array_start</span><br><span class="hljs-number">08048420</span> T <span class="hljs-variable">__libc_csu_fini</span><br><span class="hljs-number">08048430</span> T <span class="hljs-variable">__libc_csu_init</span><br>         U <span class="hljs-variable">__libc_start_main</span>@@GLIBC_2.<span class="hljs-number">0</span><br><span class="hljs-number">0804</span>a014 A <span class="hljs-variable">_edata</span><br><span class="hljs-number">0804</span>a01c A <span class="hljs-variable">_end</span><br><span class="hljs-number">080484</span>bc T <span class="hljs-variable">_fini</span><br><span class="hljs-number">080484</span>d8 R <span class="hljs-variable">_fp_hw</span><br><span class="hljs-number">080482</span>bc T <span class="hljs-variable">_init</span><br><span class="hljs-number">08048330</span> T <span class="hljs-variable">_start</span><br><span class="hljs-number">0804</span>a014 b completed.<span class="hljs-number">6990</span><br><span class="hljs-number">0804</span>a00c W data_start<br><span class="hljs-number">0804</span>a018 b dtor_idx.<span class="hljs-number">6992</span><br><span class="hljs-number">080483</span>c0 t frame_dummy<br><span class="hljs-number">080483</span>e4 T main<br>         U memcpy@@GLIBC_2.<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<h3 id="ldd"><a href="#ldd" class="headerlink" title="ldd"></a>ldd</h3><p>使用 ldd 命令查看二进制程序的共享链接库依赖，包括库的名称、起始地址，这样可以确定段错误到底是发生在了自己的程序中还是依赖的共享库中。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">$:~<span class="hljs-regexp">/segfault$ ldd ./</span>segfault3<br>    linux-gate.so.<span class="hljs-number">1</span> =&gt;  (<span class="hljs-number">0</span>x00e08000)<br>    libc.so.<span class="hljs-number">6</span> =&gt; <span class="hljs-regexp">/lib/</span>tls<span class="hljs-regexp">/i686/</span>cmov/libc.so.<span class="hljs-number">6</span> (<span class="hljs-number">0</span>x00675000)<br>    <span class="hljs-regexp">/lib/</span>ld-linux.so.<span class="hljs-number">2</span> (<span class="hljs-number">0</span>x00482000)<br></code></pre></td></tr></table></figure>

<h2 id="调试方法和技巧"><a href="#调试方法和技巧" class="headerlink" title="调试方法和技巧"></a>调试方法和技巧</h2><h3 id="使用-gcc-和-gdb"><a href="#使用-gcc-和-gdb" class="headerlink" title="使用 gcc 和 gdb"></a>使用 gcc 和 gdb</h3><h4 id="调试流程"><a href="#调试流程" class="headerlink" title="调试流程"></a>调试流程</h4><ol>
<li>为了能够使用 gdb 调试程序，在编译阶段加上-g 参数，</li>
</ol>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-symbol">$</span>:~/segfault<span class="hljs-symbol">$</span> gcc -g -o segfault3 segfault3.c<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>使用 gdb 命令调试程序：</li>
</ol>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gradle">$:~<span class="hljs-regexp">/segfault$ gdb -q ./</span>segfault3 <br>Reading symbols <span class="hljs-keyword">from</span> ./segfault3...done.<br>(gdb) <br></code></pre></td></tr></table></figure>

<ol start="3">
<li>进入 gdb 后，运行程序：</li>
</ol>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gradle">(gdb) run<br>Starting program: ./segfault3 <br><br>Program received signal SIGSEGV, Segmentation fault.<br><span class="hljs-number">0</span>x001a306a in memcpy () <span class="hljs-keyword">from</span> <span class="hljs-regexp">/lib/</span>tls<span class="hljs-regexp">/i686/</span>cmov/libc.so.<span class="hljs-number">6</span><br>(gdb) <br></code></pre></td></tr></table></figure>

<p>从输出看出，程序收到<code>SIGSEGV</code>信号，触发段错误，并提示地址<code>0x001a306a</code>、调用 memcpy 报的错，位于<code>/lib/tls/i686/cmov/libc.so.6</code>库中。</p>
<ol start="4">
<li>完成调试后，输入<code>quit</code>命令退出 gdb：</li>
</ol>
<h4 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h4><ol>
<li><p>仅当能确定程序一定会发生段错误的情况下使用。</p>
</li>
<li><p>当程序的源码可以获得的情况下，使用<code>-g</code>参数编译程序。</p>
</li>
<li><p>一般用于测试阶段，生产环境下 gdb 会有副作用：使程序运行减慢，运行不够稳定，等等。</p>
</li>
<li><p>即使在测试阶段，如果程序过于复杂，gdb 也不能处理。</p>
</li>
</ol>
<h3 id="使用-core-文件和-gdb"><a href="#使用-core-文件和-gdb" class="headerlink" title="使用 core 文件和 gdb"></a>使用 core 文件和 gdb</h3><p>在上节中提到段错误会触发<code>SIGSEGV</code>信号，通过<code>man 7 signal</code>，可以看到<code>SIGSEGV</code>默认的<code>handler</code>会打印段错误出错信息，并产生<code>core</code>文件，由此我们可以借助于程序异常退出时生成的<code>core</code>文件中的调试信息，使用 gdb 工具来调试程序中的段错误。</p>
<h4 id="调试流程-1"><a href="#调试流程-1" class="headerlink" title="调试流程"></a>调试流程</h4><ol>
<li>运行有段错误的程序，生成 core 文件。</li>
<li>gdb 加载 core 文件</li>
</ol>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">$:~/segfault$ gdb ./segfault3 ./core <br>Reading symbols <span class="hljs-keyword">from</span> /home/panfeng/segfault/segfault3...done.<br><br><span class="hljs-symbol">warning:</span> Can<span class="hljs-comment">&#x27;t read pathname for load map: 输入/输出错误.</span><br>Reading symbols <span class="hljs-keyword">from</span> /<span class="hljs-keyword">lib</span>/tls/i686/cmov/libc.so.<span class="hljs-number">6</span>...(no debugging symbols found)...done.<br>Loaded symbols <span class="hljs-keyword">for</span> /<span class="hljs-keyword">lib</span>/tls/i686/cmov/libc.so.<span class="hljs-number">6</span><br>Reading symbols <span class="hljs-keyword">from</span> /<span class="hljs-keyword">lib</span>/ld-linux.so.<span class="hljs-number">2</span>...(no debugging symbols found)...done.<br>Loaded symbols <span class="hljs-keyword">for</span> /<span class="hljs-keyword">lib</span>/ld-linux.so.<span class="hljs-number">2</span><br>Core was generated <span class="hljs-keyword">by</span> `./segfault3<span class="hljs-comment">&#x27;.</span><br>Program terminated <span class="hljs-keyword">with</span> signal <span class="hljs-number">11</span>, Segmentation fault.<br>#<span class="hljs-number">0</span>  <span class="hljs-number">0</span>x0018506a <span class="hljs-keyword">in</span> memcpy () <span class="hljs-keyword">from</span> /<span class="hljs-keyword">lib</span>/tls/i686/cmov/libc.<span class="hljs-number">6</span><br></code></pre></td></tr></table></figure>

<p>从输出看出，同上节中一样的段错误信息。</p>
<h4 id="适用场景-1"><a href="#适用场景-1" class="headerlink" title="适用场景"></a>适用场景</h4><ol>
<li><p>适合于在实际生成环境下调试程序的段错误（即在不用重新发生段错误的情况下重现段错误）。</p>
</li>
<li><p>当程序很复杂，core 文件相当大时，该方法不可用。</p>
</li>
</ol>
<h3 id="使用-objdump"><a href="#使用-objdump" class="headerlink" title="使用 objdump"></a>使用 objdump</h3><h4 id="调试流程-2"><a href="#调试流程-2" class="headerlink" title="调试流程"></a>调试流程</h4><ol>
<li>使用 dmesg 命令，找到最近发生的段错误输出信息：</li>
</ol>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">$:~<span class="hljs-string">/segfault</span>$ dmesg<br><span class="hljs-string">...</span> <span class="hljs-string">...</span><br>[17257.502808] segfault3[3320]: segfault at 80484e0 ip 0018506a sp bfc1<span class="hljs-keyword">cd</span>6c error 7 in libc-2.10.1.so[110000+13e000]<br></code></pre></td></tr></table></figure>

<p>其中，对我们接下来的调试过程有用的是发生段错误的地址：<code>80484e0</code>和指令指针地址：<code>0018506a</code>。</p>
<ol start="2">
<li>使用<code>objdump</code>生成二进制的相关信息，重定向到文件中：</li>
</ol>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">$:~<span class="hljs-regexp">/segfault$ objdump -d ./</span>segfault3 &gt; segfault3Dump<br></code></pre></td></tr></table></figure>

<p>其中，生成的<code>segfault3Dump</code>文件中包含了二进制文件的<code>segfault3</code>的汇编代码。</p>
<ol start="3">
<li>在<code>segfault3Dump</code>文件中查找发生段错误的地址：</li>
</ol>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">panfeng</span>@ubuntu:~/segfault$ grep -n -A <span class="hljs-number">10</span> -B <span class="hljs-number">10</span> <span class="hljs-string">&quot;80484e0&quot;</span> ./segfault<span class="hljs-number">3</span>Dump <br><span class="hljs-attribute">121</span>- <span class="hljs-number">80483</span>df:    ff d<span class="hljs-number">0</span>                    call   *%eax<br><span class="hljs-attribute">122</span>- <span class="hljs-number">80483</span>e<span class="hljs-number">1</span>:    c<span class="hljs-number">9</span>                       leave  <br><span class="hljs-attribute">123</span>- <span class="hljs-number">80483</span>e<span class="hljs-number">2</span>:    c<span class="hljs-number">3</span>                       ret    <br><span class="hljs-attribute">124</span>- <span class="hljs-number">80483</span>e<span class="hljs-number">3</span>:    <span class="hljs-number">90</span>                       nop<br><span class="hljs-attribute">125</span>-<br><span class="hljs-attribute">126</span>-<span class="hljs-number">080483</span>e<span class="hljs-number">4</span> &lt;main&gt;:<br><span class="hljs-attribute">127</span>- <span class="hljs-number">80483</span>e<span class="hljs-number">4</span>:    <span class="hljs-number">55</span>                       push   %ebp<br><span class="hljs-attribute">128</span>- <span class="hljs-number">80483</span>e<span class="hljs-number">5</span>:    <span class="hljs-number">89</span> e<span class="hljs-number">5</span>                    mov    %esp,%ebp<br><span class="hljs-attribute">129</span>- <span class="hljs-number">80483</span>e<span class="hljs-number">7</span>:    <span class="hljs-number">83</span> e<span class="hljs-number">4</span> f<span class="hljs-number">0</span>                 and    $<span class="hljs-number">0</span>xfffffff<span class="hljs-number">0</span>,%esp<br><span class="hljs-attribute">130</span>- <span class="hljs-number">80483</span>ea:    <span class="hljs-number">83</span> ec <span class="hljs-number">20</span>                 sub    $<span class="hljs-number">0</span>x<span class="hljs-number">20</span>,%esp<br><span class="hljs-attribute">131</span>: <span class="hljs-number">80483</span>ed:    c<span class="hljs-number">7</span> <span class="hljs-number">44</span> <span class="hljs-number">24</span> <span class="hljs-number">1</span>c e<span class="hljs-number">0</span> <span class="hljs-number">84</span> <span class="hljs-number">04</span>     movl   $<span class="hljs-number">0</span>x<span class="hljs-number">80484</span>e<span class="hljs-number">0</span>,<span class="hljs-number">0</span>x<span class="hljs-number">1</span>c(%esp)<br><span class="hljs-attribute">132</span>- <span class="hljs-number">80483</span>f<span class="hljs-number">4</span>:    <span class="hljs-number">08</span> <br><span class="hljs-attribute">133</span>- <span class="hljs-number">80483</span>f<span class="hljs-number">5</span>:    b<span class="hljs-number">8</span> e<span class="hljs-number">5</span> <span class="hljs-number">84</span> <span class="hljs-number">04</span> <span class="hljs-number">08</span>           mov    $<span class="hljs-number">0</span>x<span class="hljs-number">80484</span>e<span class="hljs-number">5</span>,%eax<br><span class="hljs-attribute">134</span>- <span class="hljs-number">80483</span>fa:    c<span class="hljs-number">7</span> <span class="hljs-number">44</span> <span class="hljs-number">24</span> <span class="hljs-number">08</span> <span class="hljs-number">05</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>     movl   $<span class="hljs-number">0</span>x<span class="hljs-number">5</span>,<span class="hljs-number">0</span>x<span class="hljs-number">8</span>(%esp)<br><span class="hljs-attribute">135</span>- <span class="hljs-number">8048401</span>:    <span class="hljs-number">00</span> <br><span class="hljs-attribute">136</span>- <span class="hljs-number">8048402</span>:    <span class="hljs-number">89</span> <span class="hljs-number">44</span> <span class="hljs-number">24</span> <span class="hljs-number">04</span>              mov    %eax,<span class="hljs-number">0</span>x<span class="hljs-number">4</span>(%esp)<br><span class="hljs-attribute">137</span>- <span class="hljs-number">8048406</span>:    <span class="hljs-number">8</span>b <span class="hljs-number">44</span> <span class="hljs-number">24</span> <span class="hljs-number">1</span>c              mov    <span class="hljs-number">0</span>x<span class="hljs-number">1</span>c(%esp),%eax<br><span class="hljs-attribute">138</span>- <span class="hljs-number">804840</span>a:    <span class="hljs-number">89</span> <span class="hljs-number">04</span> <span class="hljs-number">24</span>                 mov    %eax,(%esp)<br><span class="hljs-attribute">139</span>- <span class="hljs-number">804840</span>d:    e<span class="hljs-number">8</span> <span class="hljs-number">0</span>a ff ff ff           call   <span class="hljs-number">804831</span>c &lt;memcpy@plt&gt;<br><span class="hljs-attribute">140</span>- <span class="hljs-number">8048412</span>:    c<span class="hljs-number">9</span>                       leave  <br><span class="hljs-attribute">141</span>- <span class="hljs-number">8048413</span>:    c<span class="hljs-number">3</span>                       ret    <br></code></pre></td></tr></table></figure>

<p>通过对以上汇编代码分析，得知段错误发生<code>main</code>函数，对应的汇编指令是<code>movl $0x80484e0,0x1c(%esp)</code>，接下来打开程序的源码，找到汇编指令对应的源码，也就定位到段错误了。</p>
<h4 id="适用场景-2"><a href="#适用场景-2" class="headerlink" title="适用场景"></a>适用场景</h4><ol>
<li>不需要<code>-g</code>参数编译，不需要借助于<code>core</code>文件，但需要有一定的汇编语言基础。</li>
</ol>
<p>2、如果使用了 gcc 编译优化参数（-O1，-O2，-O3）的话，生成的汇编指令将会被优化，使得调试过程有些难度。</p>
<h3 id="使用-catchsegv"><a href="#使用-catchsegv" class="headerlink" title="使用 catchsegv"></a>使用 catchsegv</h3><p><code>catchsegv</code>命令专门用来扑获段错误，它通过动态加载器（ld-linux.so）的预加载机制（PRELOAD）把一个事先写好的库（/lib/libSegFault.so）加载上，用于捕捉断错误的出错信息。</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs maxima">$:~/segfault$ catchsegv ./segfault3<br>Segmentation fault (core dumped)<br>*** Segmentation fault<br>Register dump:<br><br> EAX: <span class="hljs-number">00000000</span>   EBX: <span class="hljs-number">00fb3ff4</span>   ECX: <span class="hljs-number">00000002</span>   EDX: <span class="hljs-number">00000000</span><br> ESI: <span class="hljs-number">080484e5</span>   EDI: <span class="hljs-number">080484e0</span>   EBP: bfb7ad38   ESP: bfb7ad0c<br><br> EIP: <span class="hljs-number">00ee806a</span>   EFLAGS: <span class="hljs-number">00010203</span><br><br> CS: <span class="hljs-number">0073</span>   DS: <span class="hljs-number">007b</span>   ES: <span class="hljs-number">007b</span>   FS: <span class="hljs-number">0000</span>   GS: <span class="hljs-number">0033</span>   SS: <span class="hljs-number">007b</span><br><br> Trap: <span class="hljs-number">0000000e</span>   Error: <span class="hljs-number">00000007</span>   OldMask: <span class="hljs-number">00000000</span><br> ESP/signal: bfb7ad0c   CR2: <span class="hljs-number">080484e0</span><br><br>Backtrace:<br>/lib/libSegFault.so[<span class="hljs-number">0x3b606f</span>]<br>??:<span class="hljs-number">0</span>(??)[<span class="hljs-number">0xc76400</span>]<br>/lib/tls/i686/cmov/libc.so<span class="hljs-number">.6</span>(__libc_start_main+<span class="hljs-number">0xe6</span>)[<span class="hljs-number">0xe89b56</span>]<br>/build/buildd/eglibc-<span class="hljs-number">2.10</span><span class="hljs-number">.1</span>/csu/../sysdeps/i386/elf/start.S:<span class="hljs-number">122</span>(_start)[<span class="hljs-number">0x8048351</span>]<br><br>Memory <span class="hljs-built_in">map</span>:<br><br><span class="hljs-number">00258000</span>-<span class="hljs-number">00273000</span> r-xp <span class="hljs-number">00000000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">157</span> /lib/ld-<span class="hljs-number">2.10</span><span class="hljs-number">.1</span>.so<br><span class="hljs-number">00273000</span>-<span class="hljs-number">00274000</span> r--p <span class="hljs-number">0001a000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">157</span> /lib/ld-<span class="hljs-number">2.10</span><span class="hljs-number">.1</span>.so<br><span class="hljs-number">00274000</span>-<span class="hljs-number">00275000</span> rw-p <span class="hljs-number">0001b000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">157</span> /lib/ld-<span class="hljs-number">2.10</span><span class="hljs-number">.1</span>.so<br><span class="hljs-number">003b4000</span>-<span class="hljs-number">003b7000</span> r-xp <span class="hljs-number">00000000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">13105</span> /lib/libSegFault.so<br><span class="hljs-number">003b7000</span>-<span class="hljs-number">003b8000</span> r--p <span class="hljs-number">00002000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">13105</span> /lib/libSegFault.so<br><span class="hljs-number">003b8000</span>-<span class="hljs-number">003b9000</span> rw-p <span class="hljs-number">00003000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">13105</span> /lib/libSegFault.so<br><span class="hljs-number">00c76000</span>-<span class="hljs-number">00c77000</span> r-xp <span class="hljs-number">00000000</span> <span class="hljs-number">00</span>:<span class="hljs-number">00</span> <span class="hljs-number">0</span> [vdso]<br><span class="hljs-number">00e0d000</span>-<span class="hljs-number">00e29000</span> r-xp <span class="hljs-number">00000000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">4817</span> /lib/libgcc_s.so<span class="hljs-number">.1</span><br><span class="hljs-number">00e29000</span>-<span class="hljs-number">00e2a000</span> r--p <span class="hljs-number">0001b000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">4817</span> /lib/libgcc_s.so<span class="hljs-number">.1</span><br><span class="hljs-number">00e2a000</span>-<span class="hljs-number">00e2b000</span> rw-p <span class="hljs-number">0001c000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">4817</span> /lib/libgcc_s.so<span class="hljs-number">.1</span><br><span class="hljs-number">00e73000</span>-<span class="hljs-number">00fb1000</span> r-xp <span class="hljs-number">00000000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">1800</span> /lib/tls/i686/cmov/libc-<span class="hljs-number">2.10</span><span class="hljs-number">.1</span>.so<br><span class="hljs-number">00fb1000</span>-<span class="hljs-number">00fb2000</span> ---p <span class="hljs-number">0013e000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">1800</span> /lib/tls/i686/cmov/libc-<span class="hljs-number">2.10</span><span class="hljs-number">.1</span>.so<br><span class="hljs-number">00fb2000</span>-<span class="hljs-number">00fb4000</span> r--p <span class="hljs-number">0013e000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">1800</span> /lib/tls/i686/cmov/libc-<span class="hljs-number">2.10</span><span class="hljs-number">.1</span>.so<br><span class="hljs-number">00fb4000</span>-<span class="hljs-number">00fb5000</span> rw-p <span class="hljs-number">00140000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">1800</span> /lib/tls/i686/cmov/libc-<span class="hljs-number">2.10</span><span class="hljs-number">.1</span>.so<br><span class="hljs-number">00fb5000</span>-<span class="hljs-number">00fb8000</span> rw-p <span class="hljs-number">00000000</span> <span class="hljs-number">00</span>:<span class="hljs-number">00</span> <span class="hljs-number">0</span><br><span class="hljs-number">08048000</span>-<span class="hljs-number">08049000</span> r-xp <span class="hljs-number">00000000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">303895</span> /home/segfault/segfault3<br><span class="hljs-number">08049000</span>-<span class="hljs-number">0804a000</span> r--p <span class="hljs-number">00000000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">303895</span> /home/segfault/segfault3<br><span class="hljs-number">0804a000</span>-<span class="hljs-number">0804b000</span> rw-p <span class="hljs-number">00001000</span> <span class="hljs-number">08</span>:<span class="hljs-number">01</span> <span class="hljs-number">303895</span> /home/segfault/segfault3<br><span class="hljs-number">09432000</span>-<span class="hljs-number">09457000</span> rw-p <span class="hljs-number">00000000</span> <span class="hljs-number">00</span>:<span class="hljs-number">00</span> <span class="hljs-number">0</span> [heap]<br>b78cf000-b78d1000 rw-p <span class="hljs-number">00000000</span> <span class="hljs-number">00</span>:<span class="hljs-number">00</span> <span class="hljs-number">0</span><br>b78df000-b78e1000 rw-p <span class="hljs-number">00000000</span> <span class="hljs-number">00</span>:<span class="hljs-number">00</span> <span class="hljs-number">0</span><br>bfb67000-bfb7c000 rw-p <span class="hljs-number">00000000</span> <span class="hljs-number">00</span>:<span class="hljs-number">00</span> <span class="hljs-number">0</span> [stack]<br></code></pre></td></tr></table></figure>

<h2 id="如何避免段错误"><a href="#如何避免段错误" class="headerlink" title="如何避免段错误"></a>如何避免段错误</h2><ol>
<li><p>出现段错误时，首先应该想到段错误的定义，从它出发考虑引发错误的原因。</p>
</li>
<li><p>在使用指针时，定义了指针后记得初始化指针，在使用的时候记得判断是否为 NULL。</p>
</li>
<li><p>在使用数组时，注意数组是否被初始化，数组下标是否越界，数组元素是否存在等。</p>
</li>
<li><p>在访问变量时，注意变量所占地址空间是否已经被程序释放掉。</p>
</li>
<li><p>在处理变量时，注意变量的格式控制是否合理等。</p>
</li>
</ol>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">
    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="../../../../tags/C/">#C</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="../../../../tags/Bug/">#Bug</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="../RISC-V%E5%85%A5%E9%97%A8-RVOS%E7%B3%BB%E7%BB%9F%E5%BC%95%E5%AF%BC/">RISC-V 入门-RVOS 系统引导</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="../../16/RISC-V%E5%85%A5%E9%97%A8-RISC-V%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A8%8B/">RISC-V 入门-RISC-V 汇编语言编程</a>
            
        </span>
    </div>
    
</article>


<div class="sharebox">
    
<div class="notification is-danger">
    You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.
</div>

</div>



<div class="comments">
    <h3 class="title is-4">评论</h3>
    
<script>
    var disqus_config = function () {
        this.page.url = 'https://lifeislife.cn/2021/10/20/%E8%A7%A3%E5%86%B3Segmentation-fault-core-dumped/';
        this.page.identifier = '2021/10/20/解决Segmentation-fault-core-dumped/';
        
        this.language = 'zh';
        
    };
    (function() {
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'dominic' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<div id="disqus_thread">
    
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2024 Dominic&nbsp;
                powered_by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow has-text-black" title="GitHub" target="_blank" rel="noopener" href="https://github.com/ppoffice/hexo-theme-minos">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("zh-CN");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
</script>

    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery > p > .gallery-item').unwrap();
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    



<script src="../../../../js/script.js"></script>


    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="站内搜索" />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '../../../../content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>

<script src="../../../../js/insight.js"></script>

    
</body>
</html>