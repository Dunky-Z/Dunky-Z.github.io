<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>Qt 模仿登录界面-窗口布局及样式 - 如云泊</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">




<meta name="description" content="">










<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">


<link rel="stylesheet" href="../../../../css/style.css">


<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>



<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="atom.xml" title="如云泊" type="application/atom+xml">
</head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="../../../../index.html">
                
                <img src="../../../../images/logo.png" alt="" height="28">
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-end">
            
            
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            Qt 模仿登录界面-窗口布局及样式
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2021-08-17T03:30:06.000Z" itemprop="datePublished">8月 17 2021</time>
            
        </span>
        
        
        <span class="column is-narrow">
            
            
            6 分钟 读完 (约 974 字)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <h2 id="框架类图"><a href="#框架类图" class="headerlink" title="框架类图"></a>框架类图</h2><p><img src="https://picbed-1311007548.cos.ap-shanghai.myqcloud.com/markdown_picbed/img/20210827120419.png"></p>
<h2 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h2><p><img src="https://picbed-1311007548.cos.ap-shanghai.myqcloud.com/markdown_picbed/img/20210818130510.gif"><br>完整项目及资源文件请在<a target="_blank" rel="noopener" href="https://github.com/Dunky-Z/learning-qt/tree/main/Demo/login">Github</a>查看。</p>
<h2 id="页面布局"><a href="#页面布局" class="headerlink" title="页面布局"></a>页面布局</h2><p><img src="https://picbed-1311007548.cos.ap-shanghai.myqcloud.com/markdown_picbed/img/20210820101857.png"></p>
<h2 id="初始化标题栏"><a href="#初始化标题栏" class="headerlink" title="初始化标题栏"></a>初始化标题栏</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 初始化标题栏;</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">LoginWindow::initMyTitle</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">// 因为这里有控件层叠了，所以要注意控件 raise() 方法的调用顺序;</span><br>    m_titleBar-&gt;<span class="hljs-built_in">move</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>    m_titleBar-&gt;<span class="hljs-built_in">raise</span>();<br>    m_titleBar-&gt;<span class="hljs-built_in">setBackgroundColor</span>(<span class="hljs-number">100</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">true</span>);<br>    m_titleBar-&gt;<span class="hljs-built_in">setButtonType</span>(MIN_BUTTON);<br>    m_titleBar-&gt;<span class="hljs-built_in">setTitleWidth</span>(<span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">width</span>());<br>    <span class="hljs-comment">// 这里需要设置成 false，不允许通过标题栏拖动来移动窗口位置，否则会造成窗口位置错误;</span><br>    m_titleBar-&gt;<span class="hljs-built_in">setMoveParentWindowFlag</span>(<span class="hljs-literal">false</span>);<br>    ui-&gt;pButtonArrow-&gt;<span class="hljs-built_in">raise</span>();<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="raise-将控件置于顶层"><a href="#raise-将控件置于顶层" class="headerlink" title="raise()将控件置于顶层"></a><code>raise()</code>将控件置于顶层</h3><p>程序在打开后一般都在所有窗体的顶层，打开其他程序后之前的程序就会被放到下一层，在这里，当设置完<code>my_titleBar</code>后对其他控件操作就会把<code>my_titleBar</code>控件覆盖。所有要用<code>raise()</code>方法将其置于顶层。</p>
<h2 id="初始化窗口"><a href="#初始化窗口" class="headerlink" title="初始化窗口"></a>初始化窗口</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// 初始化窗口;</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">LoginWindow::initWindow</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">//背景 GIG 图;</span><br>    QLabel* pBack = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-keyword">this</span>);<br>    QMovie *movie = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QMovie</span>();<br>    movie-&gt;<span class="hljs-built_in">setFileName</span>(<span class="hljs-string">&quot;:/Resources/LoginWindow/back.gif&quot;</span>);<br>    pBack-&gt;<span class="hljs-built_in">setMovie</span>(movie);<br>    movie-&gt;<span class="hljs-built_in">start</span>();<br>    pBack-&gt;<span class="hljs-built_in">move</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br><br>    <span class="hljs-comment">//文本框内提示</span><br>    ui-&gt;accountComboBox-&gt;<span class="hljs-built_in">setEditable</span>(<span class="hljs-literal">true</span>);<br>    QLineEdit* lineEdit = ui-&gt;accountComboBox-&gt;<span class="hljs-built_in">lineEdit</span>();<br>    lineEdit-&gt;<span class="hljs-built_in">setPlaceholderText</span>(<span class="hljs-built_in">QStringLiteral</span>(<span class="hljs-string">&quot;QQ 号码/手机/邮箱&quot;</span>));<br>    <span class="hljs-function">QRegExp <span class="hljs-title">regExp</span><span class="hljs-params">(<span class="hljs-string">&quot;[A-Za-z0-9_]&#123;6,30&#125;&quot;</span>)</span></span>; <span class="hljs-comment">//正则表达式限制用户名输入不能输入汉字</span><br>    lineEdit-&gt;<span class="hljs-built_in">setValidator</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">QRegExpValidator</span>(regExp,<span class="hljs-keyword">this</span>));<br>    ui-&gt;passwordEdit-&gt;<span class="hljs-built_in">setPlaceholderText</span>(<span class="hljs-built_in">QStringLiteral</span>(<span class="hljs-string">&quot;密码&quot;</span>));<br><br>    <span class="hljs-comment">//密码框中的小键盘按钮;</span><br>    m_keyboardButton = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QPushButton</span>();<br>    m_keyboardButton-&gt;<span class="hljs-built_in">setObjectName</span>(<span class="hljs-string">&quot;pButtonKeyboard&quot;</span>);<br>    m_keyboardButton-&gt;<span class="hljs-built_in">setFixedSize</span>(<span class="hljs-built_in">QSize</span>(<span class="hljs-number">16</span>, <span class="hljs-number">16</span>));<br>    m_keyboardButton-&gt;<span class="hljs-built_in">setCursor</span>(<span class="hljs-built_in">QCursor</span>(Qt::PointingHandCursor));<span class="hljs-comment">//鼠标放上去变成手形</span><br><br>    QHBoxLayout* passwordEditLayout = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QHBoxLayout</span>();<br>    passwordEditLayout-&gt;<span class="hljs-built_in">addStretch</span>();<br>    passwordEditLayout-&gt;<span class="hljs-built_in">addWidget</span>(m_keyboardButton);<br>    passwordEditLayout-&gt;<span class="hljs-built_in">setSpacing</span>(<span class="hljs-number">0</span>);<br>    passwordEditLayout-&gt;<span class="hljs-built_in">setContentsMargins</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>);<br><br>    ui-&gt;passwordEdit-&gt;<span class="hljs-built_in">setLayout</span>(passwordEditLayout);<br>    <span class="hljs-comment">//设置密码达到最长时最后一个字符离小键盘图标的距离（12）</span><br>    ui-&gt;passwordEdit-&gt;<span class="hljs-built_in">setTextMargins</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, m_keyboardButton-&gt;<span class="hljs-built_in">width</span>() + <span class="hljs-number">12</span>, <span class="hljs-number">0</span>);<br><br>    <span class="hljs-comment">//设置头像以及状态图标</span><br>    ui-&gt;userHead-&gt;<span class="hljs-built_in">setPixmap</span>(<span class="hljs-built_in">QPixmap</span>(<span class="hljs-string">&quot;:/Resources/LoginWindow/HeadImage.png&quot;</span>));<br>    ui-&gt;loginState-&gt;<span class="hljs-built_in">setIcon</span>(<span class="hljs-built_in">QIcon</span>(<span class="hljs-string">&quot;:/Resources/LoginWindow/LoginState/state_online.png&quot;</span>));<br>    ui-&gt;loginState-&gt;<span class="hljs-built_in">setIconSize</span>(<span class="hljs-built_in">QSize</span>(<span class="hljs-number">13</span>, <span class="hljs-number">13</span>));<br>&#125;<br></code></pre></td></tr></table></figure>

<p>lineEdit-&gt;setPlaceholderText<br>QStringLiteral:如果该 QString 不会修改的话，那使用 QStringLiteral</p>
<h3 id="setPlaceholderText-设置文本提示"><a href="#setPlaceholderText-设置文本提示" class="headerlink" title="setPlaceholderText()设置文本提示"></a><code>setPlaceholderText()</code>设置文本提示</h3><p>该方法可以设置文本框中的默认文字提示，如图片中的 QQ 号码/手机/邮箱。</p>
<h3 id="setCursor-设置鼠标形态"><a href="#setCursor-设置鼠标形态" class="headerlink" title="setCursor()设置鼠标形态"></a><code>setCursor()</code>设置鼠标形态</h3><p>共有以下 19 种鼠标形态：</p>
<p><img src="https://picbed-1311007548.cos.ap-shanghai.myqcloud.com/markdown_picbed/img/20210820150422.png"></p>
<p>图片来自<a target="_blank" rel="noopener" href="https://blog.csdn.net/taiyang1987912/article/details/35281407">这里</a></p>
<h3 id="addStretch-布局加入弹簧"><a href="#addStretch-布局加入弹簧" class="headerlink" title="addStretch()布局加入弹簧"></a><code>addStretch()</code>布局加入弹簧</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp">QHBoxLayout* passwordEditLayout = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QHBoxLayout</span>();<br>passwordEditLayout-&gt;<span class="hljs-built_in">addStretch</span>();<br>passwordEditLayout-&gt;<span class="hljs-built_in">addWidget</span>(m_keyboardButton);<br></code></pre></td></tr></table></figure>

<p><code>addStretch()</code>用来在布局中平分布局，他就是个弹簧的作用。如果不加参数，就是等于加个弹簧，会把小键盘图标挤到边上。如图：</p>
<p><img src="https://picbed-1311007548.cos.ap-shanghai.myqcloud.com/markdown_picbed/img/20210817143033.png"></p>
<p>如果将代码改一下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp">QHBoxLayout* passwordEditLayout = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QHBoxLayout</span>();<br>passwordEditLayout-&gt;<span class="hljs-built_in">addStretch</span>(<span class="hljs-number">1</span>);<br>passwordEditLayout-&gt;<span class="hljs-built_in">addWidget</span>(m_keyboardButton);<br>passwordEditLayout-&gt;<span class="hljs-built_in">addStretch</span>(<span class="hljs-number">1</span>);<br></code></pre></td></tr></table></figure>

<p>意思就是将除了小键盘图标以外的空间分成两份，那么刚好小键盘图标就是在中间位置，就像两遍各防止了一个弹簧。效果如下：</p>
<p><img src="https://picbed-1311007548.cos.ap-shanghai.myqcloud.com/markdown_picbed/img/20210817143135.png"></p>
<p><code>setSpacing()</code>设置空间之间上下距离，还有一个容易混淆的设置<code>setMargin()</code>表示设置空间与窗口边缘的左右距离。</p>
<p><code>setContentsMargins</code>设置左侧、顶部、右侧和底部边距，以便在布局周围使用。</p>
<p><img src="https://picbed-1311007548.cos.ap-shanghai.myqcloud.com/markdown_picbed/img/20210817144359.png"></p>
<p>现在我们设置的是<code>setContentsMargins(0, 0, 8, 0)</code>，现在我们设置大一点看看效果。</p>
<p><img src="https://picbed-1311007548.cos.ap-shanghai.myqcloud.com/markdown_picbed/img/20210817144532.png"></p>
<p><code>QLineEdit.setTextMargins(left=,top=,right=,bottom=)</code>设置文本边距，这里主要为了设置密码输入过长时，最后一个字符距离小键盘图标有一定间隙。</p>
<h2 id="初始化用户登录信息"><a href="#初始化用户登录信息" class="headerlink" title="初始化用户登录信息"></a>初始化用户登录信息</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//accountitem.cpp</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">LoginWindow::initAccountList</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br> <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++)<br> &#123;<br>  AccountItem *account_item = <span class="hljs-keyword">new</span> <span class="hljs-built_in">AccountItem</span>();<br>  account_item-&gt;<span class="hljs-built_in">setAccountInfo</span>(i, <span class="hljs-built_in">QStringLiteral</span>(<span class="hljs-string">&quot;Dominic_%1号&quot;</span>).<span class="hljs-built_in">arg</span>(i), <span class="hljs-built_in">QString</span>(<span class="hljs-string">&quot;:/Resources/LoginWindow/headImage/head_%1.png&quot;</span>).<span class="hljs-built_in">arg</span>(i));<br>  QListWidgetItem *list_item = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QListWidgetItem</span>(m_Accountlist);<br>  m_Accountlist-&gt;<span class="hljs-built_in">setItemWidget</span>(list_item, account_item);<br> &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">
    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="../../../../tags/Qt/">#Qt</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="../../18/Qt%E6%A8%A1%E4%BB%BF%E7%99%BB%E5%BD%95%E7%95%8C%E9%9D%A2-%E4%BA%A4%E4%BA%92%E5%93%8D%E5%BA%94/">Qt 模仿登录界面-交互响应</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="../../14/Linux%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/">Linux 操作系统-进程间通信</a>
            
        </span>
    </div>
    
</article>




    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2024 Dominic&nbsp;
                powered_by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("zh-CN");
</script>




<script src="../../../../js/script.js"></script>


    
</body>
</html>