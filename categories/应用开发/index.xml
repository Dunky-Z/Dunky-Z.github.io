<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>åº”ç”¨å¼€å‘ on å¤œäº‘æ³Š</title>
    <link>https://lifeislife.cn/categories/%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/</link>
    <description>feedId:57980998056508425+userId:73222296380546048 Recent content in åº”ç”¨å¼€å‘ on å¤œäº‘æ³Š</description>
    <generator>Hugo -- 0.154.2</generator>
    <language>zh</language>
    <lastBuildDate>Fri, 21 Nov 2025 10:10:20 +0000</lastBuildDate>
    <atom:link href="https://lifeislife.cn/categories/%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>OneDrive API ç”³è¯·é…ç½®æŒ‡å— - å®ç°ç½‘ç›˜åŒæ­¥åŠŸèƒ½</title>
      <link>https://lifeislife.cn/posts/onedrive-api%E7%94%B3%E8%AF%B7%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97/</link>
      <pubDate>Fri, 21 Nov 2025 10:10:20 +0000</pubDate>
      <guid>https://lifeislife.cn/posts/onedrive-api%E7%94%B3%E8%AF%B7%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97/</guid>
      <description>&lt;p&gt;åœ¨å¼€å‘åº”ç”¨æ—¶,æˆ‘ä»¬ç»å¸¸éœ€è¦å®ç°æ•°æ®åŒæ­¥åŠŸèƒ½ã€‚ä¾‹å¦‚æˆ‘ä¹‹å‰å¼€å‘çš„è¡¨å•å¡«å†™å·¥å…·(QuickFillForm),å¦‚æœä¸ä¿å­˜åˆ°ç½‘ç›˜,æ¢ä¸ªæµè§ˆå™¨æ•°æ®å°±ä¸¢å¤±äº†;ä½†å¦‚æœæ¥å…¥ OneDrive åŒæ­¥,ç”¨æˆ·å°±èƒ½åœ¨å„ä¸ªè®¾å¤‡ä¸Šæ— ç¼ä½¿ç”¨ã€‚æœ¬æ–‡å°†ä»¥è¿™ä¸ªå®é™…æ¡ˆä¾‹ä¸ºä¾‹,è¯¦ç»†è¯´æ˜å¦‚ä½•ç”³è¯·å’Œé…ç½® OneDrive API,å¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®ç°ç½‘ç›˜åŒæ­¥åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åº”ç”¨åœºæ™¯&#34;&gt;åº”ç”¨åœºæ™¯&lt;/h2&gt;
&lt;p&gt;OneDrive API é€‚ç”¨äºä»¥ä¸‹å¼€å‘åœºæ™¯:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è·¨è®¾å¤‡æ•°æ®åŒæ­¥&lt;/strong&gt;: æµè§ˆå™¨æ’ä»¶ã€æ¡Œé¢åº”ç”¨çš„é…ç½®å’Œæ•°æ®åŒæ­¥&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–‡ä»¶å¤‡ä»½ä¸æ¢å¤&lt;/strong&gt;: è‡ªåŠ¨å¤‡ä»½ç”¨æˆ·æ•°æ®åˆ°äº‘ç«¯,æ”¯æŒä¸€é”®æ¢å¤&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åä½œä¸åˆ†äº«&lt;/strong&gt;: å®ç°æ–‡ä»¶å…±äº«ã€å¤šäººåä½œç¼–è¾‘åŠŸèƒ½&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¦»çº¿è®¿é—®&lt;/strong&gt;: æ”¯æŒç¦»çº¿è¯»å–æ•°æ®,åœ¨çº¿è‡ªåŠ¨åŒæ­¥&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å‰ç½®å‡†å¤‡&#34;&gt;å‰ç½®å‡†å¤‡&lt;/h2&gt;
&lt;p&gt;åœ¨å¼€å§‹ä¹‹å‰,ä½ éœ€è¦å‡†å¤‡:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… Microsoft è´¦å·(ä¸ªäººè´¦å·æˆ–å·¥ä½œ/å­¦æ ¡è´¦å·å‡å¯)&lt;/li&gt;
&lt;li&gt;âœ… å¼€å‘ç¯å¢ƒ(æœ¬æ–‡ä»¥æµè§ˆå™¨æ’ä»¶ä¸ºä¾‹)&lt;/li&gt;
&lt;li&gt;âœ… åŸºç¡€çš„ JavaScript/API è°ƒç”¨çŸ¥è¯†&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æç¤º&lt;/strong&gt;: OneDrive API æä¾›äº†å…è´¹çš„å¼€å‘è€…é…é¢,ä¸ªäººåº”ç”¨å®Œå…¨å¤Ÿç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ç¬¬ä¸€æ­¥-æ³¨å†Œ-azure-åº”ç”¨&#34;&gt;ç¬¬ä¸€æ­¥: æ³¨å†Œ Azure åº”ç”¨&lt;/h2&gt;
&lt;h3 id=&#34;11-è®¿é—®-azure-portal&#34;&gt;1.1 è®¿é—® Azure Portal&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;æ‰“å¼€æµè§ˆå™¨,è®¿é—® &lt;a href=&#34;https://portal.azure.com/&#34;&gt;Azure Portal&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ä½ çš„ Microsoft è´¦å·ç™»å½•
&lt;ul&gt;
&lt;li&gt;ä¸ªäººè´¦å·(å¦‚ Outlookã€Hotmail é‚®ç®±)&lt;/li&gt;
&lt;li&gt;å·¥ä½œæˆ–å­¦æ ¡è´¦å·(å¦‚å…¬å¸/å­¦æ ¡æä¾›çš„ Office 365 è´¦å·)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¦‚æœæ²¡æœ‰ Azure è´¦å·,å¯ä»¥å…è´¹æ³¨å†Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ“Œ &lt;strong&gt;æ³¨æ„&lt;/strong&gt;: å³ä½¿æ²¡æœ‰ Azure è®¢é˜…,ä¹Ÿå¯ä»¥æ³¨å†Œåº”ç”¨ã€‚å…è´¹è´¦å·è¶³å¤Ÿç”¨äºå¼€å‘æµ‹è¯•ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;12-è¿›å…¥åº”ç”¨æ³¨å†Œé¡µé¢&#34;&gt;1.2 è¿›å…¥åº”ç”¨æ³¨å†Œé¡µé¢&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨ Azure Portal é¦–é¡µçš„æœç´¢æ ä¸­è¾“å…¥ &lt;strong&gt;&amp;ldquo;Azure Active Directory&amp;rdquo;&lt;/strong&gt; æˆ– &lt;strong&gt;&amp;ldquo;Microsoft Entra ID&amp;rdquo;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;ç‚¹å‡»æœç´¢ç»“æœä¸­çš„ &lt;strong&gt;Azure Active Directory&lt;/strong&gt; æœåŠ¡&lt;/li&gt;
&lt;li&gt;åœ¨å·¦ä¾§èœå•ä¸­æ‰¾åˆ° &lt;strong&gt;&amp;ldquo;åº”ç”¨æ³¨å†Œ&amp;rdquo;&lt;/strong&gt; (App registrations)&lt;/li&gt;
&lt;li&gt;ç‚¹å‡»é¡¶éƒ¨çš„ &lt;strong&gt;&amp;quot;+ æ–°æ³¨å†Œ&amp;quot;&lt;/strong&gt; (New registration) æŒ‰é’®&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;

&lt;!DOCTYPE html&gt;
&lt;html lang=&#34;en&#34;&gt;
&lt;head&gt;
    &lt;meta charset=&#34;UTF-8&#34;&gt;
    &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt;
    &lt;title&gt;Responsive Image&lt;/title&gt;
    &lt;style&gt;
        .post-img-view {
            text-align: center;
        }
        .responsive-image {
            display: block;
            margin: 0 auto;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    
    &lt;div class=&#34;post-img-view&#34;&gt;
        &lt;a data-fancybox=&#34;gallery&#34; href=&#34;https://docs.microsoft.com/zh-cn/azure/active-directory/develop/media/quickstart-register-app/portal-02-app-reg-01.png&#34;&gt;
            &lt;img class=&#34;responsive-image&#34; src=&#34;https://docs.microsoft.com/zh-cn/azure/active-directory/develop/media/quickstart-register-app/portal-02-app-reg-01.png&#34; alt=&#34;Azure AD åº”ç”¨æ³¨å†Œå…¥å£&#34;  style=&#34;margin: 0 auto;&#34;/&gt;
        &lt;/a&gt;
    &lt;/div&gt;
    

    &lt;script&gt;
        document.addEventListener(&#34;DOMContentLoaded&#34;, function() {
            var images = document.querySelectorAll(&#34;.responsive-image&#34;);
            var maxHeight = window.innerHeight / 3;
            images.forEach(function(image) {
                image.style.maxHeight = maxHeight + &#34;px&#34;;
            });
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;&lt;/p&gt;
&lt;h3 id=&#34;13-å¡«å†™åº”ç”¨åŸºæœ¬ä¿¡æ¯&#34;&gt;1.3 å¡«å†™åº”ç”¨åŸºæœ¬ä¿¡æ¯&lt;/h3&gt;
&lt;p&gt;åœ¨åº”ç”¨æ³¨å†Œé¡µé¢,éœ€è¦å¡«å†™ä»¥ä¸‹å…³é”®ä¿¡æ¯:&lt;/p&gt;
&lt;h4 id=&#34;åº”ç”¨åç§°&#34;&gt;åº”ç”¨åç§°&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å­—æ®µ&lt;/strong&gt;: åç§° (Name)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤ºä¾‹&lt;/strong&gt;: &lt;code&gt;QuickFillForm Extension&lt;/code&gt; æˆ– &lt;code&gt;æˆ‘çš„æ•°æ®åŒæ­¥åº”ç”¨&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;: è¿™æ˜¯åº”ç”¨çš„æ˜¾ç¤ºåç§°,ç”¨æˆ·æˆæƒæ—¶ä¼šçœ‹åˆ°æ­¤åç§°&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;æ”¯æŒçš„è´¦æˆ·ç±»å‹&#34;&gt;æ”¯æŒçš„è´¦æˆ·ç±»å‹&lt;/h4&gt;
&lt;p&gt;é€‰æ‹©åº”ç”¨çš„ç”¨æˆ·èŒƒå›´,æ¨èé€‰æ‹©:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… &lt;strong&gt;ä»»ä½•ç»„ç»‡ç›®å½•(ä»»ä½• Azure AD ç›®å½• - å¤šç§Ÿæˆ·)ä¸­çš„å¸æˆ·å’Œä¸ªäºº Microsoft å¸æˆ·(ä¾‹å¦‚,Skypeã€Xbox)&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;è‹±æ–‡é€‰é¡¹: &lt;strong&gt;Accounts in any organizational directory (Any Azure AD directory - Multitenant) and personal Microsoft accounts (e.g. Skype, Xbox)&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªé€‰é¡¹?&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ”¯æŒä¸ªäºº Microsoft è´¦å·(æœ€å¹¿æ³›çš„ç”¨æˆ·ç¾¤)&lt;/li&gt;
&lt;li&gt;æ”¯æŒä¼ä¸šå’Œå­¦æ ¡è´¦å·&lt;/li&gt;
&lt;li&gt;ä¸é™åˆ¶ç»„ç»‡,ä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨ä½ çš„åº”ç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å…¶ä»–é€‰é¡¹è¯´æ˜:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä»…æ­¤ç»„ç»‡ç›®å½•&lt;/strong&gt;: ä»…é™ä½ çš„ç»„ç»‡å†…éƒ¨ä½¿ç”¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»»ä½•ç»„ç»‡ç›®å½•&lt;/strong&gt;: ä»…é™ä¼ä¸š/å­¦æ ¡è´¦å·,ä¸æ”¯æŒä¸ªäººè´¦å·&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»…ä¸ªäºº Microsoft è´¦æˆ·&lt;/strong&gt;: ä»…æ”¯æŒä¸ªäººè´¦å·&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;é‡å®šå‘-uri-redirect-uri&#34;&gt;é‡å®šå‘ URI (Redirect URI)&lt;/h4&gt;
&lt;p&gt;è¿™æ˜¯ OAuth è®¤è¯å®Œæˆåçš„å›è°ƒåœ°å€,ä¸åŒåº”ç”¨ç±»å‹é…ç½®ä¸åŒ:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æµè§ˆå™¨æ’ä»¶ (Chrome/Edge):&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¹³å°ç±»å‹: &lt;strong&gt;Web&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;URI æ ¼å¼: &lt;code&gt;https://&amp;lt;YOUR_EXTENSION_ID&amp;gt;.chromiumapp.org/onedrive&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä¸´æ—¶ç¤ºä¾‹: &lt;code&gt;https://abcdefghijklmnopqrstuvwxyz123456.chromiumapp.org/onedrive&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Web åº”ç”¨:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¹³å°ç±»å‹: &lt;strong&gt;Web&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;URI æ ¼å¼: &lt;code&gt;https://yourdomain.com/callback&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æœ¬åœ°å¼€å‘: &lt;code&gt;http://localhost:3000/callback&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;æ¡Œé¢åº”ç”¨:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¹³å°ç±»å‹: &lt;strong&gt;å…¬å…±å®¢æˆ·ç«¯/æœ¬æœº&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;URI æ ¼å¼: &lt;code&gt;https://login.microsoftonline.com/common/oauth2/nativeclient&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;é‡è¦&lt;/strong&gt;: æµè§ˆå™¨æ’ä»¶çš„ Extension ID éœ€è¦åœ¨æ’ä»¶å®‰è£…åæ‰èƒ½è·å–,ç¨åæˆ‘ä»¬ä¼šæ›´æ–°è¿™ä¸ªé…ç½®ã€‚å¯ä»¥å…ˆå¡«å†™ä¸€ä¸ªä¸´æ—¶å€¼,æˆ–è€…ç•™ç©ºåé¢å†æ·»åŠ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;14-å®Œæˆæ³¨å†Œ&#34;&gt;1.4 å®Œæˆæ³¨å†Œ&lt;/h3&gt;
&lt;p&gt;ç¡®è®¤ä¿¡æ¯æ— è¯¯å,ç‚¹å‡»é¡µé¢åº•éƒ¨çš„ &lt;strong&gt;&amp;ldquo;æ³¨å†Œ&amp;rdquo;&lt;/strong&gt; (Register) æŒ‰é’®ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨å†ŒæˆåŠŸå,ä¼šè‡ªåŠ¨è·³è½¬åˆ°åº”ç”¨çš„ &lt;strong&gt;æ¦‚è¿° (Overview)&lt;/strong&gt; é¡µé¢,è¿™é‡Œæ˜¾ç¤ºäº†åº”ç”¨çš„åŸºæœ¬ä¿¡æ¯å’Œé‡è¦ IDã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ç¬¬äºŒæ­¥-é…ç½®-api-æƒé™&#34;&gt;ç¬¬äºŒæ­¥: é…ç½® API æƒé™&lt;/h2&gt;
&lt;p&gt;æ³¨å†Œå®Œåº”ç”¨å,éœ€è¦ä¸ºåº”ç”¨æ·»åŠ è®¿é—® OneDrive çš„æƒé™ã€‚&lt;/p&gt;
&lt;h3 id=&#34;21-è¿›å…¥-api-æƒé™é¡µé¢&#34;&gt;2.1 è¿›å…¥ API æƒé™é¡µé¢&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨åº”ç”¨è¯¦æƒ…é¡µé¢çš„å·¦ä¾§èœå•ä¸­,ç‚¹å‡» &lt;strong&gt;&amp;ldquo;API æƒé™&amp;rdquo;&lt;/strong&gt; (API permissions)&lt;/li&gt;
&lt;li&gt;ä½ ä¼šçœ‹åˆ°é»˜è®¤å·²ç»æ·»åŠ äº† &lt;code&gt;User.Read&lt;/code&gt; æƒé™(è¿™æ˜¯ç”¨äºè¯»å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯çš„æƒé™)&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;22-æ·»åŠ -microsoft-graph-æƒé™&#34;&gt;2.2 æ·»åŠ  Microsoft Graph æƒé™&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ç‚¹å‡»é¡µé¢ä¸­çš„ &lt;strong&gt;&amp;quot;+ æ·»åŠ æƒé™&amp;quot;&lt;/strong&gt; (Add a permission) æŒ‰é’®&lt;/li&gt;
&lt;li&gt;åœ¨å³ä¾§å¼¹å‡ºçš„é¢æ¿ä¸­,ç‚¹å‡» &lt;strong&gt;&amp;ldquo;Microsoft Graph&amp;rdquo;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;é€‰æ‹© &lt;strong&gt;&amp;ldquo;å§”æ‰˜çš„æƒé™&amp;rdquo;&lt;/strong&gt; (Delegated permissions)&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ &lt;strong&gt;æƒé™ç±»å‹è¯´æ˜:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å§”æ‰˜çš„æƒé™ (Delegated permissions)&lt;/strong&gt;: åº”ç”¨ä»£è¡¨å·²ç™»å½•ç”¨æˆ·è®¿é—®æ•°æ®,éœ€è¦ç”¨æˆ·æˆæƒ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”ç”¨ç¨‹åºæƒé™ (Application permissions)&lt;/strong&gt;: åº”ç”¨ä»¥è‡ªå·±çš„èº«ä»½è®¿é—®æ•°æ®,æ— éœ€ç”¨æˆ·ç™»å½•,éœ€è¦ç®¡ç†å‘˜åŒæ„&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;23-é€‰æ‹©æ‰€éœ€æƒé™&#34;&gt;2.3 é€‰æ‹©æ‰€éœ€æƒé™&lt;/h3&gt;
&lt;p&gt;åœ¨æœç´¢æ¡†ä¸­æœç´¢å¹¶å‹¾é€‰ä»¥ä¸‹æƒé™:&lt;/p&gt;
&lt;h4 id=&#34;filesreadwriteappfolder-æ¨è&#34;&gt;Files.ReadWrite.AppFolder (æ¨è)&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æƒé™åç§°&lt;/strong&gt;: &lt;code&gt;Files.ReadWrite.AppFolder&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æƒé™çº§åˆ«&lt;/strong&gt;: å§”æ‰˜çš„æƒé™&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;: å…è®¸åº”ç”¨è¯»å†™åº”ç”¨ä¸“ç”¨æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜åŠ¿&lt;/strong&gt;: æœ€å®‰å…¨çš„æƒé™,åº”ç”¨åªèƒ½è®¿é—®è‡ªå·±åˆ›å»ºçš„ &lt;code&gt;Apps/&amp;lt;AppName&amp;gt;&lt;/code&gt; æ–‡ä»¶å¤¹&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;: å¤§å¤šæ•°åº”ç”¨æ•°æ®åŒæ­¥åœºæ™¯&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç¤ºä¾‹å­˜å‚¨è·¯å¾„:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;OneDrive/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â””â”€â”€ Apps/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    â””â”€â”€ QuickFillForm/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        â”œâ”€â”€ quickfillform-data.json
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        â””â”€â”€ backup/
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;offline_access-å¿…éœ€&#34;&gt;offline_access (å¿…éœ€)&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æƒé™åç§°&lt;/strong&gt;: &lt;code&gt;offline_access&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æƒé™çº§åˆ«&lt;/strong&gt;: å§”æ‰˜çš„æƒé™&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;: å…è®¸åº”ç”¨åœ¨ç”¨æˆ·ç¦»çº¿æ—¶è®¿é—®æ•°æ®&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”¨é€”&lt;/strong&gt;: è·å–åˆ·æ–°ä»¤ç‰Œ(refresh token),åœ¨è®¿é—®ä»¤ç‰Œè¿‡æœŸåè‡ªåŠ¨ç»­æœŸ&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;filesreadwriteall-å¯é€‰ä¸æ¨è&#34;&gt;Files.ReadWrite.All (å¯é€‰,ä¸æ¨è)&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æƒé™åç§°&lt;/strong&gt;: &lt;code&gt;Files.ReadWrite.All&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æƒé™çº§åˆ«&lt;/strong&gt;: å§”æ‰˜çš„æƒé™&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨&lt;/strong&gt;: å…è®¸åº”ç”¨è¯»å†™ç”¨æˆ·çš„æ‰€æœ‰æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é£é™©&lt;/strong&gt;: æƒé™èŒƒå›´è¿‡å¤§,å¯èƒ½å¼•èµ·ç”¨æˆ·æ‹…å¿§&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€‚ç”¨åœºæ™¯&lt;/strong&gt;: éœ€è¦è®¿é—®ç”¨æˆ·æ•´ä¸ª OneDrive çš„åº”ç”¨(å¦‚æ–‡ä»¶ç®¡ç†å™¨)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;24-ç¡®è®¤æ·»åŠ æƒé™&#34;&gt;2.4 ç¡®è®¤æ·»åŠ æƒé™&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å‹¾é€‰å¥½æƒé™å,ç‚¹å‡»åº•éƒ¨çš„ &lt;strong&gt;&amp;ldquo;æ·»åŠ æƒé™&amp;rdquo;&lt;/strong&gt; (Add permissions) æŒ‰é’®&lt;/li&gt;
&lt;li&gt;è¿”å› API æƒé™é¡µé¢,ç¡®è®¤åˆ—è¡¨ä¸­æ˜¾ç¤ºä»¥ä¸‹æƒé™:
&lt;ul&gt;
&lt;li&gt;âœ… &lt;code&gt;User.Read&lt;/code&gt; (é»˜è®¤)&lt;/li&gt;
&lt;li&gt;âœ… &lt;code&gt;Files.ReadWrite.AppFolder&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;âœ… &lt;code&gt;offline_access&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;25-æˆäºˆç®¡ç†å‘˜åŒæ„-å¯é€‰&#34;&gt;2.5 æˆäºˆç®¡ç†å‘˜åŒæ„ (å¯é€‰)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœä½ æ˜¯ç»„ç»‡ç®¡ç†å‘˜,å¯ä»¥ç‚¹å‡» &lt;strong&gt;&amp;ldquo;ä¸º [ç»„ç»‡åç§°] æˆäºˆç®¡ç†å‘˜åŒæ„&amp;rdquo;&lt;/strong&gt; æŒ‰é’®&lt;/li&gt;
&lt;li&gt;å¯¹äºä¸ªäººè´¦å·æˆ–å…¬å…±åº”ç”¨,æ­¤æ­¥éª¤å¯ä»¥è·³è¿‡&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·é¦–æ¬¡ä½¿ç”¨æ—¶ä¼šçœ‹åˆ°æˆæƒé¡µé¢,ç‚¹å‡»&amp;quot;æ¥å—&amp;quot;å³å¯&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ç¬¬ä¸‰æ­¥-è·å–åº”ç”¨å‡­æ®&#34;&gt;ç¬¬ä¸‰æ­¥: è·å–åº”ç”¨å‡­æ®&lt;/h2&gt;
&lt;h3 id=&#34;31-å¤åˆ¶-client-id-åº”ç”¨ç¨‹åº-id&#34;&gt;3.1 å¤åˆ¶ Client ID (åº”ç”¨ç¨‹åº ID)&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨åº”ç”¨è¯¦æƒ…é¡µé¢çš„ &lt;strong&gt;&amp;ldquo;æ¦‚è¿°&amp;rdquo;&lt;/strong&gt; (Overview) é€‰é¡¹å¡ä¸­&lt;/li&gt;
&lt;li&gt;æ‰¾åˆ° &lt;strong&gt;&amp;ldquo;åº”ç”¨ç¨‹åº(å®¢æˆ·ç«¯) ID&amp;rdquo;&lt;/strong&gt; (Application (client) ID)&lt;/li&gt;
&lt;li&gt;è¿™æ˜¯ä¸€ä¸ª GUID æ ¼å¼çš„å­—ç¬¦ä¸²,ç±»ä¼¼:
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;12345678-1234-1234-1234-123456789abc
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;ç‚¹å‡»æ—è¾¹çš„å¤åˆ¶å›¾æ ‡,å°† Client ID ä¿å­˜åˆ°å®‰å…¨çš„åœ°æ–¹&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ”’ &lt;strong&gt;å®‰å…¨æç¤º&lt;/strong&gt;: Client ID æ˜¯å…¬å¼€ä¿¡æ¯,å¯ä»¥åœ¨å‰ç«¯ä»£ç ä¸­ä½¿ç”¨ã€‚ä½†ä¸è¦å°†å®ƒä¸ Client Secret æ··æ·†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;32-æ˜¯å¦éœ€è¦-client-secret&#34;&gt;3.2 æ˜¯å¦éœ€è¦ Client Secret?&lt;/h3&gt;
&lt;p&gt;å¯¹äºä¸åŒç±»å‹çš„åº”ç”¨,Client Secret çš„éœ€æ±‚ä¸åŒ:&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;åº”ç”¨ç±»å‹&lt;/th&gt;
          &lt;th&gt;æ˜¯å¦éœ€è¦ Client Secret&lt;/th&gt;
          &lt;th&gt;åŸå› &lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;æµè§ˆå™¨æ’ä»¶&lt;/td&gt;
          &lt;td&gt;âŒ ä¸éœ€è¦&lt;/td&gt;
          &lt;td&gt;ä½¿ç”¨éšå¼æˆæƒæµç¨‹æˆ– PKCE&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;å•é¡µåº”ç”¨ (SPA)&lt;/td&gt;
          &lt;td&gt;âŒ ä¸éœ€è¦&lt;/td&gt;
          &lt;td&gt;å‰ç«¯ä»£ç æ— æ³•å®‰å…¨å­˜å‚¨å¯†é’¥&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Web åº”ç”¨ (æœ‰åç«¯)&lt;/td&gt;
          &lt;td&gt;âœ… éœ€è¦&lt;/td&gt;
          &lt;td&gt;åœ¨æœåŠ¡å™¨ç«¯å®‰å…¨å­˜å‚¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;æ¡Œé¢/ç§»åŠ¨åº”ç”¨&lt;/td&gt;
          &lt;td&gt;âŒ ä¸éœ€è¦&lt;/td&gt;
          &lt;td&gt;ä½¿ç”¨ PKCE æˆæƒæµç¨‹&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;å¦‚æœéœ€è¦ Client Secret,åˆ›å»ºæ–¹æ³•å¦‚ä¸‹:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨å·¦ä¾§èœå•ä¸­ç‚¹å‡» &lt;strong&gt;&amp;ldquo;è¯ä¹¦å’Œå¯†ç &amp;rdquo;&lt;/strong&gt; (Certificates &amp;amp; secrets)&lt;/li&gt;
&lt;li&gt;ç‚¹å‡» &lt;strong&gt;&amp;quot;+ æ–°å®¢æˆ·ç«¯å¯†ç &amp;quot;&lt;/strong&gt; (New client secret)&lt;/li&gt;
&lt;li&gt;è¾“å…¥æè¿°(å¦‚ &amp;ldquo;ç”Ÿäº§ç¯å¢ƒå¯†é’¥&amp;rdquo;),é€‰æ‹©è¿‡æœŸæ—¶é—´&lt;/li&gt;
&lt;li&gt;ç‚¹å‡» &lt;strong&gt;&amp;ldquo;æ·»åŠ &amp;rdquo;&lt;/strong&gt; (Add)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç«‹å³å¤åˆ¶å¯†é’¥å€¼&lt;/strong&gt;,æ­¤å¯†é’¥åªæ˜¾ç¤ºä¸€æ¬¡&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;è­¦å‘Š&lt;/strong&gt;: Client Secret æ˜¯æ•æ„Ÿä¿¡æ¯,å¿…é¡»å¦¥å–„ä¿ç®¡,ä¸èƒ½æäº¤åˆ°ä»£ç ä»“åº“ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;33-é…ç½®èº«ä»½éªŒè¯è®¾ç½®&#34;&gt;3.3 é…ç½®èº«ä»½éªŒè¯è®¾ç½®&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨å·¦ä¾§èœå•ç‚¹å‡» &lt;strong&gt;&amp;ldquo;èº«ä»½éªŒè¯&amp;rdquo;&lt;/strong&gt; (Authentication)&lt;/li&gt;
&lt;li&gt;ç¡®è®¤ &lt;strong&gt;é‡å®šå‘ URI&lt;/strong&gt; å·²æ­£ç¡®æ·»åŠ &lt;/li&gt;
&lt;li&gt;å‘ä¸‹æ»šåŠ¨åˆ° &lt;strong&gt;&amp;ldquo;éšå¼æˆæƒå’Œæ··åˆæµ&amp;rdquo;&lt;/strong&gt; (Implicit grant and hybrid flows) éƒ¨åˆ†&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;å¯¹äºæµè§ˆå™¨æ’ä»¶æˆ– SPA,éœ€è¦å¯ç”¨:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;âœ… å‹¾é€‰ &lt;strong&gt;&amp;ldquo;è®¿é—®ä»¤ç‰Œ&amp;rdquo;&lt;/strong&gt; (Access tokens)&lt;/li&gt;
&lt;li&gt;âœ… å‹¾é€‰ &lt;strong&gt;&amp;ldquo;ID ä»¤ç‰Œ&amp;rdquo;&lt;/strong&gt; (ID tokens)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å¯¹äºä½¿ç”¨æˆæƒç æµç¨‹çš„åº”ç”¨,å¯ä»¥ä¸å‹¾é€‰ä¸Šè¿°é€‰é¡¹&lt;/strong&gt;&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;ç‚¹å‡»é¡µé¢åº•éƒ¨çš„ &lt;strong&gt;&amp;ldquo;ä¿å­˜&amp;rdquo;&lt;/strong&gt; (Save) æŒ‰é’®&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ç¬¬å››æ­¥-é…ç½®åº”ç”¨ä»£ç &#34;&gt;ç¬¬å››æ­¥: é…ç½®åº”ç”¨ä»£ç &lt;/h2&gt;
&lt;p&gt;ä»¥æµè§ˆå™¨æ’ä»¶ä¸ºä¾‹,è¯´æ˜å¦‚ä½•åœ¨ä»£ç ä¸­é…ç½® OneDrive APIã€‚&lt;/p&gt;
&lt;h3 id=&#34;41-è·å–æµè§ˆå™¨æ’ä»¶çš„-extension-id&#34;&gt;4.1 è·å–æµè§ˆå™¨æ’ä»¶çš„ Extension ID&lt;/h3&gt;
&lt;p&gt;å¦‚æœä½ æ­£åœ¨å¼€å‘æµè§ˆå™¨æ’ä»¶:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ‰“å¼€ Chrome æˆ– Edge æµè§ˆå™¨&lt;/li&gt;
&lt;li&gt;è®¿é—® &lt;code&gt;chrome://extensions/&lt;/code&gt; (Chrome) æˆ– &lt;code&gt;edge://extensions/&lt;/code&gt; (Edge)&lt;/li&gt;
&lt;li&gt;å¼€å¯å³ä¸Šè§’çš„ &lt;strong&gt;&amp;ldquo;å¼€å‘è€…æ¨¡å¼&amp;rdquo;&lt;/strong&gt; (Developer mode)&lt;/li&gt;
&lt;li&gt;ç‚¹å‡» &lt;strong&gt;&amp;ldquo;åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº&amp;rdquo;&lt;/strong&gt; (Load unpacked)&lt;/li&gt;
&lt;li&gt;é€‰æ‹©ä½ çš„æ’ä»¶é¡¹ç›®æ–‡ä»¶å¤¹&lt;/li&gt;
&lt;li&gt;å®‰è£…æˆåŠŸå,åœ¨æ’ä»¶å¡ç‰‡ä¸Šæ‰¾åˆ° &lt;strong&gt;&amp;ldquo;ID&amp;rdquo;&lt;/strong&gt; å­—æ®µ,å¤åˆ¶æ‰©å±• ID
&lt;ul&gt;
&lt;li&gt;ç±»ä¼¼: &lt;code&gt;abcdefghijklmnopqrstuvwxyz123456&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;42-æ›´æ–°-azure-é‡å®šå‘-uri&#34;&gt;4.2 æ›´æ–° Azure é‡å®šå‘ URI&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;è¿”å› Azure Portal çš„åº”ç”¨æ³¨å†Œé¡µé¢&lt;/li&gt;
&lt;li&gt;è¿›å…¥ &lt;strong&gt;&amp;ldquo;èº«ä»½éªŒè¯&amp;rdquo;&lt;/strong&gt; (Authentication)&lt;/li&gt;
&lt;li&gt;æ›´æ–°æˆ–æ·»åŠ é‡å®šå‘ URI:
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;https://abcdefghijklmnopqrstuvwxyz123456.chromiumapp.org/onedrive
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;å°† &lt;code&gt;abcdefghijklmnopqrstuvwxyz123456&lt;/code&gt; æ›¿æ¢ä¸ºå®é™…çš„æ‰©å±• ID&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç‚¹å‡» &lt;strong&gt;&amp;ldquo;ä¿å­˜&amp;rdquo;&lt;/strong&gt; (Save)&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;43-åœ¨ä»£ç ä¸­é…ç½®-client-id&#34;&gt;4.3 åœ¨ä»£ç ä¸­é…ç½® Client ID&lt;/h3&gt;
&lt;p&gt;ä»¥ QuickFillForm æ’ä»¶ä¸ºä¾‹,åœ¨ &lt;code&gt;onedrive-sync.js&lt;/code&gt; æ–‡ä»¶ä¸­é…ç½®:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;OneDriveSync&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;constructor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// æ›¿æ¢ä¸ºä½ çš„ Azure åº”ç”¨ç¨‹åº ID (Client ID)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;clientId&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;12345678-1234-1234-1234-123456789abc&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// è·å–å½“å‰æ’ä»¶çš„ ID
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;redirectUri&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sb&#34;&gt;`https://&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;chrome&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;.chromiumapp.org/onedrive`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// Microsoft Graph API ç«¯ç‚¹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;graphEndpoint&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;https://graph.microsoft.com/v1.0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// åº”ç”¨ä¸“ç”¨æ–‡ä»¶å¤¹è·¯å¾„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;appFolderPath&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/me/drive/special/approot&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// è¯·æ±‚çš„æƒé™èŒƒå›´
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;scopes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s1&#34;&gt;&amp;#39;Files.ReadWrite.AppFolder&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s1&#34;&gt;&amp;#39;offline_access&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// è·å–è®¿é—®ä»¤ç‰Œ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;getAccessToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Promise&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;resolve&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;reject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;chrome&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;identity&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;launchWebAuthFlow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nx&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getAuthUrl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nx&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;redirectUrl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;chrome&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;lastError&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;nx&#34;&gt;reject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;chrome&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;lastError&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;c1&#34;&gt;// ä»å›è°ƒ URL ä¸­æå– access_token
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;URL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;redirectUrl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sr&#34;&gt;/access_token=([^&amp;amp;]*)/&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;nx&#34;&gt;resolve&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;nx&#34;&gt;reject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;æ— æ³•è·å–è®¿é—®ä»¤ç‰Œ&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// æ„å»ºæˆæƒ URL
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;getAuthUrl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;params&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;URLSearchParams&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;client_id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;clientId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;response_type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;redirect_uri&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;redirectUri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;scope&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;scopes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;response_mode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;fragment&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;sb&#34;&gt;`https://login.microsoftonline.com/common/oauth2/v2.0/authorize?&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;params&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// ä¸Šä¼ æ–‡ä»¶åˆ° OneDrive
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;uploadFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fileName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getAccessToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fetch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;graphEndpoint&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}${&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;appFolderPath&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;:/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fileName&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;:/content`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nx&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;PUT&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nx&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;s1&#34;&gt;&amp;#39;Authorization&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;sb&#34;&gt;`Bearer &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;application/json&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;JSON&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stringify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`ä¸Šä¼ å¤±è´¥: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;statusText&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// ä» OneDrive ä¸‹è½½æ–‡ä»¶
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;downloadFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fileName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getAccessToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fetch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;graphEndpoint&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}${&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;appFolderPath&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;:/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fileName&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;:/content`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nx&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;s1&#34;&gt;&amp;#39;Authorization&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;sb&#34;&gt;`Bearer &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`ä¸‹è½½å¤±è´¥: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;statusText&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// ä½¿ç”¨ç¤ºä¾‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;OneDriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// ä¸Šä¼ æ•°æ®
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;uploadFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;data.json&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;value&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;then&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ä¸Šä¼ æˆåŠŸ&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ä¸Šä¼ å¤±è´¥:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// ä¸‹è½½æ•°æ®
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;downloadFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;data.json&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;then&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ä¸‹è½½çš„æ•°æ®:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ä¸‹è½½å¤±è´¥:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;44-web-åº”ç”¨é…ç½®ç¤ºä¾‹&#34;&gt;4.4 Web åº”ç”¨é…ç½®ç¤ºä¾‹&lt;/h3&gt;
&lt;p&gt;å¯¹äºä¼ ç»Ÿ Web åº”ç”¨(æœ‰åç«¯),ä½¿ç”¨æˆæƒç æµç¨‹æ›´å®‰å…¨:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// å‰ç«¯ä»£ç 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;loginWithOneDrive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;clientId&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;YOUR_CLIENT_ID&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;redirectUri&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;https://yourdomain.com/callback&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;scopes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Files.ReadWrite.AppFolder offline_access&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;authUrl&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sb&#34;&gt;`https://login.microsoftonline.com/common/oauth2/v2.0/authorize?`&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;sb&#34;&gt;`client_id=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;clientId&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;sb&#34;&gt;`&amp;amp;response_type=code`&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;sb&#34;&gt;`&amp;amp;redirect_uri=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;encodeURIComponent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;redirectUri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;sb&#34;&gt;`&amp;amp;scope=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;encodeURIComponent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;scopes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;window&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;location&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;href&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;authUrl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// åç«¯ä»£ç  (Node.js Express ç¤ºä¾‹)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/callback&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;req&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;code&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;req&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;query&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// ç”¨æˆæƒç æ¢å–è®¿é—®ä»¤ç‰Œ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;tokenResponse&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fetch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;https://login.microsoftonline.com/common/oauth2/v2.0/token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;application/x-www-form-urlencoded&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;URLSearchParams&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;client_id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;CLIENT_ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;client_secret&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;CLIENT_SECRET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;code&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;redirect_uri&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;https://yourdomain.com/callback&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;grant_type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;authorization_code&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;tokenData&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;tokenResponse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// ä¿å­˜ access_token å’Œ refresh_token
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;req&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;accessToken&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;tokenData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;access_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;req&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;session&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;refreshToken&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;tokenData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;refresh_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;redirect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/dashboard&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;45-é…ç½®-manifestjson-æµè§ˆå™¨æ’ä»¶&#34;&gt;4.5 é…ç½® manifest.json (æµè§ˆå™¨æ’ä»¶)&lt;/h3&gt;
&lt;p&gt;åœ¨æ’ä»¶çš„ &lt;code&gt;manifest.json&lt;/code&gt; ä¸­æ·»åŠ å¿…è¦çš„æƒé™:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;manifest_version&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;QuickFillForm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;version&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;1.0.0&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;permissions&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;identity&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;storage&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;host_permissions&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;https://login.microsoftonline.com/*&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;https://graph.microsoft.com/*&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;oauth2&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nt&#34;&gt;&amp;#34;client_id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;12345678-1234-1234-1234-123456789abc.chromiumapp.org&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nt&#34;&gt;&amp;#34;scopes&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s2&#34;&gt;&amp;#34;Files.ReadWrite.AppFolder&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s2&#34;&gt;&amp;#34;offline_access&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h2 id=&#34;ç¬¬äº”æ­¥-æµ‹è¯•åŒæ­¥åŠŸèƒ½&#34;&gt;ç¬¬äº”æ­¥: æµ‹è¯•åŒæ­¥åŠŸèƒ½&lt;/h2&gt;
&lt;h3 id=&#34;51-æµ‹è¯•ç”¨æˆ·è®¤è¯&#34;&gt;5.1 æµ‹è¯•ç”¨æˆ·è®¤è¯&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨åº”ç”¨ä¸­è§¦å‘ OneDrive ç™»å½•æµç¨‹&lt;/li&gt;
&lt;li&gt;æµè§ˆå™¨ä¼šæ‰“å¼€ Microsoft ç™»å½•é¡µé¢&lt;/li&gt;
&lt;li&gt;è¾“å…¥ Microsoft è´¦å·å’Œå¯†ç ç™»å½•&lt;/li&gt;
&lt;li&gt;é¦–æ¬¡ä½¿ç”¨ä¼šçœ‹åˆ°æƒé™è¯·æ±‚é¡µé¢:
&lt;ul&gt;
&lt;li&gt;æ˜¾ç¤ºåº”ç”¨åç§°&lt;/li&gt;
&lt;li&gt;åˆ—å‡ºè¯·æ±‚çš„æƒé™&lt;/li&gt;
&lt;li&gt;æ˜¾ç¤ºåº”ç”¨å‘å¸ƒè€…ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç‚¹å‡» &lt;strong&gt;&amp;ldquo;æ¥å—&amp;rdquo;&lt;/strong&gt; (Accept) æŒ‰é’®æˆæƒ&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;52-æµ‹è¯•æ–‡ä»¶ä¸Šä¼ &#34;&gt;5.2 æµ‹è¯•æ–‡ä»¶ä¸Šä¼ &lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æµè§ˆå™¨æ’ä»¶ç¤ºä¾‹:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// æµ‹è¯•ä¸Šä¼ åŠŸèƒ½
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;testUpload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;testData&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;å¼ ä¸‰&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;email&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;zhangsan@example.com&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;phone&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;13800138000&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;uploadFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;test-data.json&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;testData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;âœ… ä¸Šä¼ æˆåŠŸ:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;âŒ ä¸Šä¼ å¤±è´¥:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;testUpload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;53-æµ‹è¯•æ–‡ä»¶ä¸‹è½½&#34;&gt;5.3 æµ‹è¯•æ–‡ä»¶ä¸‹è½½&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// æµ‹è¯•ä¸‹è½½åŠŸèƒ½
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;testDownload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;downloadFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;test-data.json&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;âœ… ä¸‹è½½æˆåŠŸ:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;âŒ ä¸‹è½½å¤±è´¥:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;testDownload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;54-éªŒè¯æ–‡ä»¶å­˜å‚¨ä½ç½®&#34;&gt;5.4 éªŒè¯æ–‡ä»¶å­˜å‚¨ä½ç½®&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ç™»å½• &lt;a href=&#34;https://onedrive.live.com/&#34;&gt;OneDrive ç½‘é¡µç‰ˆ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;åœ¨å·¦ä¾§èœå•ä¸­æ‰¾åˆ° &lt;strong&gt;&amp;ldquo;åº”ç”¨&amp;rdquo;&lt;/strong&gt; (Apps) æ–‡ä»¶å¤¹&lt;/li&gt;
&lt;li&gt;è¿›å…¥ä½ çš„åº”ç”¨æ–‡ä»¶å¤¹,ä¾‹å¦‚ &lt;code&gt;Apps/QuickFillForm/&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ç¡®è®¤æ–‡ä»¶å·²æˆåŠŸä¸Šä¼ &lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;55-æµ‹è¯•è·¨è®¾å¤‡åŒæ­¥&#34;&gt;5.5 æµ‹è¯•è·¨è®¾å¤‡åŒæ­¥&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨è®¾å¤‡ A ä¸Šä¼ æ•°æ®&lt;/li&gt;
&lt;li&gt;åœ¨è®¾å¤‡ B ä¸Šç™»å½•åŒä¸€ Microsoft è´¦å·&lt;/li&gt;
&lt;li&gt;ä¸‹è½½æ•°æ®,éªŒè¯æ˜¯å¦ä¸è®¾å¤‡ A ä¸€è‡´&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹æ•°æ®åå†æ¬¡ä¸Šä¼ &lt;/li&gt;
&lt;li&gt;åœ¨è®¾å¤‡ A ä¸Šä¸‹è½½,éªŒè¯æ˜¯å¦æ›´æ–°&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 id=&#34;å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ&#34;&gt;å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ&lt;/h2&gt;
&lt;h3 id=&#34;q1-æ— æ³•è·å–è®¿é—®ä»¤ç‰Œ&#34;&gt;Q1: æ— æ³•è·å–è®¿é—®ä»¤ç‰Œ&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;é”™è¯¯ä¿¡æ¯:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;AADSTS50011: The redirect URI specified in the request does not match
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;åŸå› åˆ†æ:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Client ID é…ç½®é”™è¯¯&lt;/li&gt;
&lt;li&gt;é‡å®šå‘ URI ä¸åŒ¹é…&lt;/li&gt;
&lt;li&gt;Extension ID æ›´æ”¹åæœªæ›´æ–° Azure é…ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æ£€æŸ¥ä»£ç ä¸­çš„ &lt;code&gt;clientId&lt;/code&gt; æ˜¯å¦æ­£ç¡®å¤åˆ¶&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// é”™è¯¯: å¤šä½™çš„ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;clientId&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;12345678-1234-1234-1234-123456789abc &amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// æ­£ç¡®
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;clientId&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;12345678-1234-1234-1234-123456789abc&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¡®è®¤ Azure åº”ç”¨æ³¨å†Œä¸­çš„é‡å®šå‘ URI ä¸ä»£ç å®Œå…¨ä¸€è‡´&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Azure é…ç½®: &lt;code&gt;https://abcdefg123456.chromiumapp.org/onedrive&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä»£ç é…ç½®: &lt;code&gt;https://abcdefg123456.chromiumapp.org/onedrive&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æ³¨æ„åŒºåˆ†å¤§å°å†™å’Œå°¾éƒ¨æ–œæ &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¿å­˜é…ç½®åç­‰å¾… 2-5 åˆ†é’Ÿè®©é…ç½®ç”Ÿæ•ˆ&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;q2-æƒé™è¢«æ‹’ç»æ— æ³•è¯»å†™æ–‡ä»¶&#34;&gt;Q2: æƒé™è¢«æ‹’ç»,æ— æ³•è¯»å†™æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;é”™è¯¯ä¿¡æ¯:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;403 Forbidden: Access denied
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;åŸå› åˆ†æ:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æƒé™æœªæ­£ç¡®æ·»åŠ &lt;/li&gt;
&lt;li&gt;ç”¨æˆ·æœªæˆæƒ&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨äº†é”™è¯¯çš„ API ç«¯ç‚¹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨ Azure Portal æ£€æŸ¥æ˜¯å¦å·²æ·»åŠ  &lt;code&gt;Files.ReadWrite.AppFolder&lt;/code&gt; æƒé™&lt;/li&gt;
&lt;li&gt;æ¸…é™¤ç”¨æˆ·æˆæƒ,é‡æ–°ç™»å½•å¹¶åŒæ„æƒé™
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// æ¸…é™¤ç¼“å­˜çš„ä»¤ç‰Œ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;chrome&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;identity&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;clearAllCachedAuthTokens&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;å·²æ¸…é™¤ç¼“å­˜,è¯·é‡æ–°ç™»å½•&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;ç¡®è®¤ä½¿ç”¨æ­£ç¡®çš„ API è·¯å¾„:
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// æ­£ç¡®: ä½¿ç”¨åº”ç”¨ä¸“ç”¨æ–‡ä»¶å¤¹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/me/drive/special/approot:/data.json:/content&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// é”™è¯¯: ä½¿ç”¨æ ¹ç›®å½• (éœ€è¦ Files.ReadWrite.All æƒé™)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/me/drive/root:/data.json:/content&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;q3-è®¿é—®ä»¤ç‰Œè¿‡æœŸ&#34;&gt;Q3: è®¿é—®ä»¤ç‰Œè¿‡æœŸ&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;é”™è¯¯ä¿¡æ¯:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;401 Unauthorized: The access token has expired
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;åŸå› åˆ†æ:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Access Token é»˜è®¤æœ‰æ•ˆæœŸ 1 å°æ—¶&lt;/li&gt;
&lt;li&gt;æœªå®ç° Refresh Token è‡ªåŠ¨åˆ·æ–°æœºåˆ¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å®ç°ä»¤ç‰Œåˆ·æ–°é€»è¾‘:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;OneDriveSync&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;constructor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;accessToken&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;refreshToken&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tokenExpiry&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// è·å–æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;getValidAccessToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// å¦‚æœä»¤ç‰Œæœªè¿‡æœŸ,ç›´æ¥è¿”å›
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;accessToken&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tokenExpiry&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;now&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;accessToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// å¦‚æœæœ‰åˆ·æ–°ä»¤ç‰Œ,å°è¯•åˆ·æ–°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;refreshToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;refreshAccessToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// å¦åˆ™é‡æ–°ç™»å½•
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getAccessToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// åˆ·æ–°è®¿é—®ä»¤ç‰Œ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;refreshAccessToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fetch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;https://login.microsoftonline.com/common/oauth2/v2.0/token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;application/x-www-form-urlencoded&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;URLSearchParams&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nx&#34;&gt;client_id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;clientId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nx&#34;&gt;refresh_token&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;refreshToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nx&#34;&gt;grant_type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;refresh_token&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;accessToken&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;access_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;refreshToken&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;refresh_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tokenExpiry&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;now&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;expires_in&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;chrome&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;storage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;onedrive_access_token&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;accessToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;onedrive_refresh_token&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;refreshToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;onedrive_token_expiry&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tokenExpiry&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;accessToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;q4-æ‰¾ä¸åˆ°æ‰©å±•-id&#34;&gt;Q4: æ‰¾ä¸åˆ°æ‰©å±• ID&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è®¿é—®æµè§ˆå™¨çš„æ‰©å±•ç®¡ç†é¡µé¢:
&lt;ul&gt;
&lt;li&gt;Chrome: &lt;code&gt;chrome://extensions/&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Edge: &lt;code&gt;edge://extensions/&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¡®ä¿å·²å¼€å¯&amp;quot;å¼€å‘è€…æ¨¡å¼&amp;quot;&lt;/li&gt;
&lt;li&gt;Extension ID æ˜¾ç¤ºåœ¨æ‰©å±•å¡ç‰‡ä¸Š,æ ¼å¼ç±»ä¼¼:
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ID: abcdefghijklmnopqrstuvwxyz123456
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;å¦‚æœæ˜¯å·²å‘å¸ƒçš„æ‰©å±•,å¯ä»¥åœ¨ Chrome Web Store çš„ URL ä¸­æ‰¾åˆ°:
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;https://chrome.google.com/webstore/detail/extension-name/abcdefghijklmnopqrstuvwxyz123456
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;q5-æ–‡ä»¶ä¸Šä¼ æˆåŠŸä½†åœ¨-onedrive-ä¸­æ‰¾ä¸åˆ°&#34;&gt;Q5: æ–‡ä»¶ä¸Šä¼ æˆåŠŸä½†åœ¨ OneDrive ä¸­æ‰¾ä¸åˆ°&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;åŸå› åˆ†æ:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨äº†åº”ç”¨ä¸“ç”¨æ–‡ä»¶å¤¹,è·¯å¾„åœ¨ &lt;code&gt;Apps/&amp;lt;AppName&amp;gt;/&lt;/code&gt; ä¸‹&lt;/li&gt;
&lt;li&gt;OneDrive ç½‘é¡µç‰ˆç•Œé¢å¯èƒ½æœ‰å»¶è¿Ÿ&lt;/li&gt;
&lt;li&gt;æ–‡ä»¶åæˆ–è·¯å¾„é”™è¯¯&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨ OneDrive ç½‘é¡µç‰ˆä¸­,å¯¼èˆªåˆ°:
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;OneDrive â†’ åº”ç”¨ (Apps) â†’ QuickFillForm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;ç­‰å¾… 1-2 åˆ†é’Ÿ,åˆ·æ–°é¡µé¢&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ API æŸ¥è¯¢æ–‡ä»¶æ˜¯å¦å­˜åœ¨:
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// åˆ—å‡ºåº”ç”¨æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;listFiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getValidAccessToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fetch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;https://graph.microsoft.com/v1.0/me/drive/special/approot/children&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Authorization&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;sb&#34;&gt;`Bearer &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;æ–‡ä»¶åˆ—è¡¨:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;q6-è·¨åŸŸè¯·æ±‚è¢«é˜»æ­¢-cors&#34;&gt;Q6: è·¨åŸŸè¯·æ±‚è¢«é˜»æ­¢ (CORS)&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;é”™è¯¯ä¿¡æ¯:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Access to fetch at &amp;#39;https://graph.microsoft.com/...&amp;#39; has been blocked by CORS policy
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;åŸå› åˆ†æ:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨æ™®é€šç½‘é¡µä¸­ç›´æ¥è¯·æ±‚ Graph API&lt;/li&gt;
&lt;li&gt;æœªåœ¨ &lt;code&gt;manifest.json&lt;/code&gt; ä¸­é…ç½® &lt;code&gt;host_permissions&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ–¹æ¡ˆä¸€: ä½¿ç”¨åç«¯ä»£ç† (æ¨è)&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// å‰ç«¯è°ƒç”¨åç«¯ API
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;fetch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/api/onedrive/upload&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;JSON&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stringify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// åç«¯è½¬å‘åˆ° Microsoft Graph
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/api/onedrive/upload&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;req&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fetch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;https://graph.microsoft.com/v1.0/...&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Authorization&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;sb&#34;&gt;`Bearer &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;accessToken&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;æ–¹æ¡ˆäºŒ: æµè§ˆå™¨æ’ä»¶é…ç½®&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;host_permissions&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;https://login.microsoftonline.com/*&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;https://graph.microsoft.com/*&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;q7-æˆæƒé¡µé¢æ˜¾ç¤ºéœ€è¦ç®¡ç†å‘˜å®¡æ‰¹&#34;&gt;Q7: æˆæƒé¡µé¢æ˜¾ç¤º&amp;quot;éœ€è¦ç®¡ç†å‘˜å®¡æ‰¹&amp;quot;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;é”™è¯¯ä¿¡æ¯:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;AADSTS65001: The user or administrator has not consented to use the application
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;åŸå› åˆ†æ:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»„ç»‡ç­–ç•¥è¦æ±‚ç®¡ç†å‘˜æ‰¹å‡†åº”ç”¨&lt;/li&gt;
&lt;li&gt;è¯·æ±‚çš„æƒé™éœ€è¦ç®¡ç†å‘˜åŒæ„&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¦‚æœä½ æ˜¯ç®¡ç†å‘˜,åœ¨ Azure Portal ä¸­æˆäºˆç®¡ç†å‘˜åŒæ„&lt;/li&gt;
&lt;li&gt;å¦‚æœä¸æ˜¯ç®¡ç†å‘˜,è”ç³» IT éƒ¨é—¨æ‰¹å‡†åº”ç”¨&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ä¸ªäºº Microsoft è´¦å·æµ‹è¯•(ä¸ªäººè´¦å·æ— éœ€ç®¡ç†å‘˜åŒæ„)&lt;/li&gt;
&lt;li&gt;å‡å°‘æƒé™è¯·æ±‚,åªä½¿ç”¨å§”æ‰˜æƒé™è€Œä¸æ˜¯åº”ç”¨æƒé™&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 id=&#34;å®‰å…¨æœ€ä½³å®è·µ&#34;&gt;å®‰å…¨æœ€ä½³å®è·µ&lt;/h2&gt;
&lt;h3 id=&#34;1-ä¿æŠ¤-client-secret&#34;&gt;1. ä¿æŠ¤ Client Secret&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// âŒ é”™è¯¯: åœ¨å‰ç«¯ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;clientSecret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;your-secret-key-123456&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// âœ… æ­£ç¡®: åœ¨åç«¯ä½¿ç”¨ç¯å¢ƒå˜é‡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;clientSecret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;AZURE_CLIENT_SECRET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;2-ä½¿ç”¨æœ€å°æƒé™åŸåˆ™&#34;&gt;2. ä½¿ç”¨æœ€å°æƒé™åŸåˆ™&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// âŒ é”™è¯¯: è¯·æ±‚è¿‡å¤šæƒé™
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;scopes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;Files.ReadWrite.All&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;Mail.Read&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;Contacts.ReadWrite&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// âœ… æ­£ç¡®: åªè¯·æ±‚å¿…éœ€çš„æƒé™
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;scopes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;Files.ReadWrite.AppFolder&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;offline_access&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;3-å®‰å…¨å­˜å‚¨ä»¤ç‰Œ&#34;&gt;3. å®‰å…¨å­˜å‚¨ä»¤ç‰Œ&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// âœ… æµè§ˆå™¨æ’ä»¶: ä½¿ç”¨ chrome.storage.local
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;chrome&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;storage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;onedrive_token&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;encryptedToken&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// æœ€å¥½åŠ å¯†å­˜å‚¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// âœ… Web åº”ç”¨: ä½¿ç”¨ HttpOnly Cookie
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cookie&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;access_token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;httpOnly&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;secure&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;sameSite&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;strict&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;4-å®šæœŸæ£€æŸ¥åº”ç”¨æ´»åŠ¨&#34;&gt;4. å®šæœŸæ£€æŸ¥åº”ç”¨æ´»åŠ¨&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ç™»å½• &lt;a href=&#34;https://portal.azure.com/&#34;&gt;Azure Portal&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;è¿›å…¥åº”ç”¨æ³¨å†Œ â†’ ä½ çš„åº”ç”¨&lt;/li&gt;
&lt;li&gt;æŸ¥çœ‹ &lt;strong&gt;&amp;ldquo;æ¦‚è¿°&amp;rdquo;&lt;/strong&gt; ä¸­çš„ä½¿ç”¨æƒ…å†µç»Ÿè®¡&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥å¼‚å¸¸ç™»å½•å’Œ API è°ƒç”¨&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;5-å¤„ç†æ•æ„Ÿæ•°æ®&#34;&gt;5. å¤„ç†æ•æ„Ÿæ•°æ®&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// ä¸Šä¼ å‰åŠ å¯†æ•æ„Ÿæ•°æ®
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;uploadSecureData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;encrypted&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;encryptData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;uploadFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;secure-data.enc&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;encrypted&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// ä¸‹è½½åè§£å¯†
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;downloadSecureData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;encrypted&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;downloadFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;secure-data.enc&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;decryptData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;encrypted&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h2 id=&#34;è¿›é˜¶æŠ€å·§&#34;&gt;è¿›é˜¶æŠ€å·§&lt;/h2&gt;
&lt;h3 id=&#34;1-å®ç°æ–‡ä»¶ç‰ˆæœ¬ç®¡ç†&#34;&gt;1. å®ç°æ–‡ä»¶ç‰ˆæœ¬ç®¡ç†&lt;/h3&gt;
&lt;p&gt;OneDrive è‡ªåŠ¨ä¿ç•™æ–‡ä»¶ç‰ˆæœ¬å†å²,å¯ä»¥é€šè¿‡ API è®¿é—®:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;getFileVersions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fileName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getValidAccessToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fetch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;sb&#34;&gt;`https://graph.microsoft.com/v1.0/me/drive/special/approot:/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fileName&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;:/versions`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Authorization&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;sb&#34;&gt;`Bearer &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// è¿”å›ç‰ˆæœ¬åˆ—è¡¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;2-å®ç°å¢é‡åŒæ­¥&#34;&gt;2. å®ç°å¢é‡åŒæ­¥&lt;/h3&gt;
&lt;p&gt;é€šè¿‡ Delta API è·å–æ–‡ä»¶å˜åŒ–:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syncChanges&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;deltaLink&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getValidAccessToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;deltaLink&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s1&#34;&gt;&amp;#39;https://graph.microsoft.com/v1.0/me/drive/special/approot/delta&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fetch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Authorization&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;sb&#34;&gt;`Bearer &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// å¤„ç†å˜åŒ–çš„æ–‡ä»¶
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;item&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;of&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;deleted&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;æ–‡ä»¶å·²åˆ é™¤:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;æ–‡ä»¶å·²æ›´æ–°:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// ä¿å­˜ deltaLink ä¾›ä¸‹æ¬¡ä½¿ç”¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;@odata.deltaLink&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;3-å®ç°å†²çªè§£å†³&#34;&gt;3. å®ç°å†²çªè§£å†³&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;smartSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fileName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;localData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;try&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// ä¸‹è½½è¿œç¨‹æ–‡ä»¶
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;remoteData&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;downloadFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fileName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// æ¯”è¾ƒæ—¶é—´æˆ³
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;remoteData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;lastModified&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;localData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;lastModified&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;// è¿œç¨‹æ›´æ–°,ä¸‹è½½è¦†ç›–æœ¬åœ°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;download&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;remoteData&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;localData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;lastModified&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;remoteData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;lastModified&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;// æœ¬åœ°æ›´æ–°,ä¸Šä¼ è¦†ç›–è¿œç¨‹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;uploadFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fileName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;localData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;upload&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;localData&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;// æ™ºèƒ½åˆå¹¶
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;merged&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mergeData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;localData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;remoteData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;uploadFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fileName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;merged&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;merge&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;merged&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// æ–‡ä»¶ä¸å­˜åœ¨,ç›´æ¥ä¸Šä¼ 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;status&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;404&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;uploadFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fileName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;localData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;create&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;localData&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;4-æ‰¹é‡æ“ä½œ&#34;&gt;4. æ‰¹é‡æ“ä½œ&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨æ‰¹å¤„ç† API æé«˜æ€§èƒ½:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;batchUpload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;onedriveSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getValidAccessToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;requests&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;toString&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;PUT&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;sb&#34;&gt;`/me/drive/special/approot:/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;:/content`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;application/json&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;content&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fetch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;https://graph.microsoft.com/v1.0/$batch&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s1&#34;&gt;&amp;#39;Authorization&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;sb&#34;&gt;`Bearer &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;token&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;application/json&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;JSON&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stringify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;requests&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h2 id=&#34;ç›¸å…³èµ„æº&#34;&gt;ç›¸å…³èµ„æº&lt;/h2&gt;
&lt;h3 id=&#34;å®˜æ–¹æ–‡æ¡£&#34;&gt;å®˜æ–¹æ–‡æ¡£&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ğŸ“˜ &lt;a href=&#34;https://docs.microsoft.com/zh-cn/graph/overview&#34;&gt;Microsoft Graph API æ–‡æ¡£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ğŸ“˜ &lt;a href=&#34;https://docs.microsoft.com/zh-cn/onedrive/developer/&#34;&gt;OneDrive API å‚è€ƒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ğŸ“˜ &lt;a href=&#34;https://docs.microsoft.com/zh-cn/azure/active-directory/develop/quickstart-register-app&#34;&gt;Azure AD åº”ç”¨æ³¨å†ŒæŒ‡å—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ğŸ“˜ &lt;a href=&#34;https://docs.microsoft.com/zh-cn/azure/active-directory/develop/v2-oauth2-auth-code-flow&#34;&gt;OAuth 2.0 æˆæƒæµç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å¼€å‘å·¥å…·&#34;&gt;å¼€å‘å·¥å…·&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ğŸ› ï¸ &lt;a href=&#34;https://developer.microsoft.com/zh-cn/graph/graph-explorer&#34;&gt;Graph Explorer&lt;/a&gt; - åœ¨çº¿æµ‹è¯• API&lt;/li&gt;
&lt;li&gt;ğŸ› ï¸ &lt;a href=&#34;https://github.com/microsoftgraph&#34;&gt;Microsoft Graph SDK&lt;/a&gt; - å„è¯­è¨€ SDK&lt;/li&gt;
&lt;li&gt;ğŸ› ï¸ &lt;a href=&#34;https://www.postman.com/microsoftgraph/workspace/microsoft-graph/overview&#34;&gt;Postman Collection&lt;/a&gt; - API è°ƒè¯•&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç¤ºä¾‹é¡¹ç›®&#34;&gt;ç¤ºä¾‹é¡¹ç›®&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ğŸ’» &lt;a href=&#34;https://github.com/OneDrive/onedrive-api-docs/blob/live/samples/javascript-picker-saver.md&#34;&gt;OneDrive JavaScript SDK&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ğŸ’» &lt;a href=&#34;https://github.com/GoogleChrome/chrome-extensions-samples/tree/main/api-samples/identity&#34;&gt;æµè§ˆå™¨æ’ä»¶ OAuth ç¤ºä¾‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç¤¾åŒºèµ„æº&#34;&gt;ç¤¾åŒºèµ„æº&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ğŸ’¬ &lt;a href=&#34;https://techcommunity.microsoft.com/t5/microsoft-graph/ct-p/MicrosoftGraph&#34;&gt;Microsoft Graph å¼€å‘è€…è®ºå›&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ğŸ’¬ &lt;a href=&#34;https://stackoverflow.com/questions/tagged/microsoft-graph&#34;&gt;Stack Overflow - microsoft-graph&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
      <content:encoded><![CDATA[<p>åœ¨å¼€å‘åº”ç”¨æ—¶,æˆ‘ä»¬ç»å¸¸éœ€è¦å®ç°æ•°æ®åŒæ­¥åŠŸèƒ½ã€‚ä¾‹å¦‚æˆ‘ä¹‹å‰å¼€å‘çš„è¡¨å•å¡«å†™å·¥å…·(QuickFillForm),å¦‚æœä¸ä¿å­˜åˆ°ç½‘ç›˜,æ¢ä¸ªæµè§ˆå™¨æ•°æ®å°±ä¸¢å¤±äº†;ä½†å¦‚æœæ¥å…¥ OneDrive åŒæ­¥,ç”¨æˆ·å°±èƒ½åœ¨å„ä¸ªè®¾å¤‡ä¸Šæ— ç¼ä½¿ç”¨ã€‚æœ¬æ–‡å°†ä»¥è¿™ä¸ªå®é™…æ¡ˆä¾‹ä¸ºä¾‹,è¯¦ç»†è¯´æ˜å¦‚ä½•ç”³è¯·å’Œé…ç½® OneDrive API,å¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®ç°ç½‘ç›˜åŒæ­¥åŠŸèƒ½ã€‚</p>
<h2 id="åº”ç”¨åœºæ™¯">åº”ç”¨åœºæ™¯</h2>
<p>OneDrive API é€‚ç”¨äºä»¥ä¸‹å¼€å‘åœºæ™¯:</p>
<ul>
<li><strong>è·¨è®¾å¤‡æ•°æ®åŒæ­¥</strong>: æµè§ˆå™¨æ’ä»¶ã€æ¡Œé¢åº”ç”¨çš„é…ç½®å’Œæ•°æ®åŒæ­¥</li>
<li><strong>æ–‡ä»¶å¤‡ä»½ä¸æ¢å¤</strong>: è‡ªåŠ¨å¤‡ä»½ç”¨æˆ·æ•°æ®åˆ°äº‘ç«¯,æ”¯æŒä¸€é”®æ¢å¤</li>
<li><strong>åä½œä¸åˆ†äº«</strong>: å®ç°æ–‡ä»¶å…±äº«ã€å¤šäººåä½œç¼–è¾‘åŠŸèƒ½</li>
<li><strong>ç¦»çº¿è®¿é—®</strong>: æ”¯æŒç¦»çº¿è¯»å–æ•°æ®,åœ¨çº¿è‡ªåŠ¨åŒæ­¥</li>
</ul>
<h2 id="å‰ç½®å‡†å¤‡">å‰ç½®å‡†å¤‡</h2>
<p>åœ¨å¼€å§‹ä¹‹å‰,ä½ éœ€è¦å‡†å¤‡:</p>
<ul>
<li>âœ… Microsoft è´¦å·(ä¸ªäººè´¦å·æˆ–å·¥ä½œ/å­¦æ ¡è´¦å·å‡å¯)</li>
<li>âœ… å¼€å‘ç¯å¢ƒ(æœ¬æ–‡ä»¥æµè§ˆå™¨æ’ä»¶ä¸ºä¾‹)</li>
<li>âœ… åŸºç¡€çš„ JavaScript/API è°ƒç”¨çŸ¥è¯†</li>
</ul>
<blockquote>
<p>ğŸ’¡ <strong>æç¤º</strong>: OneDrive API æä¾›äº†å…è´¹çš„å¼€å‘è€…é…é¢,ä¸ªäººåº”ç”¨å®Œå…¨å¤Ÿç”¨ã€‚</p>
</blockquote>
<hr>
<h2 id="ç¬¬ä¸€æ­¥-æ³¨å†Œ-azure-åº”ç”¨">ç¬¬ä¸€æ­¥: æ³¨å†Œ Azure åº”ç”¨</h2>
<h3 id="11-è®¿é—®-azure-portal">1.1 è®¿é—® Azure Portal</h3>
<ol>
<li>æ‰“å¼€æµè§ˆå™¨,è®¿é—® <a href="https://portal.azure.com/">Azure Portal</a></li>
<li>ä½¿ç”¨ä½ çš„ Microsoft è´¦å·ç™»å½•
<ul>
<li>ä¸ªäººè´¦å·(å¦‚ Outlookã€Hotmail é‚®ç®±)</li>
<li>å·¥ä½œæˆ–å­¦æ ¡è´¦å·(å¦‚å…¬å¸/å­¦æ ¡æä¾›çš„ Office 365 è´¦å·)</li>
</ul>
</li>
<li>å¦‚æœæ²¡æœ‰ Azure è´¦å·,å¯ä»¥å…è´¹æ³¨å†Œ</li>
</ol>
<blockquote>
<p>ğŸ“Œ <strong>æ³¨æ„</strong>: å³ä½¿æ²¡æœ‰ Azure è®¢é˜…,ä¹Ÿå¯ä»¥æ³¨å†Œåº”ç”¨ã€‚å…è´¹è´¦å·è¶³å¤Ÿç”¨äºå¼€å‘æµ‹è¯•ã€‚</p>
</blockquote>
<h3 id="12-è¿›å…¥åº”ç”¨æ³¨å†Œé¡µé¢">1.2 è¿›å…¥åº”ç”¨æ³¨å†Œé¡µé¢</h3>
<ol>
<li>åœ¨ Azure Portal é¦–é¡µçš„æœç´¢æ ä¸­è¾“å…¥ <strong>&ldquo;Azure Active Directory&rdquo;</strong> æˆ– <strong>&ldquo;Microsoft Entra ID&rdquo;</strong></li>
<li>ç‚¹å‡»æœç´¢ç»“æœä¸­çš„ <strong>Azure Active Directory</strong> æœåŠ¡</li>
<li>åœ¨å·¦ä¾§èœå•ä¸­æ‰¾åˆ° <strong>&ldquo;åº”ç”¨æ³¨å†Œ&rdquo;</strong> (App registrations)</li>
<li>ç‚¹å‡»é¡¶éƒ¨çš„ <strong>&quot;+ æ–°æ³¨å†Œ&quot;</strong> (New registration) æŒ‰é’®</li>
</ol>
<p>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Responsive Image</title>
    <style>
        .post-img-view {
            text-align: center;
        }
        .responsive-image {
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    
    <div class="post-img-view">
        <a data-fancybox="gallery" href="https://docs.microsoft.com/zh-cn/azure/active-directory/develop/media/quickstart-register-app/portal-02-app-reg-01.png">
            <img class="responsive-image" src="https://docs.microsoft.com/zh-cn/azure/active-directory/develop/media/quickstart-register-app/portal-02-app-reg-01.png" alt="Azure AD åº”ç”¨æ³¨å†Œå…¥å£"  style="margin: 0 auto;"/>
        </a>
    </div>
    

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            var images = document.querySelectorAll(".responsive-image");
            var maxHeight = window.innerHeight / 3;
            images.forEach(function(image) {
                image.style.maxHeight = maxHeight + "px";
            });
        });
    </script>
</body>
</html></p>
<h3 id="13-å¡«å†™åº”ç”¨åŸºæœ¬ä¿¡æ¯">1.3 å¡«å†™åº”ç”¨åŸºæœ¬ä¿¡æ¯</h3>
<p>åœ¨åº”ç”¨æ³¨å†Œé¡µé¢,éœ€è¦å¡«å†™ä»¥ä¸‹å…³é”®ä¿¡æ¯:</p>
<h4 id="åº”ç”¨åç§°">åº”ç”¨åç§°</h4>
<ul>
<li><strong>å­—æ®µ</strong>: åç§° (Name)</li>
<li><strong>ç¤ºä¾‹</strong>: <code>QuickFillForm Extension</code> æˆ– <code>æˆ‘çš„æ•°æ®åŒæ­¥åº”ç”¨</code></li>
<li><strong>è¯´æ˜</strong>: è¿™æ˜¯åº”ç”¨çš„æ˜¾ç¤ºåç§°,ç”¨æˆ·æˆæƒæ—¶ä¼šçœ‹åˆ°æ­¤åç§°</li>
</ul>
<h4 id="æ”¯æŒçš„è´¦æˆ·ç±»å‹">æ”¯æŒçš„è´¦æˆ·ç±»å‹</h4>
<p>é€‰æ‹©åº”ç”¨çš„ç”¨æˆ·èŒƒå›´,æ¨èé€‰æ‹©:</p>
<ul>
<li>âœ… <strong>ä»»ä½•ç»„ç»‡ç›®å½•(ä»»ä½• Azure AD ç›®å½• - å¤šç§Ÿæˆ·)ä¸­çš„å¸æˆ·å’Œä¸ªäºº Microsoft å¸æˆ·(ä¾‹å¦‚,Skypeã€Xbox)</strong></li>
<li>è‹±æ–‡é€‰é¡¹: <strong>Accounts in any organizational directory (Any Azure AD directory - Multitenant) and personal Microsoft accounts (e.g. Skype, Xbox)</strong></li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªé€‰é¡¹?</strong></p>
<ul>
<li>æ”¯æŒä¸ªäºº Microsoft è´¦å·(æœ€å¹¿æ³›çš„ç”¨æˆ·ç¾¤)</li>
<li>æ”¯æŒä¼ä¸šå’Œå­¦æ ¡è´¦å·</li>
<li>ä¸é™åˆ¶ç»„ç»‡,ä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨ä½ çš„åº”ç”¨</li>
</ul>
<p><strong>å…¶ä»–é€‰é¡¹è¯´æ˜:</strong></p>
<ul>
<li><strong>ä»…æ­¤ç»„ç»‡ç›®å½•</strong>: ä»…é™ä½ çš„ç»„ç»‡å†…éƒ¨ä½¿ç”¨</li>
<li><strong>ä»»ä½•ç»„ç»‡ç›®å½•</strong>: ä»…é™ä¼ä¸š/å­¦æ ¡è´¦å·,ä¸æ”¯æŒä¸ªäººè´¦å·</li>
<li><strong>ä»…ä¸ªäºº Microsoft è´¦æˆ·</strong>: ä»…æ”¯æŒä¸ªäººè´¦å·</li>
</ul>
<h4 id="é‡å®šå‘-uri-redirect-uri">é‡å®šå‘ URI (Redirect URI)</h4>
<p>è¿™æ˜¯ OAuth è®¤è¯å®Œæˆåçš„å›è°ƒåœ°å€,ä¸åŒåº”ç”¨ç±»å‹é…ç½®ä¸åŒ:</p>
<p><strong>æµè§ˆå™¨æ’ä»¶ (Chrome/Edge):</strong></p>
<ul>
<li>å¹³å°ç±»å‹: <strong>Web</strong></li>
<li>URI æ ¼å¼: <code>https://&lt;YOUR_EXTENSION_ID&gt;.chromiumapp.org/onedrive</code></li>
<li>ä¸´æ—¶ç¤ºä¾‹: <code>https://abcdefghijklmnopqrstuvwxyz123456.chromiumapp.org/onedrive</code></li>
</ul>
<p><strong>Web åº”ç”¨:</strong></p>
<ul>
<li>å¹³å°ç±»å‹: <strong>Web</strong></li>
<li>URI æ ¼å¼: <code>https://yourdomain.com/callback</code></li>
<li>æœ¬åœ°å¼€å‘: <code>http://localhost:3000/callback</code></li>
</ul>
<p><strong>æ¡Œé¢åº”ç”¨:</strong></p>
<ul>
<li>å¹³å°ç±»å‹: <strong>å…¬å…±å®¢æˆ·ç«¯/æœ¬æœº</strong></li>
<li>URI æ ¼å¼: <code>https://login.microsoftonline.com/common/oauth2/nativeclient</code></li>
</ul>
<blockquote>
<p>âš ï¸ <strong>é‡è¦</strong>: æµè§ˆå™¨æ’ä»¶çš„ Extension ID éœ€è¦åœ¨æ’ä»¶å®‰è£…åæ‰èƒ½è·å–,ç¨åæˆ‘ä»¬ä¼šæ›´æ–°è¿™ä¸ªé…ç½®ã€‚å¯ä»¥å…ˆå¡«å†™ä¸€ä¸ªä¸´æ—¶å€¼,æˆ–è€…ç•™ç©ºåé¢å†æ·»åŠ ã€‚</p>
</blockquote>
<h3 id="14-å®Œæˆæ³¨å†Œ">1.4 å®Œæˆæ³¨å†Œ</h3>
<p>ç¡®è®¤ä¿¡æ¯æ— è¯¯å,ç‚¹å‡»é¡µé¢åº•éƒ¨çš„ <strong>&ldquo;æ³¨å†Œ&rdquo;</strong> (Register) æŒ‰é’®ã€‚</p>
<p>æ³¨å†ŒæˆåŠŸå,ä¼šè‡ªåŠ¨è·³è½¬åˆ°åº”ç”¨çš„ <strong>æ¦‚è¿° (Overview)</strong> é¡µé¢,è¿™é‡Œæ˜¾ç¤ºäº†åº”ç”¨çš„åŸºæœ¬ä¿¡æ¯å’Œé‡è¦ IDã€‚</p>
<hr>
<h2 id="ç¬¬äºŒæ­¥-é…ç½®-api-æƒé™">ç¬¬äºŒæ­¥: é…ç½® API æƒé™</h2>
<p>æ³¨å†Œå®Œåº”ç”¨å,éœ€è¦ä¸ºåº”ç”¨æ·»åŠ è®¿é—® OneDrive çš„æƒé™ã€‚</p>
<h3 id="21-è¿›å…¥-api-æƒé™é¡µé¢">2.1 è¿›å…¥ API æƒé™é¡µé¢</h3>
<ol>
<li>åœ¨åº”ç”¨è¯¦æƒ…é¡µé¢çš„å·¦ä¾§èœå•ä¸­,ç‚¹å‡» <strong>&ldquo;API æƒé™&rdquo;</strong> (API permissions)</li>
<li>ä½ ä¼šçœ‹åˆ°é»˜è®¤å·²ç»æ·»åŠ äº† <code>User.Read</code> æƒé™(è¿™æ˜¯ç”¨äºè¯»å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯çš„æƒé™)</li>
</ol>
<h3 id="22-æ·»åŠ -microsoft-graph-æƒé™">2.2 æ·»åŠ  Microsoft Graph æƒé™</h3>
<ol>
<li>ç‚¹å‡»é¡µé¢ä¸­çš„ <strong>&quot;+ æ·»åŠ æƒé™&quot;</strong> (Add a permission) æŒ‰é’®</li>
<li>åœ¨å³ä¾§å¼¹å‡ºçš„é¢æ¿ä¸­,ç‚¹å‡» <strong>&ldquo;Microsoft Graph&rdquo;</strong></li>
<li>é€‰æ‹© <strong>&ldquo;å§”æ‰˜çš„æƒé™&rdquo;</strong> (Delegated permissions)</li>
</ol>
<blockquote>
<p>ğŸ’¡ <strong>æƒé™ç±»å‹è¯´æ˜:</strong></p>
<ul>
<li><strong>å§”æ‰˜çš„æƒé™ (Delegated permissions)</strong>: åº”ç”¨ä»£è¡¨å·²ç™»å½•ç”¨æˆ·è®¿é—®æ•°æ®,éœ€è¦ç”¨æˆ·æˆæƒ</li>
<li><strong>åº”ç”¨ç¨‹åºæƒé™ (Application permissions)</strong>: åº”ç”¨ä»¥è‡ªå·±çš„èº«ä»½è®¿é—®æ•°æ®,æ— éœ€ç”¨æˆ·ç™»å½•,éœ€è¦ç®¡ç†å‘˜åŒæ„</li>
</ul>
</blockquote>
<h3 id="23-é€‰æ‹©æ‰€éœ€æƒé™">2.3 é€‰æ‹©æ‰€éœ€æƒé™</h3>
<p>åœ¨æœç´¢æ¡†ä¸­æœç´¢å¹¶å‹¾é€‰ä»¥ä¸‹æƒé™:</p>
<h4 id="filesreadwriteappfolder-æ¨è">Files.ReadWrite.AppFolder (æ¨è)</h4>
<ul>
<li><strong>æƒé™åç§°</strong>: <code>Files.ReadWrite.AppFolder</code></li>
<li><strong>æƒé™çº§åˆ«</strong>: å§”æ‰˜çš„æƒé™</li>
<li><strong>ä½œç”¨</strong>: å…è®¸åº”ç”¨è¯»å†™åº”ç”¨ä¸“ç”¨æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶</li>
<li><strong>ä¼˜åŠ¿</strong>: æœ€å®‰å…¨çš„æƒé™,åº”ç”¨åªèƒ½è®¿é—®è‡ªå·±åˆ›å»ºçš„ <code>Apps/&lt;AppName&gt;</code> æ–‡ä»¶å¤¹</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: å¤§å¤šæ•°åº”ç”¨æ•°æ®åŒæ­¥åœºæ™¯</li>
</ul>
<p><strong>ç¤ºä¾‹å­˜å‚¨è·¯å¾„:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">OneDrive/
</span></span><span class="line"><span class="cl">â””â”€â”€ Apps/
</span></span><span class="line"><span class="cl">    â””â”€â”€ QuickFillForm/
</span></span><span class="line"><span class="cl">        â”œâ”€â”€ quickfillform-data.json
</span></span><span class="line"><span class="cl">        â””â”€â”€ backup/
</span></span></code></pre></div><h4 id="offline_access-å¿…éœ€">offline_access (å¿…éœ€)</h4>
<ul>
<li><strong>æƒé™åç§°</strong>: <code>offline_access</code></li>
<li><strong>æƒé™çº§åˆ«</strong>: å§”æ‰˜çš„æƒé™</li>
<li><strong>ä½œç”¨</strong>: å…è®¸åº”ç”¨åœ¨ç”¨æˆ·ç¦»çº¿æ—¶è®¿é—®æ•°æ®</li>
<li><strong>ç”¨é€”</strong>: è·å–åˆ·æ–°ä»¤ç‰Œ(refresh token),åœ¨è®¿é—®ä»¤ç‰Œè¿‡æœŸåè‡ªåŠ¨ç»­æœŸ</li>
</ul>
<h4 id="filesreadwriteall-å¯é€‰ä¸æ¨è">Files.ReadWrite.All (å¯é€‰,ä¸æ¨è)</h4>
<ul>
<li><strong>æƒé™åç§°</strong>: <code>Files.ReadWrite.All</code></li>
<li><strong>æƒé™çº§åˆ«</strong>: å§”æ‰˜çš„æƒé™</li>
<li><strong>ä½œç”¨</strong>: å…è®¸åº”ç”¨è¯»å†™ç”¨æˆ·çš„æ‰€æœ‰æ–‡ä»¶</li>
<li><strong>é£é™©</strong>: æƒé™èŒƒå›´è¿‡å¤§,å¯èƒ½å¼•èµ·ç”¨æˆ·æ‹…å¿§</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>: éœ€è¦è®¿é—®ç”¨æˆ·æ•´ä¸ª OneDrive çš„åº”ç”¨(å¦‚æ–‡ä»¶ç®¡ç†å™¨)</li>
</ul>
<h3 id="24-ç¡®è®¤æ·»åŠ æƒé™">2.4 ç¡®è®¤æ·»åŠ æƒé™</h3>
<ol>
<li>å‹¾é€‰å¥½æƒé™å,ç‚¹å‡»åº•éƒ¨çš„ <strong>&ldquo;æ·»åŠ æƒé™&rdquo;</strong> (Add permissions) æŒ‰é’®</li>
<li>è¿”å› API æƒé™é¡µé¢,ç¡®è®¤åˆ—è¡¨ä¸­æ˜¾ç¤ºä»¥ä¸‹æƒé™:
<ul>
<li>âœ… <code>User.Read</code> (é»˜è®¤)</li>
<li>âœ… <code>Files.ReadWrite.AppFolder</code></li>
<li>âœ… <code>offline_access</code></li>
</ul>
</li>
</ol>
<h3 id="25-æˆäºˆç®¡ç†å‘˜åŒæ„-å¯é€‰">2.5 æˆäºˆç®¡ç†å‘˜åŒæ„ (å¯é€‰)</h3>
<ul>
<li>å¦‚æœä½ æ˜¯ç»„ç»‡ç®¡ç†å‘˜,å¯ä»¥ç‚¹å‡» <strong>&ldquo;ä¸º [ç»„ç»‡åç§°] æˆäºˆç®¡ç†å‘˜åŒæ„&rdquo;</strong> æŒ‰é’®</li>
<li>å¯¹äºä¸ªäººè´¦å·æˆ–å…¬å…±åº”ç”¨,æ­¤æ­¥éª¤å¯ä»¥è·³è¿‡</li>
<li>ç”¨æˆ·é¦–æ¬¡ä½¿ç”¨æ—¶ä¼šçœ‹åˆ°æˆæƒé¡µé¢,ç‚¹å‡»&quot;æ¥å—&quot;å³å¯</li>
</ul>
<hr>
<h2 id="ç¬¬ä¸‰æ­¥-è·å–åº”ç”¨å‡­æ®">ç¬¬ä¸‰æ­¥: è·å–åº”ç”¨å‡­æ®</h2>
<h3 id="31-å¤åˆ¶-client-id-åº”ç”¨ç¨‹åº-id">3.1 å¤åˆ¶ Client ID (åº”ç”¨ç¨‹åº ID)</h3>
<ol>
<li>åœ¨åº”ç”¨è¯¦æƒ…é¡µé¢çš„ <strong>&ldquo;æ¦‚è¿°&rdquo;</strong> (Overview) é€‰é¡¹å¡ä¸­</li>
<li>æ‰¾åˆ° <strong>&ldquo;åº”ç”¨ç¨‹åº(å®¢æˆ·ç«¯) ID&rdquo;</strong> (Application (client) ID)</li>
<li>è¿™æ˜¯ä¸€ä¸ª GUID æ ¼å¼çš„å­—ç¬¦ä¸²,ç±»ä¼¼:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">12345678-1234-1234-1234-123456789abc
</span></span></code></pre></div></li>
<li>ç‚¹å‡»æ—è¾¹çš„å¤åˆ¶å›¾æ ‡,å°† Client ID ä¿å­˜åˆ°å®‰å…¨çš„åœ°æ–¹</li>
</ol>
<blockquote>
<p>ğŸ”’ <strong>å®‰å…¨æç¤º</strong>: Client ID æ˜¯å…¬å¼€ä¿¡æ¯,å¯ä»¥åœ¨å‰ç«¯ä»£ç ä¸­ä½¿ç”¨ã€‚ä½†ä¸è¦å°†å®ƒä¸ Client Secret æ··æ·†ã€‚</p>
</blockquote>
<h3 id="32-æ˜¯å¦éœ€è¦-client-secret">3.2 æ˜¯å¦éœ€è¦ Client Secret?</h3>
<p>å¯¹äºä¸åŒç±»å‹çš„åº”ç”¨,Client Secret çš„éœ€æ±‚ä¸åŒ:</p>
<table>
  <thead>
      <tr>
          <th>åº”ç”¨ç±»å‹</th>
          <th>æ˜¯å¦éœ€è¦ Client Secret</th>
          <th>åŸå› </th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>æµè§ˆå™¨æ’ä»¶</td>
          <td>âŒ ä¸éœ€è¦</td>
          <td>ä½¿ç”¨éšå¼æˆæƒæµç¨‹æˆ– PKCE</td>
      </tr>
      <tr>
          <td>å•é¡µåº”ç”¨ (SPA)</td>
          <td>âŒ ä¸éœ€è¦</td>
          <td>å‰ç«¯ä»£ç æ— æ³•å®‰å…¨å­˜å‚¨å¯†é’¥</td>
      </tr>
      <tr>
          <td>Web åº”ç”¨ (æœ‰åç«¯)</td>
          <td>âœ… éœ€è¦</td>
          <td>åœ¨æœåŠ¡å™¨ç«¯å®‰å…¨å­˜å‚¨</td>
      </tr>
      <tr>
          <td>æ¡Œé¢/ç§»åŠ¨åº”ç”¨</td>
          <td>âŒ ä¸éœ€è¦</td>
          <td>ä½¿ç”¨ PKCE æˆæƒæµç¨‹</td>
      </tr>
  </tbody>
</table>
<p><strong>å¦‚æœéœ€è¦ Client Secret,åˆ›å»ºæ–¹æ³•å¦‚ä¸‹:</strong></p>
<ol>
<li>åœ¨å·¦ä¾§èœå•ä¸­ç‚¹å‡» <strong>&ldquo;è¯ä¹¦å’Œå¯†ç &rdquo;</strong> (Certificates &amp; secrets)</li>
<li>ç‚¹å‡» <strong>&quot;+ æ–°å®¢æˆ·ç«¯å¯†ç &quot;</strong> (New client secret)</li>
<li>è¾“å…¥æè¿°(å¦‚ &ldquo;ç”Ÿäº§ç¯å¢ƒå¯†é’¥&rdquo;),é€‰æ‹©è¿‡æœŸæ—¶é—´</li>
<li>ç‚¹å‡» <strong>&ldquo;æ·»åŠ &rdquo;</strong> (Add)</li>
<li><strong>ç«‹å³å¤åˆ¶å¯†é’¥å€¼</strong>,æ­¤å¯†é’¥åªæ˜¾ç¤ºä¸€æ¬¡</li>
</ol>
<blockquote>
<p>âš ï¸ <strong>è­¦å‘Š</strong>: Client Secret æ˜¯æ•æ„Ÿä¿¡æ¯,å¿…é¡»å¦¥å–„ä¿ç®¡,ä¸èƒ½æäº¤åˆ°ä»£ç ä»“åº“ã€‚</p>
</blockquote>
<h3 id="33-é…ç½®èº«ä»½éªŒè¯è®¾ç½®">3.3 é…ç½®èº«ä»½éªŒè¯è®¾ç½®</h3>
<ol>
<li>åœ¨å·¦ä¾§èœå•ç‚¹å‡» <strong>&ldquo;èº«ä»½éªŒè¯&rdquo;</strong> (Authentication)</li>
<li>ç¡®è®¤ <strong>é‡å®šå‘ URI</strong> å·²æ­£ç¡®æ·»åŠ </li>
<li>å‘ä¸‹æ»šåŠ¨åˆ° <strong>&ldquo;éšå¼æˆæƒå’Œæ··åˆæµ&rdquo;</strong> (Implicit grant and hybrid flows) éƒ¨åˆ†</li>
</ol>
<p><strong>å¯¹äºæµè§ˆå™¨æ’ä»¶æˆ– SPA,éœ€è¦å¯ç”¨:</strong></p>
<ul>
<li>âœ… å‹¾é€‰ <strong>&ldquo;è®¿é—®ä»¤ç‰Œ&rdquo;</strong> (Access tokens)</li>
<li>âœ… å‹¾é€‰ <strong>&ldquo;ID ä»¤ç‰Œ&rdquo;</strong> (ID tokens)</li>
</ul>
<p><strong>å¯¹äºä½¿ç”¨æˆæƒç æµç¨‹çš„åº”ç”¨,å¯ä»¥ä¸å‹¾é€‰ä¸Šè¿°é€‰é¡¹</strong></p>
<ol start="4">
<li>ç‚¹å‡»é¡µé¢åº•éƒ¨çš„ <strong>&ldquo;ä¿å­˜&rdquo;</strong> (Save) æŒ‰é’®</li>
</ol>
<hr>
<h2 id="ç¬¬å››æ­¥-é…ç½®åº”ç”¨ä»£ç ">ç¬¬å››æ­¥: é…ç½®åº”ç”¨ä»£ç </h2>
<p>ä»¥æµè§ˆå™¨æ’ä»¶ä¸ºä¾‹,è¯´æ˜å¦‚ä½•åœ¨ä»£ç ä¸­é…ç½® OneDrive APIã€‚</p>
<h3 id="41-è·å–æµè§ˆå™¨æ’ä»¶çš„-extension-id">4.1 è·å–æµè§ˆå™¨æ’ä»¶çš„ Extension ID</h3>
<p>å¦‚æœä½ æ­£åœ¨å¼€å‘æµè§ˆå™¨æ’ä»¶:</p>
<ol>
<li>æ‰“å¼€ Chrome æˆ– Edge æµè§ˆå™¨</li>
<li>è®¿é—® <code>chrome://extensions/</code> (Chrome) æˆ– <code>edge://extensions/</code> (Edge)</li>
<li>å¼€å¯å³ä¸Šè§’çš„ <strong>&ldquo;å¼€å‘è€…æ¨¡å¼&rdquo;</strong> (Developer mode)</li>
<li>ç‚¹å‡» <strong>&ldquo;åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº&rdquo;</strong> (Load unpacked)</li>
<li>é€‰æ‹©ä½ çš„æ’ä»¶é¡¹ç›®æ–‡ä»¶å¤¹</li>
<li>å®‰è£…æˆåŠŸå,åœ¨æ’ä»¶å¡ç‰‡ä¸Šæ‰¾åˆ° <strong>&ldquo;ID&rdquo;</strong> å­—æ®µ,å¤åˆ¶æ‰©å±• ID
<ul>
<li>ç±»ä¼¼: <code>abcdefghijklmnopqrstuvwxyz123456</code></li>
</ul>
</li>
</ol>
<h3 id="42-æ›´æ–°-azure-é‡å®šå‘-uri">4.2 æ›´æ–° Azure é‡å®šå‘ URI</h3>
<ol>
<li>è¿”å› Azure Portal çš„åº”ç”¨æ³¨å†Œé¡µé¢</li>
<li>è¿›å…¥ <strong>&ldquo;èº«ä»½éªŒè¯&rdquo;</strong> (Authentication)</li>
<li>æ›´æ–°æˆ–æ·»åŠ é‡å®šå‘ URI:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">https://abcdefghijklmnopqrstuvwxyz123456.chromiumapp.org/onedrive
</span></span></code></pre></div><ul>
<li>å°† <code>abcdefghijklmnopqrstuvwxyz123456</code> æ›¿æ¢ä¸ºå®é™…çš„æ‰©å±• ID</li>
</ul>
</li>
<li>ç‚¹å‡» <strong>&ldquo;ä¿å­˜&rdquo;</strong> (Save)</li>
</ol>
<h3 id="43-åœ¨ä»£ç ä¸­é…ç½®-client-id">4.3 åœ¨ä»£ç ä¸­é…ç½® Client ID</h3>
<p>ä»¥ QuickFillForm æ’ä»¶ä¸ºä¾‹,åœ¨ <code>onedrive-sync.js</code> æ–‡ä»¶ä¸­é…ç½®:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">OneDriveSync</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// æ›¿æ¢ä¸ºä½ çš„ Azure åº”ç”¨ç¨‹åº ID (Client ID)
</span></span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">clientId</span> <span class="o">=</span> <span class="s1">&#39;12345678-1234-1234-1234-123456789abc&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// è·å–å½“å‰æ’ä»¶çš„ ID
</span></span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">redirectUri</span> <span class="o">=</span> <span class="sb">`https://</span><span class="si">${</span><span class="nx">chrome</span><span class="p">.</span><span class="nx">runtime</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">.chromiumapp.org/onedrive`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// Microsoft Graph API ç«¯ç‚¹
</span></span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">graphEndpoint</span> <span class="o">=</span> <span class="s1">&#39;https://graph.microsoft.com/v1.0&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// åº”ç”¨ä¸“ç”¨æ–‡ä»¶å¤¹è·¯å¾„
</span></span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">appFolderPath</span> <span class="o">=</span> <span class="s1">&#39;/me/drive/special/approot&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// è¯·æ±‚çš„æƒé™èŒƒå›´
</span></span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">scopes</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;Files.ReadWrite.AppFolder&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;offline_access&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// è·å–è®¿é—®ä»¤ç‰Œ
</span></span></span><span class="line"><span class="cl">    <span class="kr">async</span> <span class="nx">getAccessToken</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">chrome</span><span class="p">.</span><span class="nx">identity</span><span class="p">.</span><span class="nx">launchWebAuthFlow</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">                <span class="nx">url</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getAuthUrl</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">                <span class="nx">interactive</span><span class="o">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span> <span class="p">(</span><span class="nx">redirectUrl</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="nx">chrome</span><span class="p">.</span><span class="nx">runtime</span><span class="p">.</span><span class="nx">lastError</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">reject</span><span class="p">(</span><span class="nx">chrome</span><span class="p">.</span><span class="nx">runtime</span><span class="p">.</span><span class="nx">lastError</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="c1">// ä»å›è°ƒ URL ä¸­æå– access_token
</span></span></span><span class="line"><span class="cl">                <span class="kr">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">URL</span><span class="p">(</span><span class="nx">redirectUrl</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/access_token=([^&amp;]*)/</span><span class="p">)</span><span class="o">?</span><span class="p">.[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">resolve</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">reject</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;æ— æ³•è·å–è®¿é—®ä»¤ç‰Œ&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">});</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// æ„å»ºæˆæƒ URL
</span></span></span><span class="line"><span class="cl">    <span class="nx">getAuthUrl</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">URLSearchParams</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="nx">client_id</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">clientId</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">response_type</span><span class="o">:</span> <span class="s1">&#39;token&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">redirect_uri</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">redirectUri</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">scope</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">scopes</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="nx">response_mode</span><span class="o">:</span> <span class="s1">&#39;fragment&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="sb">`https://login.microsoftonline.com/common/oauth2/v2.0/authorize?</span><span class="si">${</span><span class="nx">params</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// ä¸Šä¼ æ–‡ä»¶åˆ° OneDrive
</span></span></span><span class="line"><span class="cl">    <span class="kr">async</span> <span class="nx">uploadFile</span><span class="p">(</span><span class="nx">fileName</span><span class="p">,</span> <span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="kr">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">getAccessToken</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="sb">`</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">graphEndpoint</span><span class="si">}${</span><span class="k">this</span><span class="p">.</span><span class="nx">appFolderPath</span><span class="si">}</span><span class="sb">:/</span><span class="si">${</span><span class="nx">fileName</span><span class="si">}</span><span class="sb">:/content`</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;Authorization&#39;</span><span class="o">:</span> <span class="sb">`Bearer </span><span class="si">${</span><span class="nx">token</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="nx">body</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="sb">`ä¸Šä¼ å¤±è´¥: </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kr">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// ä» OneDrive ä¸‹è½½æ–‡ä»¶
</span></span></span><span class="line"><span class="cl">    <span class="kr">async</span> <span class="nx">downloadFile</span><span class="p">(</span><span class="nx">fileName</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="kr">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">getAccessToken</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="sb">`</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">graphEndpoint</span><span class="si">}${</span><span class="k">this</span><span class="p">.</span><span class="nx">appFolderPath</span><span class="si">}</span><span class="sb">:/</span><span class="si">${</span><span class="nx">fileName</span><span class="si">}</span><span class="sb">:/content`</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;Authorization&#39;</span><span class="o">:</span> <span class="sb">`Bearer </span><span class="si">${</span><span class="nx">token</span><span class="si">}</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="sb">`ä¸‹è½½å¤±è´¥: </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kr">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ä½¿ç”¨ç¤ºä¾‹
</span></span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">onedriveSync</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OneDriveSync</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ä¸Šä¼ æ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="nx">onedriveSync</span><span class="p">.</span><span class="nx">uploadFile</span><span class="p">(</span><span class="s1">&#39;data.json&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">key</span><span class="o">:</span> <span class="s1">&#39;value&#39;</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;ä¸Šä¼ æˆåŠŸ&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;ä¸Šä¼ å¤±è´¥:&#39;</span><span class="p">,</span> <span class="nx">err</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ä¸‹è½½æ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="nx">onedriveSync</span><span class="p">.</span><span class="nx">downloadFile</span><span class="p">(</span><span class="s1">&#39;data.json&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;ä¸‹è½½çš„æ•°æ®:&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;ä¸‹è½½å¤±è´¥:&#39;</span><span class="p">,</span> <span class="nx">err</span><span class="p">));</span>
</span></span></code></pre></div><h3 id="44-web-åº”ç”¨é…ç½®ç¤ºä¾‹">4.4 Web åº”ç”¨é…ç½®ç¤ºä¾‹</h3>
<p>å¯¹äºä¼ ç»Ÿ Web åº”ç”¨(æœ‰åç«¯),ä½¿ç”¨æˆæƒç æµç¨‹æ›´å®‰å…¨:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// å‰ç«¯ä»£ç 
</span></span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">loginWithOneDrive</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">clientId</span> <span class="o">=</span> <span class="s1">&#39;YOUR_CLIENT_ID&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">redirectUri</span> <span class="o">=</span> <span class="s1">&#39;https://yourdomain.com/callback&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">scopes</span> <span class="o">=</span> <span class="s1">&#39;Files.ReadWrite.AppFolder offline_access&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">authUrl</span> <span class="o">=</span> <span class="sb">`https://login.microsoftonline.com/common/oauth2/v2.0/authorize?`</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">        <span class="sb">`client_id=</span><span class="si">${</span><span class="nx">clientId</span><span class="si">}</span><span class="sb">`</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">        <span class="sb">`&amp;response_type=code`</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">        <span class="sb">`&amp;redirect_uri=</span><span class="si">${</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">redirectUri</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">        <span class="sb">`&amp;scope=</span><span class="si">${</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">scopes</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">authUrl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// åç«¯ä»£ç  (Node.js Express ç¤ºä¾‹)
</span></span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/callback&#39;</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">code</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">code</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// ç”¨æˆæƒç æ¢å–è®¿é—®ä»¤ç‰Œ
</span></span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">tokenResponse</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;https://login.microsoftonline.com/common/oauth2/v2.0/token&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">body</span><span class="o">:</span> <span class="k">new</span> <span class="nx">URLSearchParams</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="nx">client_id</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CLIENT_ID</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">client_secret</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">CLIENT_SECRET</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">code</span><span class="o">:</span> <span class="nx">code</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">redirect_uri</span><span class="o">:</span> <span class="s1">&#39;https://yourdomain.com/callback&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">grant_type</span><span class="o">:</span> <span class="s1">&#39;authorization_code&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">tokenData</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">tokenResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// ä¿å­˜ access_token å’Œ refresh_token
</span></span></span><span class="line"><span class="cl">    <span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">accessToken</span> <span class="o">=</span> <span class="nx">tokenData</span><span class="p">.</span><span class="nx">access_token</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">refreshToken</span> <span class="o">=</span> <span class="nx">tokenData</span><span class="p">.</span><span class="nx">refresh_token</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">&#39;/dashboard&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><h3 id="45-é…ç½®-manifestjson-æµè§ˆå™¨æ’ä»¶">4.5 é…ç½® manifest.json (æµè§ˆå™¨æ’ä»¶)</h3>
<p>åœ¨æ’ä»¶çš„ <code>manifest.json</code> ä¸­æ·»åŠ å¿…è¦çš„æƒé™:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;manifest_version&#34;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;QuickFillForm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;version&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;permissions&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;identity&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;storage&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;host_permissions&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;https://login.microsoftonline.com/*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;https://graph.microsoft.com/*&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;oauth2&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;client_id&#34;</span><span class="p">:</span> <span class="s2">&#34;12345678-1234-1234-1234-123456789abc.chromiumapp.org&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;scopes&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Files.ReadWrite.AppFolder&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;offline_access&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<h2 id="ç¬¬äº”æ­¥-æµ‹è¯•åŒæ­¥åŠŸèƒ½">ç¬¬äº”æ­¥: æµ‹è¯•åŒæ­¥åŠŸèƒ½</h2>
<h3 id="51-æµ‹è¯•ç”¨æˆ·è®¤è¯">5.1 æµ‹è¯•ç”¨æˆ·è®¤è¯</h3>
<ol>
<li>åœ¨åº”ç”¨ä¸­è§¦å‘ OneDrive ç™»å½•æµç¨‹</li>
<li>æµè§ˆå™¨ä¼šæ‰“å¼€ Microsoft ç™»å½•é¡µé¢</li>
<li>è¾“å…¥ Microsoft è´¦å·å’Œå¯†ç ç™»å½•</li>
<li>é¦–æ¬¡ä½¿ç”¨ä¼šçœ‹åˆ°æƒé™è¯·æ±‚é¡µé¢:
<ul>
<li>æ˜¾ç¤ºåº”ç”¨åç§°</li>
<li>åˆ—å‡ºè¯·æ±‚çš„æƒé™</li>
<li>æ˜¾ç¤ºåº”ç”¨å‘å¸ƒè€…ä¿¡æ¯</li>
</ul>
</li>
<li>ç‚¹å‡» <strong>&ldquo;æ¥å—&rdquo;</strong> (Accept) æŒ‰é’®æˆæƒ</li>
</ol>
<h3 id="52-æµ‹è¯•æ–‡ä»¶ä¸Šä¼ ">5.2 æµ‹è¯•æ–‡ä»¶ä¸Šä¼ </h3>
<p><strong>æµè§ˆå™¨æ’ä»¶ç¤ºä¾‹:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// æµ‹è¯•ä¸Šä¼ åŠŸèƒ½
</span></span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">testUpload</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">testData</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;å¼ ä¸‰&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">email</span><span class="o">:</span> <span class="s1">&#39;zhangsan@example.com&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">phone</span><span class="o">:</span> <span class="s1">&#39;13800138000&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">onedriveSync</span><span class="p">.</span><span class="nx">uploadFile</span><span class="p">(</span><span class="s1">&#39;test-data.json&#39;</span><span class="p">,</span> <span class="nx">testData</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;âœ… ä¸Šä¼ æˆåŠŸ:&#39;</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;âŒ ä¸Šä¼ å¤±è´¥:&#39;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">testUpload</span><span class="p">();</span>
</span></span></code></pre></div><h3 id="53-æµ‹è¯•æ–‡ä»¶ä¸‹è½½">5.3 æµ‹è¯•æ–‡ä»¶ä¸‹è½½</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// æµ‹è¯•ä¸‹è½½åŠŸèƒ½
</span></span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">testDownload</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">onedriveSync</span><span class="p">.</span><span class="nx">downloadFile</span><span class="p">(</span><span class="s1">&#39;test-data.json&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;âœ… ä¸‹è½½æˆåŠŸ:&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;âŒ ä¸‹è½½å¤±è´¥:&#39;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">testDownload</span><span class="p">();</span>
</span></span></code></pre></div><h3 id="54-éªŒè¯æ–‡ä»¶å­˜å‚¨ä½ç½®">5.4 éªŒè¯æ–‡ä»¶å­˜å‚¨ä½ç½®</h3>
<ol>
<li>ç™»å½• <a href="https://onedrive.live.com/">OneDrive ç½‘é¡µç‰ˆ</a></li>
<li>åœ¨å·¦ä¾§èœå•ä¸­æ‰¾åˆ° <strong>&ldquo;åº”ç”¨&rdquo;</strong> (Apps) æ–‡ä»¶å¤¹</li>
<li>è¿›å…¥ä½ çš„åº”ç”¨æ–‡ä»¶å¤¹,ä¾‹å¦‚ <code>Apps/QuickFillForm/</code></li>
<li>ç¡®è®¤æ–‡ä»¶å·²æˆåŠŸä¸Šä¼ </li>
</ol>
<h3 id="55-æµ‹è¯•è·¨è®¾å¤‡åŒæ­¥">5.5 æµ‹è¯•è·¨è®¾å¤‡åŒæ­¥</h3>
<ol>
<li>åœ¨è®¾å¤‡ A ä¸Šä¼ æ•°æ®</li>
<li>åœ¨è®¾å¤‡ B ä¸Šç™»å½•åŒä¸€ Microsoft è´¦å·</li>
<li>ä¸‹è½½æ•°æ®,éªŒè¯æ˜¯å¦ä¸è®¾å¤‡ A ä¸€è‡´</li>
<li>ä¿®æ”¹æ•°æ®åå†æ¬¡ä¸Šä¼ </li>
<li>åœ¨è®¾å¤‡ A ä¸Šä¸‹è½½,éªŒè¯æ˜¯å¦æ›´æ–°</li>
</ol>
<hr>
<h2 id="å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ">å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 id="q1-æ— æ³•è·å–è®¿é—®ä»¤ç‰Œ">Q1: æ— æ³•è·å–è®¿é—®ä»¤ç‰Œ</h3>
<p><strong>é”™è¯¯ä¿¡æ¯:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">AADSTS50011: The redirect URI specified in the request does not match
</span></span></code></pre></div><p><strong>åŸå› åˆ†æ:</strong></p>
<ul>
<li>Client ID é…ç½®é”™è¯¯</li>
<li>é‡å®šå‘ URI ä¸åŒ¹é…</li>
<li>Extension ID æ›´æ”¹åæœªæ›´æ–° Azure é…ç½®</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ:</strong></p>
<ol>
<li>
<p>æ£€æŸ¥ä»£ç ä¸­çš„ <code>clientId</code> æ˜¯å¦æ­£ç¡®å¤åˆ¶</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// é”™è¯¯: å¤šä½™çš„ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦
</span></span></span><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="nx">clientId</span> <span class="o">=</span> <span class="s1">&#39;12345678-1234-1234-1234-123456789abc &#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// æ­£ç¡®
</span></span></span><span class="line"><span class="cl"><span class="k">this</span><span class="p">.</span><span class="nx">clientId</span> <span class="o">=</span> <span class="s1">&#39;12345678-1234-1234-1234-123456789abc&#39;</span><span class="p">;</span>
</span></span></code></pre></div></li>
<li>
<p>ç¡®è®¤ Azure åº”ç”¨æ³¨å†Œä¸­çš„é‡å®šå‘ URI ä¸ä»£ç å®Œå…¨ä¸€è‡´</p>
<ul>
<li>Azure é…ç½®: <code>https://abcdefg123456.chromiumapp.org/onedrive</code></li>
<li>ä»£ç é…ç½®: <code>https://abcdefg123456.chromiumapp.org/onedrive</code></li>
<li>æ³¨æ„åŒºåˆ†å¤§å°å†™å’Œå°¾éƒ¨æ–œæ </li>
</ul>
</li>
<li>
<p>ä¿å­˜é…ç½®åç­‰å¾… 2-5 åˆ†é’Ÿè®©é…ç½®ç”Ÿæ•ˆ</p>
</li>
</ol>
<h3 id="q2-æƒé™è¢«æ‹’ç»æ— æ³•è¯»å†™æ–‡ä»¶">Q2: æƒé™è¢«æ‹’ç»,æ— æ³•è¯»å†™æ–‡ä»¶</h3>
<p><strong>é”™è¯¯ä¿¡æ¯:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">403 Forbidden: Access denied
</span></span></code></pre></div><p><strong>åŸå› åˆ†æ:</strong></p>
<ul>
<li>æƒé™æœªæ­£ç¡®æ·»åŠ </li>
<li>ç”¨æˆ·æœªæˆæƒ</li>
<li>ä½¿ç”¨äº†é”™è¯¯çš„ API ç«¯ç‚¹</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ:</strong></p>
<ol>
<li>åœ¨ Azure Portal æ£€æŸ¥æ˜¯å¦å·²æ·»åŠ  <code>Files.ReadWrite.AppFolder</code> æƒé™</li>
<li>æ¸…é™¤ç”¨æˆ·æˆæƒ,é‡æ–°ç™»å½•å¹¶åŒæ„æƒé™
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// æ¸…é™¤ç¼“å­˜çš„ä»¤ç‰Œ
</span></span></span><span class="line"><span class="cl"><span class="nx">chrome</span><span class="p">.</span><span class="nx">identity</span><span class="p">.</span><span class="nx">clearAllCachedAuthTokens</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;å·²æ¸…é™¤ç¼“å­˜,è¯·é‡æ–°ç™»å½•&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div></li>
<li>ç¡®è®¤ä½¿ç”¨æ­£ç¡®çš„ API è·¯å¾„:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// æ­£ç¡®: ä½¿ç”¨åº”ç”¨ä¸“ç”¨æ–‡ä»¶å¤¹
</span></span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="s1">&#39;/me/drive/special/approot:/data.json:/content&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// é”™è¯¯: ä½¿ç”¨æ ¹ç›®å½• (éœ€è¦ Files.ReadWrite.All æƒé™)
</span></span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="s1">&#39;/me/drive/root:/data.json:/content&#39;</span><span class="p">;</span>
</span></span></code></pre></div></li>
</ol>
<h3 id="q3-è®¿é—®ä»¤ç‰Œè¿‡æœŸ">Q3: è®¿é—®ä»¤ç‰Œè¿‡æœŸ</h3>
<p><strong>é”™è¯¯ä¿¡æ¯:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">401 Unauthorized: The access token has expired
</span></span></code></pre></div><p><strong>åŸå› åˆ†æ:</strong></p>
<ul>
<li>Access Token é»˜è®¤æœ‰æ•ˆæœŸ 1 å°æ—¶</li>
<li>æœªå®ç° Refresh Token è‡ªåŠ¨åˆ·æ–°æœºåˆ¶</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ:</strong></p>
<p>å®ç°ä»¤ç‰Œåˆ·æ–°é€»è¾‘:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">OneDriveSync</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">accessToken</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">refreshToken</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">tokenExpiry</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// è·å–æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œ
</span></span></span><span class="line"><span class="cl">    <span class="kr">async</span> <span class="nx">getValidAccessToken</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// å¦‚æœä»¤ç‰Œæœªè¿‡æœŸ,ç›´æ¥è¿”å›
</span></span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">accessToken</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">tokenExpiry</span> <span class="o">&gt;</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">accessToken</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// å¦‚æœæœ‰åˆ·æ–°ä»¤ç‰Œ,å°è¯•åˆ·æ–°
</span></span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">refreshToken</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kr">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">refreshAccessToken</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// å¦åˆ™é‡æ–°ç™»å½•
</span></span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kr">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">getAccessToken</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// åˆ·æ–°è®¿é—®ä»¤ç‰Œ
</span></span></span><span class="line"><span class="cl">    <span class="kr">async</span> <span class="nx">refreshAccessToken</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;https://login.microsoftonline.com/common/oauth2/v2.0/token&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nx">body</span><span class="o">:</span> <span class="k">new</span> <span class="nx">URLSearchParams</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">                <span class="nx">client_id</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">clientId</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nx">refresh_token</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">refreshToken</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nx">grant_type</span><span class="o">:</span> <span class="s1">&#39;refresh_token&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">accessToken</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">access_token</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">refreshToken</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">refresh_token</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">tokenExpiry</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">expires_in</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
</span></span></span><span class="line"><span class="cl">        <span class="nx">chrome</span><span class="p">.</span><span class="nx">storage</span><span class="p">.</span><span class="nx">local</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="nx">onedrive_access_token</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">accessToken</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">onedrive_refresh_token</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">refreshToken</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">onedrive_token_expiry</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">tokenExpiry</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">accessToken</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="q4-æ‰¾ä¸åˆ°æ‰©å±•-id">Q4: æ‰¾ä¸åˆ°æ‰©å±• ID</h3>
<p><strong>è§£å†³æ–¹æ¡ˆ:</strong></p>
<ol>
<li>è®¿é—®æµè§ˆå™¨çš„æ‰©å±•ç®¡ç†é¡µé¢:
<ul>
<li>Chrome: <code>chrome://extensions/</code></li>
<li>Edge: <code>edge://extensions/</code></li>
</ul>
</li>
<li>ç¡®ä¿å·²å¼€å¯&quot;å¼€å‘è€…æ¨¡å¼&quot;</li>
<li>Extension ID æ˜¾ç¤ºåœ¨æ‰©å±•å¡ç‰‡ä¸Š,æ ¼å¼ç±»ä¼¼:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ID: abcdefghijklmnopqrstuvwxyz123456
</span></span></code></pre></div></li>
<li>å¦‚æœæ˜¯å·²å‘å¸ƒçš„æ‰©å±•,å¯ä»¥åœ¨ Chrome Web Store çš„ URL ä¸­æ‰¾åˆ°:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">https://chrome.google.com/webstore/detail/extension-name/abcdefghijklmnopqrstuvwxyz123456
</span></span></code></pre></div></li>
</ol>
<h3 id="q5-æ–‡ä»¶ä¸Šä¼ æˆåŠŸä½†åœ¨-onedrive-ä¸­æ‰¾ä¸åˆ°">Q5: æ–‡ä»¶ä¸Šä¼ æˆåŠŸä½†åœ¨ OneDrive ä¸­æ‰¾ä¸åˆ°</h3>
<p><strong>åŸå› åˆ†æ:</strong></p>
<ul>
<li>ä½¿ç”¨äº†åº”ç”¨ä¸“ç”¨æ–‡ä»¶å¤¹,è·¯å¾„åœ¨ <code>Apps/&lt;AppName&gt;/</code> ä¸‹</li>
<li>OneDrive ç½‘é¡µç‰ˆç•Œé¢å¯èƒ½æœ‰å»¶è¿Ÿ</li>
<li>æ–‡ä»¶åæˆ–è·¯å¾„é”™è¯¯</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ:</strong></p>
<ol>
<li>åœ¨ OneDrive ç½‘é¡µç‰ˆä¸­,å¯¼èˆªåˆ°:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">OneDrive â†’ åº”ç”¨ (Apps) â†’ QuickFillForm
</span></span></code></pre></div></li>
<li>ç­‰å¾… 1-2 åˆ†é’Ÿ,åˆ·æ–°é¡µé¢</li>
<li>ä½¿ç”¨ API æŸ¥è¯¢æ–‡ä»¶æ˜¯å¦å­˜åœ¨:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// åˆ—å‡ºåº”ç”¨æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">listFiles</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">onedriveSync</span><span class="p">.</span><span class="nx">getValidAccessToken</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;https://graph.microsoft.com/v1.0/me/drive/special/approot/children&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span> <span class="s1">&#39;Authorization&#39;</span><span class="o">:</span> <span class="sb">`Bearer </span><span class="si">${</span><span class="nx">token</span><span class="si">}</span><span class="sb">`</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;æ–‡ä»¶åˆ—è¡¨:&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ol>
<h3 id="q6-è·¨åŸŸè¯·æ±‚è¢«é˜»æ­¢-cors">Q6: è·¨åŸŸè¯·æ±‚è¢«é˜»æ­¢ (CORS)</h3>
<p><strong>é”™è¯¯ä¿¡æ¯:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Access to fetch at &#39;https://graph.microsoft.com/...&#39; has been blocked by CORS policy
</span></span></code></pre></div><p><strong>åŸå› åˆ†æ:</strong></p>
<ul>
<li>åœ¨æ™®é€šç½‘é¡µä¸­ç›´æ¥è¯·æ±‚ Graph API</li>
<li>æœªåœ¨ <code>manifest.json</code> ä¸­é…ç½® <code>host_permissions</code></li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ:</strong></p>
<p><strong>æ–¹æ¡ˆä¸€: ä½¿ç”¨åç«¯ä»£ç† (æ¨è)</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// å‰ç«¯è°ƒç”¨åç«¯ API
</span></span></span><span class="line"><span class="cl"><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/onedrive/upload&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">body</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// åç«¯è½¬å‘åˆ° Microsoft Graph
</span></span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/api/onedrive/upload&#39;</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;https://graph.microsoft.com/v1.0/...&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span> <span class="s1">&#39;Authorization&#39;</span><span class="o">:</span> <span class="sb">`Bearer </span><span class="si">${</span><span class="nx">accessToken</span><span class="si">}</span><span class="sb">`</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><p><strong>æ–¹æ¡ˆäºŒ: æµè§ˆå™¨æ’ä»¶é…ç½®</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;host_permissions&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;https://login.microsoftonline.com/*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;https://graph.microsoft.com/*&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="q7-æˆæƒé¡µé¢æ˜¾ç¤ºéœ€è¦ç®¡ç†å‘˜å®¡æ‰¹">Q7: æˆæƒé¡µé¢æ˜¾ç¤º&quot;éœ€è¦ç®¡ç†å‘˜å®¡æ‰¹&quot;</h3>
<p><strong>é”™è¯¯ä¿¡æ¯:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">AADSTS65001: The user or administrator has not consented to use the application
</span></span></code></pre></div><p><strong>åŸå› åˆ†æ:</strong></p>
<ul>
<li>ç»„ç»‡ç­–ç•¥è¦æ±‚ç®¡ç†å‘˜æ‰¹å‡†åº”ç”¨</li>
<li>è¯·æ±‚çš„æƒé™éœ€è¦ç®¡ç†å‘˜åŒæ„</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ:</strong></p>
<ol>
<li>å¦‚æœä½ æ˜¯ç®¡ç†å‘˜,åœ¨ Azure Portal ä¸­æˆäºˆç®¡ç†å‘˜åŒæ„</li>
<li>å¦‚æœä¸æ˜¯ç®¡ç†å‘˜,è”ç³» IT éƒ¨é—¨æ‰¹å‡†åº”ç”¨</li>
<li>ä½¿ç”¨ä¸ªäºº Microsoft è´¦å·æµ‹è¯•(ä¸ªäººè´¦å·æ— éœ€ç®¡ç†å‘˜åŒæ„)</li>
<li>å‡å°‘æƒé™è¯·æ±‚,åªä½¿ç”¨å§”æ‰˜æƒé™è€Œä¸æ˜¯åº”ç”¨æƒé™</li>
</ol>
<hr>
<h2 id="å®‰å…¨æœ€ä½³å®è·µ">å®‰å…¨æœ€ä½³å®è·µ</h2>
<h3 id="1-ä¿æŠ¤-client-secret">1. ä¿æŠ¤ Client Secret</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// âŒ é”™è¯¯: åœ¨å‰ç«¯ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥
</span></span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">clientSecret</span> <span class="o">=</span> <span class="s1">&#39;your-secret-key-123456&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// âœ… æ­£ç¡®: åœ¨åç«¯ä½¿ç”¨ç¯å¢ƒå˜é‡
</span></span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">clientSecret</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">AZURE_CLIENT_SECRET</span><span class="p">;</span>
</span></span></code></pre></div><h3 id="2-ä½¿ç”¨æœ€å°æƒé™åŸåˆ™">2. ä½¿ç”¨æœ€å°æƒé™åŸåˆ™</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// âŒ é”™è¯¯: è¯·æ±‚è¿‡å¤šæƒé™
</span></span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">scopes</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Files.ReadWrite.All&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Mail.Read&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Contacts.ReadWrite&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// âœ… æ­£ç¡®: åªè¯·æ±‚å¿…éœ€çš„æƒé™
</span></span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">scopes</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;Files.ReadWrite.AppFolder&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;offline_access&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">];</span>
</span></span></code></pre></div><h3 id="3-å®‰å…¨å­˜å‚¨ä»¤ç‰Œ">3. å®‰å…¨å­˜å‚¨ä»¤ç‰Œ</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// âœ… æµè§ˆå™¨æ’ä»¶: ä½¿ç”¨ chrome.storage.local
</span></span></span><span class="line"><span class="cl"><span class="nx">chrome</span><span class="p">.</span><span class="nx">storage</span><span class="p">.</span><span class="nx">local</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="nx">onedrive_token</span><span class="o">:</span> <span class="nx">encryptedToken</span>  <span class="c1">// æœ€å¥½åŠ å¯†å­˜å‚¨
</span></span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// âœ… Web åº”ç”¨: ä½¿ç”¨ HttpOnly Cookie
</span></span></span><span class="line"><span class="cl"><span class="nx">res</span><span class="p">.</span><span class="nx">cookie</span><span class="p">(</span><span class="s1">&#39;access_token&#39;</span><span class="p">,</span> <span class="nx">token</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">httpOnly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">secure</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">sameSite</span><span class="o">:</span> <span class="s1">&#39;strict&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><h3 id="4-å®šæœŸæ£€æŸ¥åº”ç”¨æ´»åŠ¨">4. å®šæœŸæ£€æŸ¥åº”ç”¨æ´»åŠ¨</h3>
<ol>
<li>ç™»å½• <a href="https://portal.azure.com/">Azure Portal</a></li>
<li>è¿›å…¥åº”ç”¨æ³¨å†Œ â†’ ä½ çš„åº”ç”¨</li>
<li>æŸ¥çœ‹ <strong>&ldquo;æ¦‚è¿°&rdquo;</strong> ä¸­çš„ä½¿ç”¨æƒ…å†µç»Ÿè®¡</li>
<li>æ£€æŸ¥å¼‚å¸¸ç™»å½•å’Œ API è°ƒç”¨</li>
</ol>
<h3 id="5-å¤„ç†æ•æ„Ÿæ•°æ®">5. å¤„ç†æ•æ„Ÿæ•°æ®</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// ä¸Šä¼ å‰åŠ å¯†æ•æ„Ÿæ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">uploadSecureData</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">encrypted</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">encryptData</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">await</span> <span class="nx">onedriveSync</span><span class="p">.</span><span class="nx">uploadFile</span><span class="p">(</span><span class="s1">&#39;secure-data.enc&#39;</span><span class="p">,</span> <span class="nx">encrypted</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ä¸‹è½½åè§£å¯†
</span></span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">downloadSecureData</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">encrypted</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">onedriveSync</span><span class="p">.</span><span class="nx">downloadFile</span><span class="p">(</span><span class="s1">&#39;secure-data.enc&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kr">await</span> <span class="nx">decryptData</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<h2 id="è¿›é˜¶æŠ€å·§">è¿›é˜¶æŠ€å·§</h2>
<h3 id="1-å®ç°æ–‡ä»¶ç‰ˆæœ¬ç®¡ç†">1. å®ç°æ–‡ä»¶ç‰ˆæœ¬ç®¡ç†</h3>
<p>OneDrive è‡ªåŠ¨ä¿ç•™æ–‡ä»¶ç‰ˆæœ¬å†å²,å¯ä»¥é€šè¿‡ API è®¿é—®:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">getFileVersions</span><span class="p">(</span><span class="nx">fileName</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">onedriveSync</span><span class="p">.</span><span class="nx">getValidAccessToken</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="sb">`https://graph.microsoft.com/v1.0/me/drive/special/approot:/</span><span class="si">${</span><span class="nx">fileName</span><span class="si">}</span><span class="sb">:/versions`</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span> <span class="s1">&#39;Authorization&#39;</span><span class="o">:</span> <span class="sb">`Bearer </span><span class="si">${</span><span class="nx">token</span><span class="si">}</span><span class="sb">`</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">data</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>  <span class="c1">// è¿”å›ç‰ˆæœ¬åˆ—è¡¨
</span></span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="2-å®ç°å¢é‡åŒæ­¥">2. å®ç°å¢é‡åŒæ­¥</h3>
<p>é€šè¿‡ Delta API è·å–æ–‡ä»¶å˜åŒ–:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">syncChanges</span><span class="p">(</span><span class="nx">deltaLink</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">onedriveSync</span><span class="p">.</span><span class="nx">getValidAccessToken</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">deltaLink</span> <span class="o">||</span> 
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;https://graph.microsoft.com/v1.0/me/drive/special/approot/delta&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span> <span class="s1">&#39;Authorization&#39;</span><span class="o">:</span> <span class="sb">`Bearer </span><span class="si">${</span><span class="nx">token</span><span class="si">}</span><span class="sb">`</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// å¤„ç†å˜åŒ–çš„æ–‡ä»¶
</span></span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kr">const</span> <span class="nx">item</span> <span class="k">of</span> <span class="nx">data</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">deleted</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;æ–‡ä»¶å·²åˆ é™¤:&#39;</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;æ–‡ä»¶å·²æ›´æ–°:&#39;</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// ä¿å­˜ deltaLink ä¾›ä¸‹æ¬¡ä½¿ç”¨
</span></span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">data</span><span class="p">[</span><span class="s1">&#39;@odata.deltaLink&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="3-å®ç°å†²çªè§£å†³">3. å®ç°å†²çªè§£å†³</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">smartSync</span><span class="p">(</span><span class="nx">fileName</span><span class="p">,</span> <span class="nx">localData</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ä¸‹è½½è¿œç¨‹æ–‡ä»¶
</span></span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">remoteData</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">onedriveSync</span><span class="p">.</span><span class="nx">downloadFile</span><span class="p">(</span><span class="nx">fileName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// æ¯”è¾ƒæ—¶é—´æˆ³
</span></span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">remoteData</span><span class="p">.</span><span class="nx">lastModified</span> <span class="o">&gt;</span> <span class="nx">localData</span><span class="p">.</span><span class="nx">lastModified</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// è¿œç¨‹æ›´æ–°,ä¸‹è½½è¦†ç›–æœ¬åœ°
</span></span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span> <span class="nx">action</span><span class="o">:</span> <span class="s1">&#39;download&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="o">:</span> <span class="nx">remoteData</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">localData</span><span class="p">.</span><span class="nx">lastModified</span> <span class="o">&gt;</span> <span class="nx">remoteData</span><span class="p">.</span><span class="nx">lastModified</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// æœ¬åœ°æ›´æ–°,ä¸Šä¼ è¦†ç›–è¿œç¨‹
</span></span></span><span class="line"><span class="cl">            <span class="kr">await</span> <span class="nx">onedriveSync</span><span class="p">.</span><span class="nx">uploadFile</span><span class="p">(</span><span class="nx">fileName</span><span class="p">,</span> <span class="nx">localData</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span> <span class="nx">action</span><span class="o">:</span> <span class="s1">&#39;upload&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="o">:</span> <span class="nx">localData</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// æ™ºèƒ½åˆå¹¶
</span></span></span><span class="line"><span class="cl">            <span class="kr">const</span> <span class="nx">merged</span> <span class="o">=</span> <span class="nx">mergeData</span><span class="p">(</span><span class="nx">localData</span><span class="p">,</span> <span class="nx">remoteData</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="kr">await</span> <span class="nx">onedriveSync</span><span class="p">.</span><span class="nx">uploadFile</span><span class="p">(</span><span class="nx">fileName</span><span class="p">,</span> <span class="nx">merged</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span> <span class="nx">action</span><span class="o">:</span> <span class="s1">&#39;merge&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="o">:</span> <span class="nx">merged</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// æ–‡ä»¶ä¸å­˜åœ¨,ç›´æ¥ä¸Šä¼ 
</span></span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">404</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kr">await</span> <span class="nx">onedriveSync</span><span class="p">.</span><span class="nx">uploadFile</span><span class="p">(</span><span class="nx">fileName</span><span class="p">,</span> <span class="nx">localData</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{</span> <span class="nx">action</span><span class="o">:</span> <span class="s1">&#39;create&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="o">:</span> <span class="nx">localData</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="4-æ‰¹é‡æ“ä½œ">4. æ‰¹é‡æ“ä½œ</h3>
<p>ä½¿ç”¨æ‰¹å¤„ç† API æé«˜æ€§èƒ½:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">batchUpload</span><span class="p">(</span><span class="nx">files</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">onedriveSync</span><span class="p">.</span><span class="nx">getValidAccessToken</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">requests</span> <span class="o">=</span> <span class="nx">files</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">file</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="nx">id</span><span class="o">:</span> <span class="nx">index</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">url</span><span class="o">:</span> <span class="sb">`/me/drive/special/approot:/</span><span class="si">${</span><span class="nx">file</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">:/content`</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">body</span><span class="o">:</span> <span class="nx">file</span><span class="p">.</span><span class="nx">content</span>
</span></span><span class="line"><span class="cl">    <span class="p">}));</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;https://graph.microsoft.com/v1.0/$batch&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;Authorization&#39;</span><span class="o">:</span> <span class="sb">`Bearer </span><span class="si">${</span><span class="nx">token</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">body</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="nx">requests</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kr">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<h2 id="ç›¸å…³èµ„æº">ç›¸å…³èµ„æº</h2>
<h3 id="å®˜æ–¹æ–‡æ¡£">å®˜æ–¹æ–‡æ¡£</h3>
<ul>
<li>ğŸ“˜ <a href="https://docs.microsoft.com/zh-cn/graph/overview">Microsoft Graph API æ–‡æ¡£</a></li>
<li>ğŸ“˜ <a href="https://docs.microsoft.com/zh-cn/onedrive/developer/">OneDrive API å‚è€ƒ</a></li>
<li>ğŸ“˜ <a href="https://docs.microsoft.com/zh-cn/azure/active-directory/develop/quickstart-register-app">Azure AD åº”ç”¨æ³¨å†ŒæŒ‡å—</a></li>
<li>ğŸ“˜ <a href="https://docs.microsoft.com/zh-cn/azure/active-directory/develop/v2-oauth2-auth-code-flow">OAuth 2.0 æˆæƒæµç¨‹</a></li>
</ul>
<h3 id="å¼€å‘å·¥å…·">å¼€å‘å·¥å…·</h3>
<ul>
<li>ğŸ› ï¸ <a href="https://developer.microsoft.com/zh-cn/graph/graph-explorer">Graph Explorer</a> - åœ¨çº¿æµ‹è¯• API</li>
<li>ğŸ› ï¸ <a href="https://github.com/microsoftgraph">Microsoft Graph SDK</a> - å„è¯­è¨€ SDK</li>
<li>ğŸ› ï¸ <a href="https://www.postman.com/microsoftgraph/workspace/microsoft-graph/overview">Postman Collection</a> - API è°ƒè¯•</li>
</ul>
<h3 id="ç¤ºä¾‹é¡¹ç›®">ç¤ºä¾‹é¡¹ç›®</h3>
<ul>
<li>ğŸ’» <a href="https://github.com/OneDrive/onedrive-api-docs/blob/live/samples/javascript-picker-saver.md">OneDrive JavaScript SDK</a></li>
<li>ğŸ’» <a href="https://github.com/GoogleChrome/chrome-extensions-samples/tree/main/api-samples/identity">æµè§ˆå™¨æ’ä»¶ OAuth ç¤ºä¾‹</a></li>
</ul>
<h3 id="ç¤¾åŒºèµ„æº">ç¤¾åŒºèµ„æº</h3>
<ul>
<li>ğŸ’¬ <a href="https://techcommunity.microsoft.com/t5/microsoft-graph/ct-p/MicrosoftGraph">Microsoft Graph å¼€å‘è€…è®ºå›</a></li>
<li>ğŸ’¬ <a href="https://stackoverflow.com/questions/tagged/microsoft-graph">Stack Overflow - microsoft-graph</a></li>
</ul>
]]></content:encoded>
    </item>
  </channel>
</rss>
