<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>C 语言 typedef 用法 - 如云泊</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">




<meta name="description" content="">










<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">


<link rel="stylesheet" href="../../../../css/style.css">


<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>



<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="atom.xml" title="如云泊" type="application/atom+xml">
</head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="../../../../index.html">
                
                <img src="../../../../images/logo.png" alt="" height="28">
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-end">
            
            
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            C 语言 typedef 用法
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2022-01-07T03:51:50.000Z" itemprop="datePublished">1月 7 2022</time>
            
        </span>
        
        
        <span class="column is-narrow">
            
            
            10 分钟 读完 (约 1460 字)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><code>typedef</code>为 C 语言的关键字，作用是为一种数据类型定义一个新名字。这里的数据类型包括内部数据类型（int,char 等）和自定义的数据类型（struct 等）。在使用语法上类似与<code>static</code>，<code>extern</code>等。<br><code>typedef</code> 行为有点像 <code>#define</code> 宏，用其实际类型替代同义字。不同点是 <code>typedef</code>在编译时被解释，因此让编译器来应付超越预处理器能力的文本替换。</p>
<h2 id="基本使用方法"><a href="#基本使用方法" class="headerlink" title="基本使用方法"></a>基本使用方法</h2><p>示例 1：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">int</span> a; ———— 传统变量声明表达式<br><span class="hljs-keyword">int</span> <span class="hljs-keyword">myint_t</span>; ———— 使用新的类型名<span class="hljs-keyword">myint_t</span>替换变量名a<br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">int</span> <span class="hljs-keyword">myint_t</span>; ———— 在语句开头加上<span class="hljs-keyword">typedef</span>关键字，<span class="hljs-keyword">myint_t</span>就是我们定义的新类型<br></code></pre></td></tr></table></figure>

<p>示例 2：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-built_in">void</span> (*pfunA)(<span class="hljs-built_in">int</span> a); ———— 传统变量（函数）声明表达式<br><span class="hljs-built_in">void</span> (*PFUNA)(<span class="hljs-built_in">int</span> a); ———— 使用新的类型名PFUNA替换变量名pfunA<br><span class="hljs-keyword">typedef</span> <span class="hljs-built_in">void</span> (*PFUNA)(<span class="hljs-built_in">int</span> a); ———— 在语句开头加上<span class="hljs-keyword">typedef</span>关键字，PFUNA就是我们定义的新类型<br></code></pre></td></tr></table></figure>

<p>促使我写这篇文章的原因不是如何去用<code>typedef</code>，而是在代码中看不懂如何简化了一个复杂声明。比如上文的</p>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elm">typedef void (*<span class="hljs-type">PFUNA</span>)(int a);<br></code></pre></td></tr></table></figure>

<p>本以为是将<code>void</code>类型替换成了<code>(*PFUNA)(int a)</code>，但是语法上这明显讲不通啊。现在明白了，这就是将<code>void (*pfunA)(int a);</code>类型名换成了<code>PFUNA</code>。以后就可以用<code>PFUNA</code>来声明变量。比如</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">PFUNA</span> arr[<span class="hljs-number">10</span>]<br></code></pre></td></tr></table></figure>

<p>表示声明了一个大小为<code>10</code>的数组，数组的元素是<code>PFUNA</code>类型。将<code>PFUNA</code>类型展开就是，这是一个函数指针，函数参数为<code>int</code>类型，返回值为<code>void</code>类型。完整的含义就是，<strong>声明了一个大小为<code>10</code>的数组，数组元素是函数指针，函数参数为<code>int</code>类型，返回值为<code>void</code>类型</strong>。</p>
<h2 id="代码简化"><a href="#代码简化" class="headerlink" title="代码简化"></a>代码简化</h2><p><code>typedef</code>可以为复杂的声明定义一个新的简单的别名。关于复杂声明，可以阅读这篇<a target="_blank" rel="noopener" href="https://dunky-z.github.io/2021/10/22/C%E8%AF%AD%E8%A8%80%E5%A4%8D%E6%9D%82%E5%A3%B0%E6%98%8E/">C 语言复杂声明</a>。<br>方法是：在原来的声明里逐步用别名替换一部分复杂声明，递归操作，把带变量名的部分留到最后替换，得到的就是原声明的最简化版。举例：</p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs delphi"><span class="hljs-comment">//复杂声明</span><br>void <span class="hljs-comment">(*b[10]) (void (*)</span>());<br></code></pre></td></tr></table></figure>

<p>变量名为<code>b</code>，先替换右边部分括号里的，<code>pFunParam</code>为别名</p>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elm">typedef void (*pFunParam)();<br></code></pre></td></tr></table></figure>

<p>再替换左边的变量<code>b</code>，<code>pFunx</code>为别名二：</p>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elm">typedef void (*pFunx)(pFunParam);<br></code></pre></td></tr></table></figure>

<p>简化后的声明：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">pFunx <span class="hljs-selector-tag">b</span><span class="hljs-selector-attr">[10]</span>;<br></code></pre></td></tr></table></figure>

<h2 id="减少错误"><a href="#减少错误" class="headerlink" title="减少错误"></a>减少错误</h2><p>定义一种类型的别名，而不只是简单的宏替换。可以用作同时声明指针型的多个对象。比如：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span> 这多数不符合我们的意图，它只声明了一个指向字符变量的指针，<br><span class="hljs-regexp">//</span> 和一个字符变量；<br>char* pa, pb;<br></code></pre></td></tr></table></figure>

<p>以下则可行：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">char</span>* PCHAR;<br>PCHAR pa, pb;  <br></code></pre></td></tr></table></figure>

<p>这种用法很有用，特别是<code>char* pa, pb</code>的定义，初学者往往认为是定义了两个字符型指针，其实不是，而用<code>typedef char* PCHAR</code>就不会出现这样的问题，减少了错误的发生。</p>
<h2 id="直观简洁"><a href="#直观简洁" class="headerlink" title="直观简洁"></a>直观简洁</h2><p>声明<code>struct</code>新对象时，必须要带上<code>struct</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tagPOINT1</span></span><br><span class="hljs-class"> &#123;</span><br>    <span class="hljs-keyword">int</span> x;<br>    <span class="hljs-keyword">int</span> y; <br>&#125;;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tagPOINT1</span> <span class="hljs-title">p1</span>;</span><br></code></pre></td></tr></table></figure>

<p>在经常使用这个结构体时，就显得麻烦，可以用<code>typedef</code>简化</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tagPOINT</span></span><br><span class="hljs-class">&#123;</span><br>    <span class="hljs-keyword">int</span> x;<br>    <span class="hljs-keyword">int</span> y;<br>&#125;POINT;<br></code></pre></td></tr></table></figure>

<h2 id="定义平台无关的类型"><a href="#定义平台无关的类型" class="headerlink" title="定义平台无关的类型"></a>定义平台无关的类型</h2><p>当跨平台时，只要改下 <code>typedef</code> 本身就行，不用对其他源码做任何修改。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> u_32t; <br></code></pre></td></tr></table></figure>

<h2 id="掩饰复合类型"><a href="#掩饰复合类型" class="headerlink" title="掩饰复合类型"></a>掩饰复合类型</h2><p><code>typedef</code> 还可以掩饰复合类型，如指针和数组。</p>
<p>例如，你不用像下面这样重复定义有 81 个字符元素的数组：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">char</span> line[<span class="hljs-number">81</span>];<br></code></pre></td></tr></table></figure>

<p>定义一个 <code>typedef</code>，每当要用到相同类型和大小的数组时，可以这样：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">char</span> Line[<span class="hljs-number">81</span>]; <br></code></pre></td></tr></table></figure>

<p>此时 Line 类型即代表了具有 81 个元素的字符数组，使用方法如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Line text, secondline; <br></code></pre></td></tr></table></figure>

<p>同样，可以象下面这样隐藏指针语法：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">char</span> * pstr;<br></code></pre></td></tr></table></figure>

<p>这里将带我们到达第一个 <code>typedef</code> 陷阱。标准函数 <code>strcmp()</code>有两个<code>const char *</code>类型的参数。因此，它可能会误导人们象下面这样声明 <code>mystrcmp()</code>：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">mystrcmp</span><span class="hljs-params">(<span class="hljs-keyword">const</span> pstr, <span class="hljs-keyword">const</span> pstr)</span></span>; <br></code></pre></td></tr></table></figure>

<p>用 GNU 的 gcc 和 g++编译器，是会出现警告的，按照顺序，<code>const pstr</code>被解释为<code>char* const</code>（一个指向 <code>char</code> 的指针常量），两者表达的并非同一意思。为了得到正确的类型，应当如下声明：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* pstr;<br></code></pre></td></tr></table></figure>

<h2 id="typedef-和存储类关键字"><a href="#typedef-和存储类关键字" class="headerlink" title="typedef 和存储类关键字"></a>typedef 和存储类关键字</h2><p><code>typedef</code> 就像 <code>auto</code>，<code>extern</code>，<code>mutable</code>，<code>static</code>，和 <code>register</code> 一样，是一个存储类关键字。这并不是说 <code>typedef</code> 会真正影响对象的存储特性；它只是说在语句构成上，<code>typedef</code> 声明看起来象 <code>static</code>，<code>extern</code> 等类型的变量声明。下面将带到第二个陷阱：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">register</span> <span class="hljs-keyword">int</span> FAST_COUNTER; <span class="hljs-comment">// 错误</span><br></code></pre></td></tr></table></figure>

<p>编译通不过。问题出在你不能在声明中有多个存储类关键字。因为符号 <code>typedef</code> 已经占据了存储类关键字的位置，在 <code>typedef</code> 声明中不能用 <code>register</code>（或任何其它存储类关键字）。</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/liitdar/article/details/80069638">typedef 介绍_liitdar 的博客-CSDN 博客_typedef</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wangqiulin123456/article/details/8284939">关于 typedef 的用法总结_IT 民工-CSDN 博客_typedef</a></p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="../../08/C%E8%AF%AD%E8%A8%80-attribute-%E4%BD%BF%E7%94%A8/">C 语言__attribute__使用</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="../../05/Windows%E6%89%B9%E5%A4%84%E7%90%86%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/">Windows 批处理定时任务</a>
            
        </span>
    </div>
    
</article>




    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2024 Dominic&nbsp;
                powered_by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("zh-CN");
</script>




<script src="../../../../js/script.js"></script>


    
</body>
</html>