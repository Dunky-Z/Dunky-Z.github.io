<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>标签: OpenStack - 如云泊</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">




<meta name="description" content="">










<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">


<link rel="stylesheet" href="../../css/style.css">


<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>



<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="atom.xml" title="如云泊" type="application/atom+xml">
</head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="../../index.html">
                
                <img src="../../images/logo.png" alt="" height="28">
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-end">
            
            
            
        </div>
    </div>
</nav>

    <section class="section section-heading">
    <div class="container">
        <div class="content">
            <h5>#OpenStack</h5>
        </div>
    </div>
</section>
<section class="section">
    <div class="container">
    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="../../2023/06/28/SSH-%E7%99%BB%E5%BD%95-OpenStack-%E5%AE%9E%E4%BE%8B/" itemprop="url">SSH 登录 OpenStack 实例</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2023-06-28T14:20:05.000Z" itemprop="datePublished">6月 28 2023</time>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="../../categories/OpenStack/">OpenStack</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            5 分钟 读完 (约 819 字)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <h1 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h1><p>添加安全组规则，允许 Ping 和 SSH 访问虚拟机：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openstack security group rule create --proto icmp default</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">root@allone:~<span class="comment"># openstack security group rule create --proto icmp default</span></span><br><span class="line">+-------------------+---------------------------+</span><br><span class="line">| Field             | Value                                                                                                                                                   |</span><br><span class="line">+-------------------+-------------------------+</span><br><span class="line">| created_at        | 2023-06-28T06:26:10Z                                                                                                                                    |</span><br><span class="line">| description       |                                                                                                                                                         |</span><br><span class="line">| direction         | ingress                                                                                                                                                 |</span><br><span class="line">| ether_type        | IPv4                                                                                                                                                    |</span><br><span class="line">| id                | fe9adfc3-dc42-4680-8ecd-ed5a667e1215                                                                                                                    |</span><br><span class="line">| location          | cloud=<span class="string">&#x27;&#x27;</span>, project.domain_id=, project.domain_name=<span class="string">&#x27;Default&#x27;</span>, project.id=<span class="string">&#x27;6396365541a74b6b8ea8812d1af05e70&#x27;</span>, project.name=<span class="string">&#x27;admin&#x27;</span>, region_name=<span class="string">&#x27;&#x27;</span>, zone= |</span><br><span class="line">| name              | None                                                                                                                                                    |</span><br><span class="line">| port_range_max    | None                                                                                                                                                    |</span><br><span class="line">| port_range_min    | None                                                                                                                                                    |</span><br><span class="line">| project_id        | 6396365541a74b6b8ea8812d1af05e70                                                                                                                        |</span><br><span class="line">| protocol          | icmp                                                                                                                                                    |</span><br><span class="line">| remote_group_id   | None                                                                                                                                                    |</span><br><span class="line">| remote_ip_prefix  | 0.0.0.0/0                                                                                                                                               |</span><br><span class="line">| revision_number   | 0                                                                                                                                                       |</span><br><span class="line">| security_group_id | f10a3927-5e76-47b4-8691-4169348845ae                                                                                                                    |</span><br><span class="line">| tags              | []                                                                                                                                                      |</span><br><span class="line">| updated_at        | 2023-06-28T06:26:10Z                                                                                                                                    |</span><br><span class="line">+-------------------+--------------------------------+</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openstack security group rule create --proto tcp --dst-port 22 default</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">root@allone:~<span class="comment"># openstack security group rule  create --proto tcp --dst-port 22 default</span></span><br><span class="line">+-------------------+--------------------------------------+</span><br><span class="line">| Field             | Value                                                                                                                                                   |</span><br><span class="line">+-------------------+--------------------------------------------+</span><br><span class="line">| created_at        | 2023-06-28T06:26:15Z                                                                                                                                    |</span><br><span class="line">| description       |                                                                                                                                                         |</span><br><span class="line">| direction         | ingress                                                                                                                                                 |</span><br><span class="line">| ether_type        | IPv4                                                                                                                                                    |</span><br><span class="line">| id                | af699cf9-5fc0-45e2-a009-0bb7828e2d1a                                                                                                                    |</span><br><span class="line">| location          | cloud=<span class="string">&#x27;&#x27;</span>, project.domain_id=, project.domain_name=<span class="string">&#x27;Default&#x27;</span>, project.id=<span class="string">&#x27;6396365541a74b6b8ea8812d1af05e70&#x27;</span>, project.name=<span class="string">&#x27;admin&#x27;</span>, region_name=<span class="string">&#x27;&#x27;</span>, zone= |</span><br><span class="line">| name              | None                                                                                                                                                    |</span><br><span class="line">| port_range_max    | 22                                                                                                                                                      |</span><br><span class="line">| port_range_min    | 22                                                                                                                                                      |</span><br><span class="line">| project_id        | 6396365541a74b6b8ea8812d1af05e70                                                                                                                        |</span><br><span class="line">| protocol          | tcp                                                                                                                                                     |</span><br><span class="line">| remote_group_id   | None                                                                                                                                                    |</span><br><span class="line">| remote_ip_prefix  | 0.0.0.0/0                                                                                                                                               |</span><br><span class="line">| revision_number   | 0                                                                                                                                                       |</span><br><span class="line">| security_group_id | f10a3927-5e76-47b4-8691-4169348845ae                                                                                                                    |</span><br><span class="line">| tags              | []                                                                                                                                                      |</span><br><span class="line">| updated_at        | 2023-06-28T06:26:15Z                                                                                                                                    |</span><br><span class="line">+-------------------+-----------------+</span><br></pre></td></tr></table></figure>

<h1 id="命令行方式"><a href="#命令行方式" class="headerlink" title="命令行方式"></a>命令行方式</h1><h2 id="生成秘钥"><a href="#生成秘钥" class="headerlink" title="生成秘钥"></a>生成秘钥</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -q -N “”</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><code>-q</code> 选项表示静默模式，即在生成密钥对的过程中不会输出任何提示信息或警告。</li>
<li><code>-N</code> 选项后面可以跟一个密码作为参数。该密码将用于保护生成的私钥文件。如果不指定 <code>-N</code> 参数，则私钥文件将不受密码保护。</li>
</ul>
</blockquote>
<p>该命令会在<code>~/.ssh/</code>目录中自动生成一对公私钥。默认私钥名称：id_rsa，默认公钥名称：id_rsa.pub</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openstack keypair create --public-key ~/.ssh/id_rsa.pub mykey</span><br></pre></td></tr></table></figure>

<p>向 OpenStack 添加公钥，用于创建实例时选择：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@allone:~<span class="comment"># openstack keypair create --public-key ~/.ssh/id_rsa.pub mykey</span></span><br><span class="line">+-------------+-------------------------------------------------+</span><br><span class="line">| Field       | Value                                           |</span><br><span class="line">+-------------+-------------------------------------------------+</span><br><span class="line">| fingerprint | 11:36:75:e0:c3:98:4c:97:90:30:f5:69:e1:17:a9:4b |</span><br><span class="line">| name        | mykey                                           |</span><br><span class="line">| user_id     | 9027da91a2134825a421d78db11011d0                |</span><br><span class="line">+-------------+-------------------------------------------------+</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openstack keypair list</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@allone:~<span class="comment"># openstack keypair list</span></span><br><span class="line">+---------------------+-------------------------------------------------+</span><br><span class="line">| Name                | Fingerprint                                     |</span><br><span class="line">+---------------------+-------------------------------------------------+</span><br><span class="line">| mykey               | 11:36:75:e0:c3:98:4c:97:90:30:f5:69:e1:17:a9:4b |</span><br><span class="line">| ubuntu cloud server | 67:b4:8a:64:83:4e:47:d0:7c:87:46:34:3b:03:e6:17 |</span><br><span class="line">+---------------------+-------------------------------------------------+</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh ubuntu@10.0.2.111</span><br></pre></td></tr></table></figure>

<p>其中，<code>ubuntun</code>是实例的用户名，<code>10.0.2.111</code>是实例的 IP 地址。</p>
<h1 id="WEB-界面方式"><a href="#WEB-界面方式" class="headerlink" title="WEB 界面方式"></a>WEB 界面方式</h1><h2 id="创建密钥对"><a href="#创建密钥对" class="headerlink" title="创建密钥对"></a>创建密钥对</h2><p>Project-Key Pairs-Create Keypairs</p>
<p><img src="https://picbed-1311007548.cos.ap-shanghai.myqcloud.com/markdown_picbed/img/17-53-21-d58cbf697d71c5fff58fda7a8145ceae-20230628175315-733a20.png"></p>
<p>为密钥对起个名字：sshkey，并选择一个类型：SSH Key</p>
<p><img src="https://picbed-1311007548.cos.ap-shanghai.myqcloud.com/markdown_picbed/img/17-53-37-56223c56c675b84ea1d375399db38175-20230628175333-06df78.png"></p>
<p>点击创建后会弹出下载私钥的窗口，这时候需要将私钥下载到本地。并将他移动到 ssh 目录下方便管理。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换root用户，因为我们一直都是用root用户操作的OpenStack</span></span><br><span class="line">sudo su</span><br><span class="line">mv sshkey.pem ~/.ssh</span><br></pre></td></tr></table></figure>

<p><img src="https://picbed-1311007548.cos.ap-shanghai.myqcloud.com/markdown_picbed/img/17-53-54-d452e4565933506f89744f60f01d7956-20230628175349-ffaa20.png"></p>
<h2 id="使用公钥创建实例"><a href="#使用公钥创建实例" class="headerlink" title="使用公钥创建实例"></a>使用公钥创建实例</h2><p>Project-Instances-Launch Instance</p>
<p><img src="https://picbed-1311007548.cos.ap-shanghai.myqcloud.com/markdown_picbed/img/17-54-08-24889d77a26052dab99f758c54ce9483-20230628175403-9acef3.png"></p>
<p>在 Key Pair 中选择刚刚创建的 sshkey。这里实际就是将创建的密钥对中的公钥放到了我们的实例中，这样我们就可以拿着本地的私钥去访问实例。</p>
<p><img src="https://picbed-1311007548.cos.ap-shanghai.myqcloud.com/markdown_picbed/img/17-54-19-5ac37e246ffbd6007356092eac047d6b-20230628175415-7f105e.png"></p>
<h2 id="登录实例"><a href="#登录实例" class="headerlink" title="登录实例"></a>登录实例</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -i ~/.ssh/sshkey.pem  ubuntun@10.0.2.111</span><br></pre></td></tr></table></figure>

<p>其中<code>~/.ssh/sshkey.pem</code>是我们下载的私钥文件，<code>ubuntun</code>是实例的用户名，<code>10.0.2.111</code>是实例的 IP 地址。</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">
    
    </div>
    
    
</article>




    
        <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            <a href="../../2023/06/09/Devstack%E9%83%A8%E7%BD%B2OpenStack/" itemprop="url">Devstack 部署 OpenStack</a>
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2023-06-09T13:38:34.000Z" itemprop="datePublished">6月 9 2023</time>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="../../categories/OpenStack/">OpenStack</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            10 分钟 读完 (约 1429 字)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <h1 id="Devstack-部署-OpenStack"><a href="#Devstack-部署-OpenStack" class="headerlink" title="Devstack 部署 OpenStack"></a>Devstack 部署 OpenStack</h1><p>试验发现在 Host 为 Ubuntu20.04 和 22.04 上无法顺利安装 VirtualBox，请在 Ubuntu18.04 上安装 VirtualBox。虚拟机镜像版本为 Ubuntu20.04，以下步骤可以稳定复现，OpenStack master（c424a7a299e37004d318107648bb18e157344985）版本。</p>
<p>总而言之，在 18.04 版本上安装 VirtualBox，在 20.04 版本上安装 OpenStack。</p>
<p>因为安装 OpenStack 容易破话系统包依赖，如果为了学习建议在虚拟机中安装。</p>
<p>安装过程中需要下载镜像，请确认机器可以访问外网。</p>
<h2 id="安装-VirtualBox"><a href="#安装-VirtualBox" class="headerlink" title="安装 VirtualBox"></a>安装 VirtualBox</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install virtualbox virtualbox-ext-pack</span><br></pre></td></tr></table></figure>

<h2 id="确认-VirtualBox-配置"><a href="#确认-VirtualBox-配置" class="headerlink" title="确认 VirtualBox 配置"></a>确认 VirtualBox 配置</h2><p>请确认 VirtualBox 配置如下，VirtualBox 默认配置硬盘为 10G，远远不够用，为了避免后续的麻烦，请确认如下配置：</p>
<p>磁盘大于 100G</p>
<p>内存大于 16G</p>
<p>CPU 大于 4 个</p>
<h2 id="下载镜像并安装"><a href="#下载镜像并安装" class="headerlink" title="下载镜像并安装"></a>下载镜像并安装</h2><p>镜像可以去<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/">清华大学开源软件镜像站 | Tsinghua Open Source Mirror</a>下载。</p>
<h2 id="更新源"><a href="#更新源" class="headerlink" title="更新源"></a>更新源</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sudo mv /etc/apt/sources.list /etc/apt/sources.list.bk &amp;&amp; sudo bash -c <span class="string">&quot;cat &lt;&lt; EOF &gt; /etc/apt/sources.list</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ jammy-security main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ jammy-security main restrcdicted universe multiverse</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ jammy-updates main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ jammy-updates main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ jammy-proposed main restrcd &amp;&amp; mkdir .pip &amp;&amp; cd .pipicted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ jammy-proposed main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ jammy-backports main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ jammy-backports main restricted universe multiverse</span></span><br><span class="line"><span class="string">EOF&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="备用源-以备不时之需"><a href="#备用源-以备不时之需" class="headerlink" title="备用源 (以备不时之需)"></a>备用源 (以备不时之需)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sudo mv /etc/apt/sources.list /etc/apt/sources.list.bk &amp;&amp; sudo bash -c <span class="string">&quot;cat &lt;&lt; EOF &gt; /etc/apt/sources.list</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ jammy main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ jammy-security main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ jammy-security main restrcdicted universe multiverse</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ jammy-updates main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ jammy-updates main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ jammy-proposed main restrcd &amp;&amp; mkdir .pip &amp;&amp; cd .pipicted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ jammy-proposed main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ jammy-backports main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ jammy-backports main restricted universe multiverse</span></span><br><span class="line"><span class="string">EOF&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sudo mv /etc/apt/sources.list /etc/apt/sources.list.bk &amp;&amp; sudo bash -c <span class="string">&quot;cat &lt;&lt; EOF &gt; /etc/apt/sources.list</span></span><br><span class="line"><span class="string">deb https://mirrors.aliyun.com/ubuntu/ trusty main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src https://mirrors.aliyun.com/ubuntu/ trusty main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb https://mirrors.aliyun.com/ubuntu/ trusty-security main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src https://mirrors.aliyun.com/ubuntu/ trusty-security main restricted universe multiverse</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">deb https://mirrors.aliyun.com/ubuntu/ trusty-updates main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src https://mirrors.aliyun.com/ubuntu/ trusty-updates main restricted universe multiverse</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">deb https://mirrors.aliyun.com/ubuntu/ trusty-backports main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src https://mirrors.aliyun.com/ubuntu/ trusty-backports main restricted universe multiverse</span></span><br><span class="line"><span class="string">EOF&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">sudo mv /etc/apt/sources.list /etc/apt/sources.list.bk &amp;&amp; sudo bash -c <span class="string">&quot;cat &lt;&lt; EOF &gt; /etc/apt/sources.list</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ xenial-proposed main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-proposed main restricted universe multiverse</span></span><br><span class="line"><span class="string">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse</span></span><br><span class="line"><span class="string">EOF&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="安装基础包"><a href="#安装基础包" class="headerlink" title="安装基础包"></a>安装基础包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install git</span><br><span class="line">sudo apt install aptitude</span><br></pre></td></tr></table></figure>

<p>aptitude 用于解决包依赖冲突。</p>
<h2 id="添加用户"><a href="#添加用户" class="headerlink" title="添加用户"></a>添加用户</h2><p>添加 stack 用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo useradd -s /bin/bash -d /opt/stack -m stack</span><br></pre></td></tr></table></figure>

<p>授予 sudo 权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;stack ALL=(ALL) NOPASSWD: ALL&quot;</span> | sudo tee /etc/sudoers.d/stack</span><br></pre></td></tr></table></figure>

<p>切换到 stack 用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su -  stack</span><br></pre></td></tr></table></figure>

<h2 id="PIP-配置"><a href="#PIP-配置" class="headerlink" title="PIP 配置"></a>PIP 配置</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd &amp;&amp; mkdir -p  .pip &amp;&amp; cd .pip &amp;&amp; bash -c &quot;cat &lt;&lt; EOF &gt; ~/.pip/pip.conf</span><br><span class="line">[global]</span><br><span class="line">timeout = 6000</span><br><span class="line">index-url = http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">trusted-host = mirrors.aliyun.com</span><br><span class="line">EOF&quot;</span><br></pre></td></tr></table></figure>

<h2 id="仓库下载"><a href="#仓库下载" class="headerlink" title="仓库下载"></a>仓库下载</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/openstack/devstack --depth 1</span><br></pre></td></tr></table></figure>

<h3 id="配置-local-conf"><a href="#配置-local-conf" class="headerlink" title="配置 local.conf"></a>配置 local.conf</h3><p>只需要修改 HOST_IP，其他的可以不用修改，HOST_IP 为本机 IP 地址，可以使用 ifconfig 查看。如果是虚拟机就是虚拟机的 IP，virtualbox 创建的虚拟机默认为 10.0.2.15。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> devstack &amp;&amp; touch local.conf &amp;&amp; bash -c <span class="string">&quot;cat &lt;&lt; EOF &gt; /opt/stack/devstack/local.conf</span></span><br><span class="line"><span class="string">[[local|localrc]]</span></span><br><span class="line"><span class="string">HOST_IP=10.0.2.15</span></span><br><span class="line"><span class="string">GIT_BASE=http://git.trystack.cn</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ADMIN_PASSWORD=user</span></span><br><span class="line"><span class="string">DATABASE_PASSWORD=<span class="variable">$ADMIN_PASSWORD</span></span></span><br><span class="line"><span class="string">RABBIT_PASSWORD=<span class="variable">$ADMIN_PASSWORD</span></span></span><br><span class="line"><span class="string">SERVICE_PASSWORD=<span class="variable">$ADMIN_PASSWORD</span></span></span><br><span class="line"><span class="string">EOF&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FORCE=yes ./stack.sh</span><br></pre></td></tr></table></figure>

<h1 id="BUG-解决"><a href="#BUG-解决" class="headerlink" title="BUG 解决"></a>BUG 解决</h1><h2 id="systemd-包依赖冲突"><a href="#systemd-包依赖冲突" class="headerlink" title="systemd 包依赖冲突"></a>systemd 包依赖冲突</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo aptitude install systemd</span><br><span class="line">选择N</span><br><span class="line">再选择Y</span><br></pre></td></tr></table></figure>

<h2 id="ModuleNotFoundError-No-module-named-‘distutils-cmd’"><a href="#ModuleNotFoundError-No-module-named-‘distutils-cmd’" class="headerlink" title="ModuleNotFoundError: No module named ‘distutils.cmd’"></a>ModuleNotFoundError: No module named ‘distutils.cmd’</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python3.10-distutils</span><br><span class="line"># 根据自己的 Python 版本决定，可以 python3.7-distutils python3.8-distutils   ....都试一遍</span><br></pre></td></tr></table></figure>

<h2 id="apparmor-invalid-capability-bpf"><a href="#apparmor-invalid-capability-bpf" class="headerlink" title="apparmor invalid capability bpf"></a>apparmor invalid capability bpf</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install apparmor</span><br></pre></td></tr></table></figure>

<h2 id="No-tenant-network-is-available-for-allocation"><a href="#No-tenant-network-is-available-for-allocation" class="headerlink" title="No tenant network is available for allocation"></a>No tenant network is available for allocation</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/neutron/plugins/ml2/ml2_conf.ini</span><br><span class="line"></span><br><span class="line">[ml2]</span><br><span class="line">type_drivers = flat,vlan,vxlan</span><br><span class="line">tenant_network_types = vxlan</span><br><span class="line"></span><br><span class="line">[ml2_type_vxlan]</span><br><span class="line">vni_ranges = 1:1000</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="unix-var-run-openvswitch-db-sock-database-connection-failed-Connection-refused"><a href="#unix-var-run-openvswitch-db-sock-database-connection-failed-Connection-refused" class="headerlink" title="unix:/var/run/openvswitch/db.sock: database connection failed (Connection refused)"></a>unix:/var/run/openvswitch/db.sock: database connection failed (Connection refused)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span>  /opt/stack/devstack/lib/neutron_plugin </span><br><span class="line">vi ovn_agent </span><br><span class="line">116G  跳转到116行</span><br><span class="line">OVS_RUNDIR=<span class="variable">$OVS_PREFIX</span>/var/run/openvswitch 修改为OVS_RUNDIR=<span class="variable">$OVS_PREFIX</span>/var/run/ovn </span><br><span class="line">sudo rm -rf /var/run/ovn</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="VirtualBox-启动报错-Failed-to-send-host-log-message"><a href="#VirtualBox-启动报错-Failed-to-send-host-log-message" class="headerlink" title="VirtualBox 启动报错 : Failed to send host log message"></a>VirtualBox 启动报错 : Failed to send host log message</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+F2进入另一个终端</span><br><span class="line">输入：startx进入桌面</span><br></pre></td></tr></table></figure>

<h2 id="AttributeError-module-‘collections‘-has-no-attribute-‘MutableMapping‘"><a href="#AttributeError-module-‘collections‘-has-no-attribute-‘MutableMapping‘" class="headerlink" title="AttributeError: module ‘collections‘ has no attribute ‘MutableMapping‘"></a>AttributeError: module ‘collections‘ has no attribute ‘MutableMapping‘</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">collections.MutableMapping</span><br><span class="line">collections.abc.MutableMapping</span><br></pre></td></tr></table></figure>

<h2 id="ModuleNotFoundError-No-module-named-‘distutils-core’"><a href="#ModuleNotFoundError-No-module-named-‘distutils-core’" class="headerlink" title="ModuleNotFoundError: No module named ‘distutils.core’"></a>ModuleNotFoundError: No module named ‘distutils.core’</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install python3-pip</span><br></pre></td></tr></table></figure>

<h2 id="ERROR-Cannot-uninstall-‘simplejson’-It-is-a-distutils-installed-project-and-thus-we-cannot"><a href="#ERROR-Cannot-uninstall-‘simplejson’-It-is-a-distutils-installed-project-and-thus-we-cannot" class="headerlink" title="ERROR: Cannot uninstall ‘simplejson’. It is a distutils installed project and thus we cannot"></a>ERROR: Cannot uninstall ‘simplejson’. It is a distutils installed project and thus we cannot</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip install --ignore-installed wrapt enum34 simplejson netaddr</span><br></pre></td></tr></table></figure>

<h2 id="server-certificate-verification-failed-CAfile-none-CRLfile-none"><a href="#server-certificate-verification-failed-CAfile-none-CRLfile-none" class="headerlink" title="server certificate verification failed. CAfile: none CRLfile: none"></a>server certificate verification failed. CAfile: none CRLfile: none</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.sslverify <span class="literal">false</span></span><br><span class="line">git config --global https.sslverify <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h2 id="Ubuntu-登录页面验证出错"><a href="#Ubuntu-登录页面验证出错" class="headerlink" title="Ubuntu:登录页面验证出错"></a>Ubuntu:登录页面验证出错</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo loginctl unlock-sessions</span><br></pre></td></tr></table></figure>

<h2 id="Ubuntu-重装桌面"><a href="#Ubuntu-重装桌面" class="headerlink" title="Ubuntu:重装桌面"></a>Ubuntu:重装桌面</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ubuntu-desktop</span><br></pre></td></tr></table></figure>

<h2 id="Ubuntu-登录界面-Authentication-Error"><a href="#Ubuntu-登录界面-Authentication-Error" class="headerlink" title="Ubuntu 登录界面 Authentication Error"></a>Ubuntu 登录界面 Authentication Error</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo loginctl unlock-sessions</span><br><span class="line">sudo <span class="built_in">echo</span> <span class="string">&quot;fs.inotify.max_user_watches=524288&quot;</span> &gt;&gt; /etc/sysctl.conf</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Ubuntu-无法进入桌面系统，但是可以-SSH-链接"><a href="#Ubuntu-无法进入桌面系统，但是可以-SSH-链接" class="headerlink" title="Ubuntu 无法进入桌面系统，但是可以 SSH 链接"></a>Ubuntu 无法进入桌面系统，但是可以 SSH 链接</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -rf /var/lib/apt/lists/*</span><br><span class="line">sudo apt-get clean</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install --reinstall appstream</span><br></pre></td></tr></table></figure>

<h2 id="gsettings-desktop-schemas-破坏：mutter-＜-3-31-4-但是-3-28-4-0ubuntu18-04-2-正要被安装解决方案"><a href="#gsettings-desktop-schemas-破坏：mutter-＜-3-31-4-但是-3-28-4-0ubuntu18-04-2-正要被安装解决方案" class="headerlink" title="gsettings-desktop-schemas : 破坏：mutter (＜ 3.31.4) 但是 3.28.4-0ubuntu18.04.2 正要被安装解决方案"></a>gsettings-desktop-schemas : 破坏：mutter (＜ 3.31.4) 但是 3.28.4-0ubuntu18.04.2 正要被安装解决方案</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install gsettings-desktop-schemas</span><br><span class="line">sudo apt-get install build-essential</span><br></pre></td></tr></table></figure>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">
    
    </div>
    
    
</article>




    
    
    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2024 Dominic&nbsp;
                powered_by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("zh-CN");
</script>




<script src="../../js/script.js"></script>


    
</body>
</html>